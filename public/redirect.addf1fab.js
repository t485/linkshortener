parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=u,exports.__generator=c,exports.__exportStar=f,exports.__values=l,exports.__read=s,exports.__spread=p,exports.__spreadArrays=y,exports.__await=_,exports.__asyncGenerator=h,exports.__asyncDelegator=v,exports.__asyncValues=b,exports.__makeTemplateObject=d,exports.__importStar=w,exports.__importDefault=x,exports.__classPrivateFieldGet=m,exports.__classPrivateFieldSet=O,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(e){a(e)}}function u(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(u){a=[6,u],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function f(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function y(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||u(t,e)})})}function u(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){u("next",t)}function f(t){u("throw",t)}function l(t,e){t(e),a.shift(),a.length&&u(a[0][0],a[0][1])}}function v(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof l?l(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function d(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function w(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function x(t){return t&&t.__esModule?t:{default:t}}function m(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function O(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}exports.__assign=r;
},{}],"xA6u":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0});var r=require("tslib"),e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,r){if(!t)throw n(r)},n=function(t){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},i=function(t){for(var r=[],e=0,o=0;o<t.length;o++){var n=t.charCodeAt(o);n<128?r[e++]=n:n<2048?(r[e++]=n>>6|192,r[e++]=63&n|128):55296==(64512&n)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(++o)),r[e++]=n>>18|240,r[e++]=n>>12&63|128,r[e++]=n>>6&63|128,r[e++]=63&n|128):(r[e++]=n>>12|224,r[e++]=n>>6&63|128,r[e++]=63&n|128)}return r},s=function(t){for(var r=[],e=0,o=0;e<t.length;){var n=t[e++];if(n<128)r[o++]=String.fromCharCode(n);else if(n>191&&n<224){var i=t[e++];r[o++]=String.fromCharCode((31&n)<<6|63&i)}else if(n>239&&n<365){var s=((7&n)<<18|(63&(i=t[e++]))<<12|(63&(a=t[e++]))<<6|63&t[e++])-65536;r[o++]=String.fromCharCode(55296+(s>>10)),r[o++]=String.fromCharCode(56320+(1023&s))}else{i=t[e++];var a=t[e++];r[o++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a)}}return r.join("")},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,r){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var e=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],n=0;n<t.length;n+=3){var i=t[n],s=n+1<t.length,a=s?t[n+1]:0,c=n+2<t.length,h=c?t[n+2]:0,f=i>>2,u=(3&i)<<4|a>>4,p=(15&a)<<2|h>>6,l=63&h;c||(l=64,s||(p=64)),o.push(e[f],e[u],e[p],e[l])}return o.join("")},encodeString:function(t,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(t):this.encodeByteArray(i(t),r)},decodeString:function(t,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(t):s(this.decodeStringToByteArray(t,r))},decodeStringToByteArray:function(t,r){this.init_();for(var e=r?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],n=0;n<t.length;){var i=e[t.charAt(n++)],s=n<t.length?e[t.charAt(n)]:0,a=++n<t.length?e[t.charAt(n)]:64,c=++n<t.length?e[t.charAt(n)]:64;if(++n,null==i||null==s||null==a||null==c)throw Error();var h=i<<2|s>>4;if(o.push(h),64!==a){var f=s<<4&240|a>>2;if(o.push(f),64!==c){var u=a<<6&192|c;o.push(u)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var r=i(t);return a.encodeByteArray(r,!0)},h=function(t){try{return a.decodeString(t,!0)}catch(r){console.error("base64Decode failed: ",r)}return null};function f(t){return u(void 0,t)}function u(t,r){if(!(r instanceof Object))return r;switch(r.constructor){case Date:return new Date(r.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return r}for(var e in r)r.hasOwnProperty(e)&&(t[e]=u(t[e],r[e]));return t}var p=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(r,e){t.resolve=r,t.reject=e})}return t.prototype.wrapCallback=function(t){var r=this;return function(e,o){e?r.reject(e):r.resolve(o),"function"==typeof t&&(r.promise.catch(function(){}),1===t.length?t(e):t(e,o))}},t}();function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function d(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(r){return!1}}function b(){return"object"==typeof self&&self.self===self}function y(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function E(){return l().indexOf("Electron/")>=0}function g(){var t=l();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function S(){return l().indexOf("MSAppHost/")>=0}function A(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}var x="FirebaseError",O=function(t){function e(r,o){var n=t.call(this,o)||this;return n.code=r,n.name=x,Object.setPrototypeOf(n,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}return r.__extends(e,t),e}(Error),m=function(){function t(t,r,e){this.service=t,this.serviceName=r,this.errors=e}return t.prototype.create=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];for(var o=r[0]||{},n=this.service+"/"+t,i=this.errors[t],s=i?C(i,o):"Error",a=this.serviceName+": "+s+" ("+n+").",c=new O(n,a),h=0,f=Object.keys(o);h<f.length;h++){var u=f[h];"_"!==u.slice(-1)&&(u in c&&console.warn('Overwriting FirebaseError base field "'+u+'" can cause unexpected behavior.'),c[u]=o[u])}return c},t}();function C(t,r){return t.replace(w,function(t,e){var o=r[e];return null!=o?o.toString():"<"+e+"?>"})}var w=/\{\$([^}]+)}/g;function N(t){return JSON.parse(t)}function T(t){return JSON.stringify(t)}var D=function(t){var r={},e={},o={},n="";try{var i=t.split(".");r=N(h(i[0])||""),e=N(h(i[1])||""),n=i[2],o=e.d||{},delete e.d}catch(s){}return{header:r,claims:e,data:o,signature:n}},j=function(t){var r=D(t).claims,e=Math.floor((new Date).getTime()/1e3),o=0,n=0;return"object"==typeof r&&(r.hasOwnProperty("nbf")?o=r.nbf:r.hasOwnProperty("iat")&&(o=r.iat),n=r.hasOwnProperty("exp")?r.exp:o+86400),!!e&&!!o&&!!n&&e>=o&&e<=n},k=function(t){var r=D(t).claims;return"object"==typeof r&&r.hasOwnProperty("iat")?r.iat:null},M=function(t){var r=D(t).claims;return!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},B=function(t){var r=D(t).claims;return"object"==typeof r&&!0===r.admin};function P(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function V(t,r){return Object.prototype.hasOwnProperty.call(t,r)?t[r]:void 0}function I(t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))return!1;return!0}function W(t,r,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=r.call(e,t[n],n,t));return o}function L(t){for(var r=[],e=function(t,e){Array.isArray(e)?e.forEach(function(e){r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))},o=0,n=Object.entries(t);o<n.length;o++){var i=n[o];e(i[0],i[1])}return r.length?"&"+r.join("&"):""}function R(t){var r={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var e=t.split("=");r[e[0]]=e[1]}}),r}var z=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,r){r||(r=0);var e=this.W_;if("string"==typeof t)for(var o=0;o<16;o++)e[o]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(o=0;o<16;o++)e[o]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(o=16;o<80;o++){var n=e[o-3]^e[o-8]^e[o-14]^e[o-16];e[o]=4294967295&(n<<1|n>>>31)}var i,s,a=this.chain_[0],c=this.chain_[1],h=this.chain_[2],f=this.chain_[3],u=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(i=f^c&(h^f),s=1518500249):(i=c^h^f,s=1859775393):o<60?(i=c&h|f&(c|h),s=2400959708):(i=c^h^f,s=3395469782);n=(a<<5|a>>>27)+i+u+s+e[o]&4294967295;u=f,f=h,h=4294967295&(c<<30|c>>>2),c=a,a=n}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295},t.prototype.update=function(t,r){if(null!=t){void 0===r&&(r=t.length);for(var e=r-this.blockSize,o=0,n=this.buf_,i=this.inbuf_;o<r;){if(0===i)for(;o<=e;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<r;)if(n[i]=t.charCodeAt(o),++o,++i===this.blockSize){this.compress_(n),i=0;break}}else for(;o<r;)if(n[i]=t[o],++o,++i===this.blockSize){this.compress_(n),i=0;break}}this.inbuf_=i,this.total_+=r}},t.prototype.digest=function(){var t=[],r=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&r,r/=256;this.compress_(this.buf_);var o=0;for(e=0;e<5;e++)for(var n=24;n>=0;n-=8)t[o]=this.chain_[e]>>n&255,++o;return t},t}();function F(t,r){var e=new U(t,r);return e.subscribe.bind(e)}var U=function(){function t(t,r){var e=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){t(e)}).catch(function(t){e.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(r){r.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(r){r.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,r,e){var o,n=this;if(void 0===t&&void 0===r&&void 0===e)throw new Error("Missing Observer.");void 0===(o=q(t,["next","error","complete"])?t:{next:t,error:r,complete:e}).next&&(o.next=J),void 0===o.error&&(o.error=J),void 0===o.complete&&(o.complete=J);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{n.finalError?o.error(n.finalError):o.complete()}catch(t){}}),this.observers.push(o),i},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,t)},t.prototype.sendOne=function(t,r){var e=this;this.task.then(function(){if(void 0!==e.observers&&void 0!==e.observers[t])try{r(e.observers[t])}catch(o){"undefined"!=typeof console&&console.error&&console.error(o)}})},t.prototype.close=function(t){var r=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},t}();function H(t,r){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];Promise.resolve(!0).then(function(){t.apply(void 0,e)}).catch(function(t){r&&r(t)})}}function q(t,r){if("object"!=typeof t||null===t)return!1;for(var e=0,o=r;e<o.length;e++){var n=o[e];if(n in t&&"function"==typeof t[n])return!0}return!1}function J(){}var G=function(t,r,e,o){var n;if(o<r?n="at least "+r:o>e&&(n=0===e?"none":"no more than "+e),n)throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")};function K(t,r,e){var o="";switch(r){case 1:o=e?"first":"First";break;case 2:o=e?"second":"Second";break;case 3:o=e?"third":"Third";break;case 4:o=e?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var n=t+" failed: ";return n+=o+" argument "}function $(t,r,e,o){if((!o||e)&&"string"!=typeof e)throw new Error(K(t,r,o)+"must be a valid firebase namespace.")}function Q(t,r,e,o){if((!o||e)&&"function"!=typeof e)throw new Error(K(t,r,o)+"must be a valid function.")}function X(t,r,e,o){if((!o||e)&&("object"!=typeof e||null===e))throw new Error(K(t,r,o)+"must be a valid context object.")}var Y=function(t){for(var r=[],e=0,n=0;n<t.length;n++){var i=t.charCodeAt(n);if(i>=55296&&i<=56319){var s=i-55296;o(++n<t.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(t.charCodeAt(n)-56320)}i<128?r[e++]=i:i<2048?(r[e++]=i>>6|192,r[e++]=63&i|128):i<65536?(r[e++]=i>>12|224,r[e++]=i>>6&63|128,r[e++]=63&i|128):(r[e++]=i>>18|240,r[e++]=i>>12&63|128,r[e++]=i>>6&63|128,r[e++]=63&i|128)}return r},Z=function(t){for(var r=0,e=0;e<t.length;e++){var o=t.charCodeAt(e);o<128?r++:o<2048?r+=2:o>=55296&&o<=56319?(r+=4,e++):r+=3}return r};exports.CONSTANTS=e,exports.Deferred=p,exports.ErrorFactory=m,exports.FirebaseError=O,exports.Sha1=z,exports.assert=o,exports.assertionError=n,exports.async=H,exports.base64=a,exports.base64Decode=h,exports.base64Encode=c,exports.contains=P,exports.createSubscribe=F,exports.decode=D,exports.deepCopy=f,exports.deepExtend=u,exports.errorPrefix=K,exports.getUA=l,exports.isAdmin=B,exports.isBrowser=b,exports.isBrowserExtension=y,exports.isElectron=E,exports.isEmpty=I,exports.isIE=g,exports.isMobileCordova=v,exports.isNode=d,exports.isNodeSdk=A,exports.isReactNative=_,exports.isUWP=S,exports.isValidFormat=M,exports.isValidTimestamp=j,exports.issuedAtTime=k,exports.jsonEval=N,exports.map=W,exports.querystring=L,exports.querystringDecode=R,exports.safeGet=V,exports.stringLength=Z,exports.stringToByteArray=Y,exports.stringify=T,exports.validateArgCount=G,exports.validateCallback=Q,exports.validateContextObject=X,exports.validateNamespace=$;
},{"tslib":"vCxL"}],"nzQs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("tslib"),e=require("@firebase/util"),n=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),r="[DEFAULT]",i=function(){function n(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return n.prototype.get=function(t){void 0===t&&(t=r);var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var i=new e.Deferred;this.instancesDeferred.set(n,i);try{var o=this.getOrInitializeService(n);o&&i.resolve(o)}catch(s){}}return this.instancesDeferred.get(n).promise},n.prototype.getImmediate=function(e){var n=t.__assign({identifier:r,optional:!1},e),i=n.identifier,o=n.optional,s=this.normalizeInstanceIdentifier(i);try{var a=this.getOrInitializeService(s);if(!a){if(o)return null;throw Error("Service "+this.name+" is not available")}return a}catch(c){if(o)return null;throw c}},n.prototype.getComponent=function(){return this.component},n.prototype.setComponent=function(e){var n,i;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,s(e))try{this.getOrInitializeService(r)}catch(l){}try{for(var o=t.__values(this.instancesDeferred.entries()),a=o.next();!a.done;a=o.next()){var c=t.__read(a.value,2),p=c[0],h=c[1],u=this.normalizeInstanceIdentifier(p);try{var f=this.getOrInitializeService(u);h.resolve(f)}catch(l){}}}catch(d){n={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},n.prototype.clearInstance=function(t){void 0===t&&(t=r),this.instancesDeferred.delete(t),this.instances.delete(t)},n.prototype.delete=function(){return t.__awaiter(this,void 0,void 0,function(){var e;return t.__generator(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return t.sent(),[2]}})})},n.prototype.isComponentSet=function(){return null!=this.component},n.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,o(t)),this.instances.set(t,e)),e||null},n.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:r:t},n}();function o(t){return t===r?void 0:t}function s(t){return"EAGER"===t.instantiationMode}var a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new i(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();exports.Component=n,exports.ComponentContainer=a,exports.Provider=i;
},{"tslib":"vCxL","@firebase/util":"xA6u"}],"TUpU":[function(require,module,exports) {
"use strict";function e(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var l=arguments[r],i=0,s=l.length;i<s;i++,o++)n[o]=l[i];return n}var r;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setLogLevel=g,exports.setUserLogHandler=u,exports.Logger=exports.LogLevel=void 0;var t,n=[];exports.LogLevel=t,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(t||(exports.LogLevel=t={}));var o={debug:t.DEBUG,verbose:t.VERBOSE,info:t.INFO,warn:t.WARN,error:t.ERROR,silent:t.SILENT},l=t.INFO,i=((r={})[t.DEBUG]="log",r[t.VERBOSE]="log",r[t.INFO]="info",r[t.WARN]="warn",r[t.ERROR]="error",r),s=function(r,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(!(t<r.logLevel)){var l=(new Date).toISOString(),s=i[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[s].apply(console,e(["["+l+"]  "+r.name+":"],n))}},a=function(){function r(e){this.name=e,this._logLevel=l,this._logHandler=s,this._userLogHandler=null,n.push(this)}return Object.defineProperty(r.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!0,configurable:!0}),r.prototype.debug=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.DEBUG],r)),this._logHandler.apply(this,e([this,t.DEBUG],r))},r.prototype.log=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.VERBOSE],r)),this._logHandler.apply(this,e([this,t.VERBOSE],r))},r.prototype.info=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.INFO],r)),this._logHandler.apply(this,e([this,t.INFO],r))},r.prototype.warn=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.WARN],r)),this._logHandler.apply(this,e([this,t.WARN],r))},r.prototype.error=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,e([this,t.ERROR],r)),this._logHandler.apply(this,e([this,t.ERROR],r))},r}();function g(e){var r="string"==typeof e?o[e]:e;n.forEach(function(e){e.logLevel=r})}function u(e,r){for(var l=function(n){var l=null;r&&r.level&&(l=o[r.level]),n.userLogHandler=null===e?null:function(r,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var s=o.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(function(e){return e}).join(" ");n>=(null!=l?l:r.logLevel)&&e({level:t[n].toLowerCase(),message:s,args:o,type:r.name})}},i=0,s=n;i<s.length;i++){l(s[i])}}exports.Logger=a;
},{}],"dP58":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n,r=require("tslib"),t=require("@firebase/util"),i=require("@firebase/component"),a=require("@firebase/logger"),o=((e={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",e["bad-app-name"]="Illegal App name: '{$appName}",e["duplicate-app"]="Firebase App named '{$appName}' already exists",e["app-deleted"]="Firebase App named '{$appName}' already deleted",e["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",e["invalid-log-argument"]="First argument to `onLog` must be null or a function.",e),s=new t.ErrorFactory("app","Firebase",o),p="@firebase/app",l="0.6.2",c="@firebase/analytics",u="@firebase/auth",f="@firebase/database",d="@firebase/functions",m="@firebase/installations",b="@firebase/messaging",h="@firebase/performance",g="@firebase/remote-config",v="@firebase/storage",y="@firebase/firestore",_="firebase-wrapper",w="[DEFAULT]",N=((n={})[p]="fire-core",n[c]="fire-analytics",n[u]="fire-auth",n[f]="fire-rtdb",n[d]="fire-fn",n[m]="fire-iid",n[b]="fire-fcm",n[h]="fire-perf",n[g]="fire-rc",n[v]="fire-gcs",n[y]="fire-fst",n["fire-js"]="fire-js",n[_]="fire-js-all",n),C=new a.Logger("@firebase/app"),I=function(){function e(e,n,a){var o,s,p=this;this.firebase_=a,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=t.deepCopy(e),this.container=new i.ComponentContainer(n.name),this._addComponent(new i.Component("app",function(){return p},"PUBLIC"));try{for(var l=r.__values(this.firebase_.INTERNAL.components.values()),c=l.next();!c.done;c=l.next()){var u=c.value;this._addComponent(u)}}catch(f){o={error:f}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(n){e.checkDestroyed_(),n()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,n){return void 0===n&&(n=w),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(e,n){void 0===n&&(n=w),this.container.getProvider(e).clearInstance(n)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(n){C.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw s.create("app-deleted",{appName:this.name_})},e}();I.prototype.name&&I.prototype.options||I.prototype.delete||console.log("dc");var E="7.14.1";function A(e){var n={},o=new Map,p={__esModule:!0,initializeApp:function(r,i){void 0===i&&(i={});if("object"!=typeof i||null===i){var a=i;i={name:a}}var o=i;void 0===o.name&&(o.name=w);var l=o.name;if("string"!=typeof l||!l)throw s.create("bad-app-name",{appName:String(l)});if(t.contains(n,l))throw s.create("duplicate-app",{appName:l});var c=new e(r,o,p);return n[l]=c,c},app:l,registerVersion:function(e,n,r){var t,a=null!==(t=N[e])&&void 0!==t?t:e;r&&(a+="-"+r);var o=a.match(/\s|\//),s=n.match(/\s|\//);if(o||s){var p=['Unable to register library "'+a+'" with version "'+n+'":'];return o&&p.push('library name "'+a+'" contains illegal characters (whitespace or "/")'),o&&s&&p.push("and"),s&&p.push('version name "'+n+'" contains illegal characters (whitespace or "/")'),void C.warn(p.join(" "))}c(new i.Component(a+"-version",function(){return{library:a,version:n}},"VERSION"))},setLogLevel:a.setLogLevel,onLog:function(e,n){if(null!==e&&"function"!=typeof e)throw s.create("invalid-log-argument",{appName:name});a.setUserLogHandler(e,n)},apps:null,SDK_VERSION:E,INTERNAL:{registerComponent:c,removeApp:function(e){delete n[e]},components:o,useAsService:function(e,n){if("serverAuth"===n)return null;return n}}};function l(e){if(e=e||w,!t.contains(n,e))throw s.create("no-app",{appName:e});return n[e]}function c(i){var a,c,u=i.name;if(o.has(u))return C.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===i.type?p[u]:null;if(o.set(u,i),"PUBLIC"===i.type){var f=function(e){if(void 0===e&&(e=l()),"function"!=typeof e[u])throw s.create("invalid-app-argument",{appName:u});return e[u]()};void 0!==i.serviceProps&&t.deepExtend(f,i.serviceProps),p[u]=f,e.prototype[u]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,u).apply(this,i.multipleInstances?e:[])}}try{for(var d=r.__values(Object.keys(n)),m=d.next();!m.done;m=d.next()){var b=m.value;n[b]._addComponent(i)}}catch(h){a={error:h}}finally{try{m&&!m.done&&(c=d.return)&&c.call(d)}finally{if(a)throw a.error}}return"PUBLIC"===i.type?p[u]:null}return p.default=p,Object.defineProperty(p,"apps",{get:function(){return Object.keys(n).map(function(e){return n[e]})}}),l.App=e,p}function F(){var e=A(I);return e.INTERNAL=r.__assign(r.__assign({},e.INTERNAL),{createFirebaseNamespace:F,extendNamespace:function(n){t.deepExtend(e,n)},createSubscribe:t.createSubscribe,ErrorFactory:t.ErrorFactory,deepExtend:t.deepExtend}),e}var P=F(),L=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(D(e)){var n=e.getImmediate();return n.library+"/"+n.version}return null}).filter(function(e){return e}).join(" ")},e}();function D(e){var n=e.getComponent();return"VERSION"===(null==n?void 0:n.type)}function j(e,n){e.INTERNAL.registerComponent(new i.Component("platform-logger",function(e){return new L(e)},"PRIVATE")),e.registerVersion(p,l,n),e.registerVersion("fire-js","")}if(t.isBrowser()&&void 0!==self.firebase){C.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var O=self.firebase.SDK_VERSION;O&&O.indexOf("LITE")>=0&&C.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var k=P.initializeApp;P.initializeApp=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.isNode()&&C.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),k.apply(void 0,e)};var x=P;j(x),exports.default=x,exports.firebase=x;
},{"tslib":"vCxL","@firebase/util":"xA6u","@firebase/component":"nzQs","@firebase/logger":"TUpU"}],"ZUoI":[function(require,module,exports) {
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=e(require("@firebase/app")),t="firebase",i="7.14.1";r.registerVersion(t,i,"app"),module.exports=r;
},{"@firebase/app":"dP58"}],"ueHA":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.EventType=exports.ErrorCode=exports.default=void 0;var i,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e=e||{},s=n;function r(t){return"string"==typeof t}function a(t){return"number"==typeof t}function o(t,i){t=t.split("."),i=i||s;for(var n=0;n<t.length;n++)if(null==(i=i[t[n]]))return null;return i}function h(){}function c(t){var i=typeof t;if("object"==i){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return i;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==i&&void 0===t.call)return"object";return i}function l(t){return"array"==c(t)}function u(t){var i=c(t);return"array"==i||"object"==i&&"number"==typeof t.length}function f(t){var i=typeof t;return"object"==i&&null!=t||"function"==i}var p="closure_uid_"+(1e9*Math.random()>>>0),v=0;function d(t,i,n){return t.call.apply(t.bind,arguments)}function b(t,i,n){if(!t)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,e),t.apply(i,n)}}return function(){return t.apply(i,arguments)}}function g(t,i,n){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?d:b).apply(null,arguments)}function y(t,i){var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),t.apply(this,i)}}var m=Date.now||function(){return+new Date};function w(t,i){function n(){}n.prototype=i.prototype,t.N=i.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n,e){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return i.prototype[n].apply(t,s)}}function E(){this.j=this.j,this.i=this.i}var T=0;E.prototype.j=!1,E.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0!=T))this[p]||(this[p]=++v)},E.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var C=Array.prototype.indexOf?function(t,i){return Array.prototype.indexOf.call(t,i,void 0)}:function(t,i){if(r(t))return r(i)&&1==i.length?t.indexOf(i,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===i)return n;return-1},I=Array.prototype.forEach?function(t,i,n){Array.prototype.forEach.call(t,i,n)}:function(t,i,n){for(var e=t.length,s=r(t)?t.split(""):t,a=0;a<e;a++)a in s&&i.call(n,s[a],a,t)};function S(t){t:{for(var i=Wn,n=t.length,e=r(t)?t.split(""):t,s=0;s<n;s++)if(s in e&&i.call(void 0,e[s],s,t)){i=s;break t}i=-1}return 0>i?null:r(t)?t.charAt(i):t[i]}function x(t){return Array.prototype.concat.apply([],arguments)}function O(t){var i=t.length;if(0<i){for(var n=Array(i),e=0;e<i;e++)n[e]=t[e];return n}return[]}function j(t){return/^[\s\xa0]*$/.test(t)}var P,R=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function L(t,i){return-1!=t.indexOf(i)}function A(t,i){return t<i?-1:t>i?1:0}t:{var M=s.navigator;if(M){var X=M.userAgent;if(X){P=X;break t}}P=""}function k(t,i,n){for(var e in t)i.call(n,t[e],e,t)}function D(t){var i,n={};for(i in t)n[i]=t[i];return n}var _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function H(t,i){for(var n,e,s=1;s<arguments.length;s++){for(n in e=arguments[s])t[n]=e[n];for(var r=0;r<_.length;r++)n=_[r],Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}}function N(t){return N[" "](t),t}function U(t,i){var n=Q;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=i(t)}N[" "]=h;var F,K=L(P,"Opera"),W=L(P,"Trident")||L(P,"MSIE"),Y=L(P,"Edge"),B=Y||W,G=L(P,"Gecko")&&!(L(P.toLowerCase(),"webkit")&&!L(P,"Edge"))&&!(L(P,"Trident")||L(P,"MSIE"))&&!L(P,"Edge"),J=L(P.toLowerCase(),"webkit")&&!L(P,"Edge");function $(){var t=s.document;return t?t.documentMode:void 0}t:{var q="",V=function(){var t=P;return G?/rv:([^\);]+)(\)|;)/.exec(t):Y?/Edge\/([\d\.]+)/.exec(t):W?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):J?/WebKit\/(\S+)/.exec(t):K?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(V&&(q=V?V[1]:""),W){var Z=$();if(null!=Z&&Z>parseFloat(q)){F=String(Z);break t}}F=q}var z,Q={};function tt(t){return U(t,function(){for(var i=0,n=R(String(F)).split("."),e=R(String(t)).split("."),s=Math.max(n.length,e.length),r=0;0==i&&r<s;r++){var a=n[r]||"",o=e[r]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;i=A(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||A(0==a[2].length,0==o[2].length)||A(a[2],o[2]),a=a[3],o=o[3]}while(0==i)}return 0<=i})}var it=s.document;z=it&&W?$()||("CSS1Compat"==it.compatMode?parseInt(F,10):5):void 0;var nt=!W||9<=Number(z),et=W&&!tt("9"),st=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,i=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",h,i),s.removeEventListener("test",h,i)}catch(n){}return t}();function rt(t,i){this.type=t,this.a=this.target=i,this.Ia=!0}function at(t,i){if(rt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,e=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=i,i=t.relatedTarget){if(G){t:{try{N(i.nodeName);var s=!0;break t}catch(a){}s=!1}s||(i=null)}}else"mouseover"==n?i=t.fromElement:"mouseout"==n&&(i=t.toElement);this.relatedTarget=i,e?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=r(t.pointerType)?t.pointerType:ot[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}rt.prototype.b=function(){this.Ia=!1},w(at,rt);var ot={2:"touch",3:"pen",4:"mouse"};at.prototype.b=function(){at.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,et)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(i){}};var ht="closure_listenable_"+(1e6*Math.random()|0),ct=0;function lt(t,i,n,e,s){this.listener=t,this.proxy=null,this.src=i,this.type=n,this.capture=!!e,this.da=s,this.key=++ct,this.X=this.Z=!1}function ut(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function ft(t){this.src=t,this.a={},this.b=0}function pt(t,i){var n=i.type;if(n in t.a){var e,s=t.a[n],r=C(s,i);(e=0<=r)&&Array.prototype.splice.call(s,r,1),e&&(ut(i),0==t.a[n].length&&(delete t.a[n],t.b--))}}function vt(t,i,n,e){for(var s=0;s<t.length;++s){var r=t[s];if(!r.X&&r.listener==i&&r.capture==!!n&&r.da==e)return s}return-1}ft.prototype.add=function(t,i,n,e,s){var r=t.toString();(t=this.a[r])||(t=this.a[r]=[],this.b++);var a=vt(t,i,e,s);return-1<a?(i=t[a],n||(i.Z=!1)):((i=new lt(i,this.src,r,!!e,s)).Z=n,t.push(i)),i};var dt="closure_lm_"+(1e6*Math.random()|0),bt={};function gt(t,i,n,e,s){if(e&&e.once)return wt(t,i,n,e,s);if(l(i)){for(var r=0;r<i.length;r++)gt(t,i[r],n,e,s);return null}return n=jt(n),t&&t[ht]?t.za(i,n,f(e)?!!e.capture:!!e,s):yt(t,i,n,!1,e,s)}function yt(t,i,n,e,s,r){if(!i)throw Error("Invalid event type");var a=f(s)?!!s.capture:!!s;if(a&&!nt)return null;var o=xt(t);if(o||(t[dt]=o=new ft(t)),(n=o.add(i,n,e,a,r)).proxy)return n;if(e=mt(),n.proxy=e,e.src=t,e.listener=n,t.addEventListener)st||(s=a),void 0===s&&(s=!1),t.addEventListener(i.toString(),e,s);else if(t.attachEvent)t.attachEvent(Ct(i.toString()),e);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(e)}return n}function mt(){var t=St,i=nt?function(n){return t.call(i.src,i.listener,n)}:function(n){if(!(n=t.call(i.src,i.listener,n)))return n};return i}function wt(t,i,n,e,s){if(l(i)){for(var r=0;r<i.length;r++)wt(t,i[r],n,e,s);return null}return n=jt(n),t&&t[ht]?t.Aa(i,n,f(e)?!!e.capture:!!e,s):yt(t,i,n,!0,e,s)}function Et(t,i,n,e,s){if(l(i))for(var r=0;r<i.length;r++)Et(t,i[r],n,e,s);else e=f(e)?!!e.capture:!!e,n=jt(n),t&&t[ht]?(t=t.c,(i=String(i).toString())in t.a&&(-1<(n=vt(r=t.a[i],n,e,s))&&(ut(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.a[i],t.b--)))):t&&(t=xt(t))&&(i=t.a[i.toString()],t=-1,i&&(t=vt(i,n,e,s)),(n=-1<t?i[t]:null)&&Tt(n))}function Tt(t){if(!a(t)&&t&&!t.X){var i=t.src;if(i&&i[ht])pt(i.c,t);else{var n=t.type,e=t.proxy;i.removeEventListener?i.removeEventListener(n,e,t.capture):i.detachEvent?i.detachEvent(Ct(n),e):i.addListener&&i.removeListener&&i.removeListener(e),(n=xt(i))?(pt(n,t),0==n.b&&(n.src=null,i[dt]=null)):ut(t)}}}function Ct(t){return t in bt?bt[t]:bt[t]="on"+t}function It(t,i){var n=t.listener,e=t.da||t.src;return t.Z&&Tt(t),n.call(e,i)}function St(t,i){return!!t.X||(nt?It(t,new at(i,this)):It(t,i=new at(i||o("window.event"),this)))}function xt(t){return(t=t[dt])instanceof ft?t:null}var Ot="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(t){return"function"==c(t)?t:(t[Ot]||(t[Ot]=function(i){return t.handleEvent(i)}),t[Ot])}function Pt(){E.call(this),this.c=new ft(this),this.J=this,this.B=null}function Rt(t,i,n,e){if(!(i=t.c.a[String(i)]))return!0;i=i.concat();for(var s=!0,r=0;r<i.length;++r){var a=i[r];if(a&&!a.X&&a.capture==n){var o=a.listener,h=a.da||a.src;a.Z&&pt(t.c,a),s=!1!==o.call(h,e)&&s}}return s&&0!=e.Ia}w(Pt,E),Pt.prototype[ht]=!0,(i=Pt.prototype).addEventListener=function(t,i,n,e){gt(this,t,i,n,e)},i.removeEventListener=function(t,i,n,e){Et(this,t,i,n,e)},i.dispatchEvent=function(t){var i,n=this.B;if(n)for(i=[];n;n=n.B)i.push(n);n=this.J;var e=t.type||t;if(r(t))t=new rt(t,n);else if(t instanceof rt)t.target=t.target||n;else{var s=t;H(t=new rt(e,n),s)}if(s=!0,i)for(var a=i.length-1;0<=a;a--){var o=t.a=i[a];s=Rt(o,e,!0,t)&&s}if(s=Rt(o=t.a=n,e,!0,t)&&s,s=Rt(o,e,!1,t)&&s,i)for(a=0;a<i.length;a++)s=Rt(o=t.a=i[a],e,!1,t)&&s;return s},i.G=function(){if(Pt.N.G.call(this),this.c){var t,i=this.c;for(t in i.a){for(var n=i.a[t],e=0;e<n.length;e++)ut(n[e]);delete i.a[t],i.b--}}this.B=null},i.za=function(t,i,n,e){return this.c.add(String(t),i,!1,n,e)},i.Aa=function(t,i,n,e){return this.c.add(String(t),i,!0,n,e)};var Lt=s.JSON.stringify;function At(t,i){this.c=t,this.f=i,this.b=0,this.a=null}function Mt(){this.b=this.a=null}At.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Xt,kt=new At(function(){return new _t},function(t){t.reset()});function Dt(){var t=Kt,i=null;return t.a&&(i=t.a,t.a=t.a.next,t.a||(t.b=null),i.next=null),i}function _t(){this.next=this.b=this.a=null}function Ht(t){s.setTimeout(function(){throw t},0)}function Nt(t,i){Xt||Ut(),Ft||(Xt(),Ft=!0),Kt.add(t,i)}function Ut(){var t=s.Promise.resolve(void 0);Xt=function(){t.then(Wt)}}Mt.prototype.add=function(t,i){var n=kt.get();n.set(t,i),this.b?this.b.next=n:this.a=n,this.b=n},_t.prototype.set=function(t,i){this.a=t,this.b=i,this.next=null},_t.prototype.reset=function(){this.next=this.b=this.a=null};var Ft=!1,Kt=new Mt;function Wt(){for(var t;t=Dt();){try{t.a.call(t.b)}catch(n){Ht(n)}var i=kt;i.f(t),100>i.b&&(i.b++,t.next=i.a,i.a=t)}Ft=!1}function Yt(t,i){Pt.call(this),this.b=t||1,this.a=i||s,this.f=g(this.gb,this),this.g=m()}function Bt(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Gt(t,i,n){if("function"==c(t))n&&(t=g(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=g(t.handleEvent,t)}return 2147483647<Number(i)?-1:s.setTimeout(t,i||0)}function Jt(t,i,n){E.call(this),this.f=null!=n?g(t,n):t,this.c=i,this.b=g(this.$a,this),this.a=[]}function $t(t){t.U=Gt(t.b,t.c),t.f.apply(null,t.a)}function qt(t){E.call(this),this.b=t,this.a={}}w(Yt,Pt),(i=Yt.prototype).ba=!1,i.L=null,i.gb=function(){if(this.ba){var t=m()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Bt(this),this.start()))}},i.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=m())},i.G=function(){Yt.N.G.call(this),Bt(this),delete this.a},w(Jt,E),(i=Jt.prototype).ea=!1,i.U=null,i.Ta=function(t){this.a=arguments,this.U?this.ea=!0:$t(this)},i.G=function(){Jt.N.G.call(this),this.U&&(s.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},i.$a=function(){this.U=null,this.ea&&(this.ea=!1,$t(this))},w(qt,E);var Vt=[];function Zt(t,i,n,e){l(n)||(n&&(Vt[0]=n.toString()),n=Vt);for(var s=0;s<n.length;s++){var r=gt(i,n[s],e||t.handleEvent,!1,t.b||t);if(!r)break;t.a[r.key]=r}}function zt(t){k(t.a,function(t,i){this.a.hasOwnProperty(i)&&Tt(t)},t),t.a={}}function Qt(){}qt.prototype.G=function(){qt.N.G.call(this),zt(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ti=new Pt;function ii(t){rt.call(this,"serverreachability",t)}function ni(t){ti.dispatchEvent(new ii(ti,t))}function ei(t){rt.call(this,"statevent",t)}function si(t){ti.dispatchEvent(new ei(ti,t))}function ri(t){rt.call(this,"timingevent",t)}function ai(t,i){if("function"!=c(t))throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},i)}w(ii,rt),w(ei,rt),w(ri,rt);var oi={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},hi={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function ci(){}function li(t){var i;return(i=t.a)||(i=t.a={}),i}function ui(){}ci.prototype.a=null;var fi,pi={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function vi(){rt.call(this,"d")}function di(){rt.call(this,"c")}function bi(){}function gi(t,i,n){this.g=t,this.W=i,this.V=n||1,this.I=new qt(this),this.O=yi,t=B?125:void 0,this.P=new Yt(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}w(vi,rt),w(di,rt),w(bi,ci),fi=new bi;var yi=45e3,mi={},wi={};function Ei(t,i,n){t.F=1,t.f=qi(Ki(i)),t.l=n,t.H=!0,Ci(t,null)}function Ti(t,i,n,e){t.F=1,t.f=qi(Ki(i)),t.l=null,t.H=n,Ci(t,e)}function Ci(t,i){t.v=m(),xi(t),t.D=Ki(t.f),$i(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?i:null),0<t.J&&(t.B=new Jt(g(t.Ja,t,t.a),t.J)),Zt(t.I,t.a,"readystatechange",t.cb),i=t.h?D(t.h):{},t.l?(t.w||(t.w="POST"),i["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,i)):(t.w="GET",t.a.ca(t.D,t.w,null,i)),ni(1)}function Ii(t,i,n){for(var e=!0;!t.m&&t.A<n.length;){var s=Si(t,n);if(s==wi){4==i&&(t.c=4,si(14),e=!1);break}if(s==mi){t.c=4,si(15),e=!1;break}Li(t,s)}4==i&&0==n.length&&(t.c=1,si(16),e=!1),t.b=t.b&&e,e||(Ri(t),Pi(t))}function Si(t,i){var n=t.A,e=i.indexOf("\n",n);return-1==e?wi:(n=Number(i.substring(n,e)),isNaN(n)?mi:(e+=1)+n>i.length?wi:(i=i.substr(e,n),t.A=e+n,i))}function xi(t){t.R=m()+t.O,Oi(t,t.O)}function Oi(t,i){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ai(g(t.ab,t),i)}function ji(t){t.i&&(s.clearTimeout(t.i),t.i=null)}function Pi(t){t.g.Ca()||t.m||t.g.na(t)}function Ri(t){ji(t);var i=t.B;i&&"function"==typeof i.la&&i.la(),t.B=null,Bt(t.P),zt(t.I),t.a&&(i=t.a,t.a=null,i.abort(),i.la())}function Li(t,i){try{t.g.Fa(t,i),ni(4)}catch(n){}}function Ai(t){if(t.C&&"function"==typeof t.C)return t.C();if(r(t))return t.split("");if(u(t)){for(var i=[],n=t.length,e=0;e<n;e++)i.push(t[e]);return i}for(e in i=[],n=0,t)i[n++]=t[e];return i}function Mi(t,i){if(t.forEach&&"function"==typeof t.forEach)t.forEach(i,void 0);else if(u(t)||r(t))I(t,i,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(u(t)||r(t)){n=[];for(var e=t.length,s=0;s<e;s++)n.push(s)}else for(s in n=[],e=0,t)n[e++]=s;s=(e=Ai(t)).length;for(var a=0;a<s;a++)i.call(void 0,e[a],n&&n[a],t)}}function Xi(t,i){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var e=0;e<n;e+=2)this.set(arguments[e],arguments[e+1])}else if(t)if(t instanceof Xi)for(n=t.K(),e=0;e<n.length;e++)this.set(n[e],t.get(n[e]));else for(e in t)this.set(e,t[e])}function ki(t){t.b={},t.a.length=0,t.c=0}function Di(t,i){Hi(t.b,i)&&(delete t.b[i],t.c--,t.a.length>2*t.c&&_i(t))}function _i(t){if(t.c!=t.a.length){for(var i=0,n=0;i<t.a.length;){var e=t.a[i];Hi(t.b,e)&&(t.a[n++]=e),i++}t.a.length=n}if(t.c!=t.a.length){var s={};for(n=i=0;i<t.a.length;)Hi(s,e=t.a[i])||(t.a[n++]=e,s[e]=1),i++;t.a.length=n}}function Hi(t,i){return Object.prototype.hasOwnProperty.call(t,i)}(i=gi.prototype).setTimeout=function(t){this.O=t},i.cb=function(t){t=t.target;var i=this.B;i&&3==qn(t)?i.Ta():this.Ja(t)},i.Ja=function(t){try{if(t==this.a)t:{var i=qn(this.a),n=this.a.ya(),e=this.a.T();if(!(3>i||3==i&&!B&&!this.a.aa())){this.m||4!=i||7==n||ni(8==n||0>=e?3:2),ji(this);var s=this.a.T();this.o=s;var r=this.a.aa();if(this.b=200==s){if(this.S&&!this.s){i:{if(this.a){var a=Vn(this.a,"X-HTTP-Initial-Response");if(a&&!j(a)){var o=a;break i}}o=null}if(!o){this.b=!1,this.c=3,si(12),Ri(this),Pi(this);break t}this.s=!0,Li(this,o)}this.H?(Ii(this,i,r),B&&this.b&&3==i&&(Zt(this.I,this.P,"tick",this.bb),this.P.start())):Li(this,r),4==i&&Ri(this),this.b&&!this.m&&(4==i?this.g.na(this):(this.b=!1,xi(this)))}else 400==s&&0<r.indexOf("Unknown SID")?(this.c=3,si(12)):(this.c=0,si(13)),Ri(this),Pi(this)}}}catch(h){}},i.bb=function(){if(this.a){var t=qn(this.a),i=this.a.aa();this.A<i.length&&(ji(this),Ii(this,t,i),this.b&&4!=t&&xi(this))}},i.cancel=function(){this.m=!0,Ri(this)},i.ab=function(){this.i=null;var t=m();0<=t-this.R?(2!=this.F&&(ni(3),si(17)),Ri(this),this.c=2,Pi(this)):Oi(this,this.R-t)},(i=Xi.prototype).C=function(){_i(this);for(var t=[],i=0;i<this.a.length;i++)t.push(this.b[this.a[i]]);return t},i.K=function(){return _i(this),this.a.concat()},i.get=function(t,i){return Hi(this.b,t)?this.b[t]:i},i.set=function(t,i){Hi(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=i},i.forEach=function(t,i){for(var n=this.K(),e=0;e<n.length;e++){var s=n[e],r=this.get(s);t.call(i,r,s,this)}};var Ni=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ui(t,i){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var e=t[n].indexOf("="),s=null;if(0<=e){var r=t[n].substring(0,e);s=t[n].substring(e+1)}else r=t[n];i(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Fi(t,i){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Fi?(this.h=void 0!==i?i:t.h,Wi(this,t.f),this.j=t.j,Yi(this,t.b),Bi(this,t.i),this.a=t.a,Gi(this,fn(t.c)),this.g=t.g):t&&(n=String(t).match(Ni))?(this.h=!!i,Wi(this,n[1]||"",!0),this.j=zi(n[2]||""),Yi(this,n[3]||"",!0),Bi(this,n[4]),this.a=zi(n[5]||"",!0),Gi(this,n[6]||"",!0),this.g=zi(n[7]||"")):(this.h=!!i,this.c=new on(null,this.h))}function Ki(t){return new Fi(t)}function Wi(t,i,n){t.f=n?zi(i,!0):i,t.f&&(t.f=t.f.replace(/:$/,""))}function Yi(t,i,n){t.b=n?zi(i,!0):i}function Bi(t,i){if(i){if(i=Number(i),isNaN(i)||0>i)throw Error("Bad port number "+i);t.i=i}else t.i=null}function Gi(t,i,n){i instanceof on?(t.c=i,vn(t.c,t.h)):(n||(i=Qi(i,rn)),t.c=new on(i,t.h))}function Ji(t,i,n){t.c.set(i,n)}function $i(t,i,n){l(n)||(n=[String(n)]),un(t.c,i,n)}function qi(t){return Ji(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^m()).toString(36)),t}function Vi(t){return t instanceof Fi?Ki(t):new Fi(t,void 0)}function Zi(t,i,n,e){var s=new Fi(null,void 0);return t&&Wi(s,t),i&&Yi(s,i),n&&Bi(s,n),e&&(s.a=e),s}function zi(t,i){return t?i?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Qi(t,i,n){return r(t)?(t=encodeURI(t).replace(i,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Fi.prototype.toString=function(){var t=[],i=this.f;i&&t.push(Qi(i,nn,!0),":");var n=this.b;return(n||"file"==i)&&(t.push("//"),(i=this.j)&&t.push(Qi(i,nn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Qi(n,"/"==n.charAt(0)?sn:en,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Qi(n,an)),t.join("")},Fi.prototype.resolve=function(t){var i=Ki(this),n=!!t.f;n?Wi(i,t.f):n=!!t.j,n?i.j=t.j:n=!!t.b,n?Yi(i,t.b):n=null!=t.i;var e=t.a;if(n)Bi(i,t.i);else if(n=!!t.a){if("/"!=e.charAt(0))if(this.b&&!this.a)e="/"+e;else{var s=i.a.lastIndexOf("/");-1!=s&&(e=i.a.substr(0,s+1)+e)}if(".."==(s=e)||"."==s)e="";else if(L(s,"./")||L(s,"/.")){e=0==s.lastIndexOf("/",0),s=s.split("/");for(var r=[],a=0;a<s.length;){var o=s[a++];"."==o?e&&a==s.length&&r.push(""):".."==o?((1<r.length||1==r.length&&""!=r[0])&&r.pop(),e&&a==s.length&&r.push("")):(r.push(o),e=!0)}e=r.join("/")}else e=s}return n?i.a=e:n=""!==t.c.toString(),n?Gi(i,fn(t.c)):n=!!t.g,n&&(i.g=t.g),i};var nn=/[#\/\?@]/g,en=/[#\?:]/g,sn=/[#\?]/g,rn=/[#\?@]/g,an=/#/g;function on(t,i){this.b=this.a=null,this.c=t||null,this.f=!!i}function hn(t){t.a||(t.a=new Xi,t.b=0,t.c&&Ui(t.c,function(i,n){t.add(decodeURIComponent(i.replace(/\+/g," ")),n)}))}function cn(t,i){hn(t),i=pn(t,i),Hi(t.a.b,i)&&(t.c=null,t.b-=t.a.get(i).length,Di(t.a,i))}function ln(t,i){return hn(t),i=pn(t,i),Hi(t.a.b,i)}function un(t,i,n){cn(t,i),0<n.length&&(t.c=null,t.a.set(pn(t,i),O(n)),t.b+=n.length)}function fn(t){var i=new on;return i.c=t.c,t.a&&(i.a=new Xi(t.a),i.b=t.b),i}function pn(t,i){return i=String(i),t.f&&(i=i.toLowerCase()),i}function vn(t,i){i&&!t.f&&(hn(t),t.c=null,t.a.forEach(function(t,i){var n=i.toLowerCase();i!=n&&(cn(this,i),un(this,n,t))},t)),t.f=i}function dn(){}function bn(){}function gn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function yn(t){var i=t.a.F.a;if(null!=i)si(4),i?(si(10),le(t.a,t,!1)):(si(11),le(t.a,t,!0));else{t.b=new gi(t,void 0,void 0),t.b.h=t.h,i=de(i=t.a,i.Y()?t.f:null,t.i),si(4),$i(i,"TYPE","xmlhttp");var n=t.a.j,e=t.a.I;n&&e&&Ji(i,n,e),Ti(t.b,i,!1,t.f)}}function mn(){this.a=this.b=null}function wn(){this.a=new Xi}function En(t){var i=typeof t;return"object"==i&&t||"function"==i?"o"+(t[p]||(t[p]=++v)):i.charAt(0)+t}function Tn(t,i){this.b=t,this.a=i}function Cn(t){this.g=t||In,s.PerformanceNavigationTiming?t=0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(s.ka&&s.ka.Da&&s.ka.Da()&&s.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new wn),this.b=null,this.c=[]}(i=on.prototype).add=function(t,i){hn(this),this.c=null,t=pn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(i),this.b+=1,this},i.forEach=function(t,i){hn(this),this.a.forEach(function(n,e){I(n,function(n){t.call(i,n,e,this)},this)},this)},i.K=function(){hn(this);for(var t=this.a.C(),i=this.a.K(),n=[],e=0;e<i.length;e++)for(var s=t[e],r=0;r<s.length;r++)n.push(i[e]);return n},i.C=function(t){hn(this);var i=[];if(r(t))ln(this,t)&&(i=x(i,this.a.get(pn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)i=x(i,t[n])}return i},i.set=function(t,i){return hn(this),this.c=null,ln(this,t=pn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[i]),this.b+=1,this},i.get=function(t,i){return t&&0<(t=this.C(t)).length?String(t[0]):i},i.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],i=this.a.K(),n=0;n<i.length;n++){var e=i[n],s=encodeURIComponent(String(e));e=this.C(e);for(var r=0;r<e.length;r++){var a=s;""!==e[r]&&(a+="="+encodeURIComponent(String(e[r]))),t.push(a)}}return this.c=t.join("&")},w(bn,dn),(i=gn.prototype).M=null,i.$=function(t){return this.a.$(t)},i.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},i.Ca=function(){return!1},i.Fa=function(t,i){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=Vn(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=Vn(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(i){try{var e=this.a.ja.a.parse(i)}catch(s){return(i=this.a).m=this.c,void pe(i,2)}this.f=e[0]}else(i=this.a).m=this.c,pe(i,2)}else 1==this.M&&(this.g?si(6):"11111"==i?(si(5),this.g=!0,(!W||10<=Number(z))&&(this.c=200,this.b.cancel(),si(11),le(this.a,this,!0))):(si(7),this.g=!1))},i.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,yn(this)):1==this.M&&(this.g?(si(11),le(this.a,this,!0)):(si(10),le(this.a,this,!1)));else{0==this.M?si(8):1==this.M&&si(9);var t=this.a;t.m=this.c,pe(t,2)}},i.Y=function(){return this.a.Y()},i.ma=function(){return this.a.ma()},wn.prototype.add=function(t){this.a.set(En(t),t)},wn.prototype.C=function(){return this.a.C()};var In=10;function Sn(t,i){!t.a&&(L(i,"spdy")||L(i,"quic")||L(i,"h2"))&&(t.f=t.g,t.a=new wn,t.b&&(Pn(t,t.b),t.b=null))}function xn(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function On(t){return t.b?1:t.a?t.a.a.c:0}function jn(t,i){return t.b?t=t.b==i:t.a?(i=En(i),t=Hi(t.a.a.b,i)):t=!1,t}function Pn(t,i){t.a?t.a.add(i):t.b=i}function Rn(t,i){var n;t.b&&t.b==i?t.b=null:((n=t.a)&&(n=En(i),n=Hi(t.a.a.b,n)),n&&Di(t.a.a,En(i)))}function Ln(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var i=t.c;return I(t.a.C(),function(t){i=i.concat(t.j)}),i}return O(t.c)}function An(){}function Mn(){this.a=new An}function Xn(t,i,n){var e=n||"";try{Mi(t,function(t,n){var s=t;f(t)&&(s=Lt(t)),i.push(e+n+"="+encodeURIComponent(s))})}catch(s){throw i.push(e+"type="+encodeURIComponent("_badmap")),s}}function kn(t,i){var n=new Qt;if(s.Image){var e=new Image;e.onload=y(Dn,n,e,"TestLoadImage: loaded",!0,i),e.onerror=y(Dn,n,e,"TestLoadImage: error",!1,i),e.onabort=y(Dn,n,e,"TestLoadImage: abort",!1,i),e.ontimeout=y(Dn,n,e,"TestLoadImage: timeout",!1,i),s.setTimeout(function(){e.ontimeout&&e.ontimeout()},1e4),e.src=t}else i(!1)}function Dn(t,i,n,e,s){try{i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null,s(e)}catch(r){}}Cn.prototype.cancel=function(){this.c=Ln(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(I(this.a.C(),function(t){t.cancel()}),ki(this.a.a))},An.prototype.stringify=function(t){return s.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return s.JSON.parse(t,void 0)};var _n=s.JSON.parse;function Hn(t){Pt.call(this),this.headers=new Xi,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Nn,this.D=this.F=!1}w(Hn,Pt);var Nn="",Un=/^https?$/i,Fn=["POST","PUT"];function Kn(t){return W&&tt(9)&&a(t.timeout)&&void 0!==t.ontimeout}function Wn(t){return"content-type"==t.toLowerCase()}function Yn(t,i){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=i,t.h=5,Bn(t),Jn(t)}function Bn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&void 0!==e&&(!t.s[1]||4!=qn(t)||2!=t.T()))if(t.l&&4==qn(t))Gt(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==qn(t)){t.b=!1;try{var i,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(i=r)){var a;if(a=0===n){var o=String(t.A).match(Ni)[1]||null;if(!o&&s.self&&s.self.location){var h=s.self.location.protocol;o=h.substr(0,h.length-1)}a=!Un.test(o?o.toLowerCase():"")}i=a}if(i)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var c=2<qn(t)?t.a.statusText:""}catch(l){c=""}t.f=c+" ["+t.T()+"]",Bn(t)}}finally{Jn(t)}}}function Jn(t,i){if(t.a){$n(t);var n=t.a,e=t.s[0]?h:null;t.a=null,t.s=null,i||t.dispatchEvent("ready");try{n.onreadystatechange=e}catch(s){}}}function $n(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(s.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Vn(t,i){return t.a?t.a.getResponseHeader(i):null}function Zn(t){var i="";return k(t,function(t,n){i+=n,i+=":",i+=t,i+="\r\n"}),i}function zn(t,i,n){t:{for(e in n){var e=!1;break t}e=!0}if(e)return t;if(n=Zn(n),r(t)){if(i=encodeURIComponent(String(i)),i+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(e=t.indexOf("?"))||e>n){e=n;var s=""}else s=t.substring(e+1,n);n=(t=[t.substr(0,e),s,t.substr(n)])[1],t[1]=i?n?n+"&"+i:i:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Ji(t,i,n),t}function Qn(t){this.f=[],this.F=new mn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!o("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=o("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=o("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=o("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=o("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Cn(t&&t.concurrentRequestLimit),this.ja=new Mn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function te(t){if(ie(t),3==t.u){var i=t.P++,n=Ki(t.B);Ji(n,"SID",t.H),Ji(n,"RID",i),Ji(n,"TYPE","terminate"),ae(t,n),(i=new gi(t,i,void 0)).F=2,i.f=qi(Ki(n)),n=!1,s.navigator&&s.navigator.sendBeacon&&(n=s.navigator.sendBeacon(i.f.toString(),"")),!n&&s.Image&&((new Image).src=i.f,n=!0),n||(i.a=i.g.$(null),i.a.ca(i.f)),i.v=m(),xi(i)}ve(t)}function ie(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(s.clearTimeout(t.l),t.l=null),ue(t),t.b.cancel(),t.h&&(a(t.h)&&s.clearTimeout(t.h),t.h=null)}function ne(t,i){t.f.push(new Tn(t.Qa++,i)),3==t.u&&ee(t)}function ee(t){xn(t.b)||t.h||(t.h=!0,Nt(t.Ha,t),t.A=0)}function se(t,i){return!(On(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=i.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))&&(t.h=ai(g(t.Ha,t,i),fe(t,t.A)),t.A++,!0))}function re(t,i){var n;n=i?i.W:t.P++;var e=Ki(t.B);Ji(e,"SID",t.H),Ji(e,"RID",n),Ji(e,"AID",t.O),ae(t,e),t.g&&t.i&&zn(e,t.g,t.i),n=new gi(t,n,t.A+1),null===t.g&&(n.h=t.i),i&&(t.f=i.j.concat(t.f)),i=oe(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Pn(t.b,n),Ei(n,e,i)}function ae(t,i){t.c&&Mi({},function(t,n){Ji(i,n,t)})}function oe(t,i,n){n=Math.min(t.f.length,n);var e=t.c?g(t.c.Sa,t.c,t):null;t:for(var s=t.f,r=-1;;){var a=["count="+n];-1==r?0<n?(r=s[0].b,a.push("ofs="+r)):r=0:a.push("ofs="+r);for(var o=!0,h=0;h<n;h++){var c=s[h].b,l=s[h].a;if(0>(c-=r))r=Math.max(0,s[h].b-100),o=!1;else try{Xn(l,a,"req"+c+"_")}catch(u){e&&e(l)}}if(o){e=a.join("&");break t}}return t=t.f.splice(0,n),i.j=t,e}function he(t){t.a||t.l||(t.S=1,Nt(t.Ga,t),t.v=0)}function ce(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=ai(g(t.Ga,t),fe(t,t.v)),t.v++,!0)}function le(t,i,n){var e=i.l;e&&Sn(t.b,e),t.ia=t.oa&&n,t.m=i.c,t.B=de(t,null,t.ha),ee(t)}function ue(t){null!=t.s&&(s.clearTimeout(t.s),t.s=null)}function fe(t,i){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*i}function pe(t,i){if(2==i){var n=null;t.c&&(n=null);var e=g(t.eb,t);n||(n=new Fi("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||Wi(n,"https"),qi(n)),kn(n.toString(),e)}else si(2);t.u=0,t.c&&t.c.ta(i),ve(t),ie(t)}function ve(t){t.u=0,t.m=-1,t.c&&(0==Ln(t.b).length&&0==t.f.length||(t.b.c.length=0,O(t.f),t.f.length=0),t.c.sa())}function de(t,i,n){var e=Vi(n);if(""!=e.b)i&&Yi(e,i+"."+e.b),Bi(e,e.i);else{var r,a=s.location;r=i?i+"."+a.hostname:a.hostname,e=Zi(a.protocol,r,+a.port,n)}return t.V&&k(t.V,function(t,i){Ji(e,i,t)}),i=t.j,n=t.I,i&&n&&Ji(e,i,n),Ji(e,"VER",t.wa),ae(t,e),e}function be(){}function ge(t){for(var i=arguments[0],n=1;n<arguments.length;n++){var e,s=arguments[n];if(0==s.lastIndexOf("/",0))i=s;else(e=""==i)||(e=0<=(e=i.length-1)&&i.indexOf("/",e)==e),i+=e?s:"/"+s}return i}function ye(){if(W&&!(10<=Number(z)))throw Error("Environmental error: no available transport.")}function me(t,i){Pt.call(this),this.a=new Qn(i),this.g=t,this.m=i&&i.fb?i.fb:ge(this.g,"test"),this.b=i&&i.messageUrlParams||null,t=i&&i.messageHeaders||null,i&&i.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=i&&i.initMessageHeaders||null,i&&i.messageContentType&&(t?t["X-WebChannel-Content-Type"]=i.messageContentType:t={"X-WebChannel-Content-Type":i.messageContentType}),i&&i.xa&&(t?t["X-WebChannel-Client-Profile"]=i.xa:t={"X-WebChannel-Client-Profile":i.xa}),this.a.J=t,(t=i&&i.httpHeadersOverwriteParam)&&!j(t)&&(this.a.g=t),this.l=i&&i.supportsCrossDomainXhr||!1,this.h=i&&i.sendRawJson||!1,(i=i&&i.httpSessionIdParam)&&!j(i)&&(this.a.j=i,null!==(t=this.b)&&i in t&&(i in(t=this.b)&&delete t[i])),this.f=new Te(this)}function we(t){vi.call(this);var i=t.__sm__;if(i){t:{for(var n in i){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==i&&t in i?i[t]:void 0):this.data=i}else this.data=t}function Ee(){di.call(this),this.status=1}function Te(t){this.a=t}(i=Hn.prototype).ca=function(t,i,n,e){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);i=i?i.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?li(this.H):li(fi),this.a.onreadystatechange=g(this.Ea,this);try{this.w=!0,this.a.open(i,String(t),!0),this.w=!1}catch(a){return void Yn(this,a)}t=n||"";var r=new Xi(this.headers);e&&Mi(e,function(t,i){r.set(i,t)}),e=S(r.K()),n=s.FormData&&t instanceof s.FormData,!(0<=C(Fn,i))||e||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(t,i){this.a.setRequestHeader(i,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{$n(this),0<this.o&&((this.D=Kn(this.a))?(this.a.timeout=this.o,this.a.ontimeout=g(this.Ba,this)):this.m=Gt(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(a){Yn(this,a)}},i.Ba=function(){void 0!==e&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},i.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Jn(this))},i.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Jn(this,!0)),Hn.N.G.call(this)},i.Ea=function(){this.j||(this.w||this.l||this.g?Gn(this):this.Za())},i.Za=function(){Gn(this)},i.T=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},i.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},i.Ua=function(t){if(this.a){var i=this.a.responseText;return t&&0==i.indexOf(t)&&(i=i.substring(t.length)),_n(i)}},i.ya=function(){return this.h},i.Xa=function(){return r(this.f)?this.f:String(this.f)},(i=Qn.prototype).wa=8,i.u=1,i.Ca=function(){return 0==this.u},i.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var i,n=new gi(this,t=this.P++,void 0),e=this.i;if(this.J&&(e?H(e=D(e),this.J):e=this.J),null===this.g&&(n.h=e),this.W)t:{for(var s=i=0;s<this.f.length;s++){var a=this.f[s];if(void 0===(a="__data__"in a.a&&r(a=a.a.__data__)?a.length:void 0))break;if(4096<(i+=a)){i=s;break t}if(4096===i||s===this.f.length-1){i=s+1;break t}}i=1e3}else i=1e3;i=oe(this,n,i),Ji(s=Ki(this.B),"RID",t),Ji(s,"CVER",22),this.o&&this.j&&Ji(s,"X-HTTP-Session-Id",this.j),ae(this,s),this.g&&e&&zn(s,this.g,e),Pn(this.b,n),this.W?(Ji(s,"$req",i),Ji(s,"SID","null"),n.S=!0,Ei(n,s,null)):Ei(n,s,i),this.u=2}}else 3==this.u&&(t?re(this,t):0==this.f.length||xn(this.b)||re(this))},i.Ga=function(){this.l=null,this.a=new gi(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=Ki(this.pa);Ji(t,"RID","rpc"),Ji(t,"SID",this.H),Ji(t,"CI",this.ia?"0":"1"),Ji(t,"AID",this.O),ae(this,t),Ji(t,"TYPE","xmlhttp"),this.g&&this.i&&zn(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Ti(this.a,t,!0,this.ga)},i.Fa=function(t,i){if(0!=this.u&&(this.a==t||jn(this.b,t)))if(this.m=t.o,!t.s&&jn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(i)}catch(r){n=null}if(l(n)&&3==n.length){if(0==(i=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;ue(this),this.a.cancel(),this.a=null}ce(this),si(18)}}else this.ra=i[1],0<this.ra-this.O&&37500>i[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ai(g(this.Ya,this),6e3));if(1>=On(this.b)&&this.fa){try{this.fa()}catch(r){}this.fa=void 0}}else pe(this,11)}else if((t.s||this.a==t)&&ue(this),!j(i))for(i=n=this.ja.a.parse(i),n=0;n<i.length;n++){var e=i[n];if(this.O=e[0],e=e[1],2==this.u)if("c"==e[0]){this.H=e[1],this.ga=e[2];var s=e[3];null!=s&&(this.wa=s),null!=(e=e[5])&&a(e)&&0<e&&(this.D=1.5*e),this.o&&(e=t.a)&&((s=Vn(e,"X-Client-Wire-Protocol"))&&Sn(this.b,s),this.j&&(e=Vn(e,"X-HTTP-Session-Id")))&&(this.I=e,Ji(this.B,this.j,e)),this.u=3,this.c&&this.c.va(),e=t,this.pa=de(this,this.Y()?this.ga:null,this.ha),e.s?(Rn(this.b,e),(s=this.D)&&e.setTimeout(s),e.i&&(ji(e),xi(e)),this.a=e):he(this),0<this.f.length&&ee(this)}else"stop"!=e[0]&&"close"!=e[0]||pe(this,7);else 3==this.u&&("stop"==e[0]||"close"==e[0]?"stop"==e[0]?pe(this,7):te(this):"noop"!=e[0]&&this.c&&this.c.ua(e),this.v=0)}},i.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,ce(this),si(19))},i.na=function(t){var i=null;if(this.a==t){ue(this),this.a=null;var n=2}else{if(!jn(this.b,t))return;i=t.j,Rn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(i=m()-t.v,ti.dispatchEvent(new ri(ti,t.l?t.l.length:0,i,this.A)),ee(this)):he(this);else{var e=t.c;if(3==e||0==e&&0<this.m||!(1==n&&se(this,t)||2==n&&ce(this)))switch(i&&0<i.length&&(t=this.b,t.c=t.c.concat(i)),e){case 1:pe(this,5);break;case 4:pe(this,10);break;case 3:pe(this,6);break;default:pe(this,2)}}},i.eb=function(t){si(t?2:1)},i.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Hn(this.Ka)).F=this.R,t},i.ma=function(){return!!this.c&&!0},i.Y=function(){return this.R},(i=be.prototype).va=function(){},i.ua=function(){},i.ta=function(){},i.sa=function(){},i.Sa=function(){},ye.prototype.a=function(t,i){return new me(t,i)},w(me,Pt),(i=me.prototype).addEventListener=function(t,i,n,e){me.N.addEventListener.call(this,t,i,n,e)},i.removeEventListener=function(t,i,n,e){me.N.removeEventListener.call(this,t,i,n,e)},i.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,i=this.m,n=this.g,e=this.b||void 0;si(0),t.ha=n,t.V=e||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new gn(t),null===t.g&&(t.w.h=t.i),n=i,t.g&&t.i&&(n=zn(i,t.g,t.i)),(t=t.w).i=n,i=de(t.a,null,t.i),si(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,yn(t)):($i(i,"MODE","init"),!t.a.o&&t.a.j&&$i(i,"X-HTTP-Session-Id",t.a.j),t.b=new gi(t,void 0,void 0),t.b.h=t.h,Ti(t.b,i,!1,null),t.M=0)},i.close=function(){te(this.a)},i.Wa=function(t){if(r(t)){var i={};i.__data__=t,ne(this.a,i)}else this.h?((i={}).__data__=Lt(t),ne(this.a,i)):ne(this.a,t)},i.G=function(){this.a.c=null,delete this.f,te(this.a),delete this.a,me.N.G.call(this)},w(we,vi),w(Ee,di),w(Te,be),Te.prototype.va=function(){this.a.dispatchEvent("a")},Te.prototype.ua=function(t){this.a.dispatchEvent(new we(t))},Te.prototype.ta=function(t){this.a.dispatchEvent(new Ee(t))},Te.prototype.sa=function(){this.a.dispatchEvent("b")};var Ce=y(function(t,i){function n(){}n.prototype=t.prototype;var e=new n;return t.apply(e,Array.prototype.slice.call(arguments,1)),e},ye);ye.prototype.createWebChannel=ye.prototype.a,me.prototype.send=me.prototype.Wa,me.prototype.open=me.prototype.Va,me.prototype.close=me.prototype.close,oi.NO_ERROR=0,oi.TIMEOUT=8,oi.HTTP_ERROR=6,hi.COMPLETE="complete",ui.EventType=pi,pi.OPEN="a",pi.CLOSE="b",pi.ERROR="c",pi.MESSAGE="d",Pt.prototype.listen=Pt.prototype.za,Hn.prototype.listenOnce=Hn.prototype.Aa,Hn.prototype.getLastError=Hn.prototype.Xa,Hn.prototype.getLastErrorCode=Hn.prototype.ya,Hn.prototype.getStatus=Hn.prototype.T,Hn.prototype.getResponseJson=Hn.prototype.Ua,Hn.prototype.getResponseText=Hn.prototype.aa,Hn.prototype.send=Hn.prototype.ca;var Ie={createWebChannelTransport:Ce,ErrorCode:oi,EventType:hi,WebChannel:ui,XhrIo:Hn},Se=Ie.createWebChannelTransport;exports.createWebChannelTransport=Se;var xe=Ie.ErrorCode;exports.ErrorCode=xe;var Oe=Ie.EventType;exports.EventType=Oe;var je=Ie.WebChannel;exports.WebChannel=je;var Pe=Ie.XhrIo;exports.XhrIo=Pe;var Re=Ie;exports.default=Re;
},{}],"eA7g":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(exports,"__esModule",{value:!0});var e,n=require("tslib"),r=(e=require("@firebase/app"))&&"object"==t(e)&&"default"in e?e.default:e,i=require("@firebase/logger"),o=require("@firebase/util"),s=require("@firebase/component"),u=require("@firebase/webchannel-wrapper"),a=r.SDK_VERSION,h=function(){function t(t){this.uid=t}return t.prototype.t=function(){return null!=this.uid},t.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();h.UNAUTHENTICATED=new h(null),h.i=new h("google-credentials-uid"),h.o=new h("first-party-uid");var c={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},f=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return n.__extends(e,t),e}(Error),l=function(t,e){this.user=e,this.type="OAuth",this.h={},this.h.Authorization="Bearer "+t},p=function(){function t(){this.u=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype._=function(){},t.prototype.l=function(t){this.u=t,t(h.UNAUTHENTICATED)},t.prototype.T=function(){this.u=null},t}(),d=function(){function t(t){var e=this;this.m=null,this.currentUser=h.UNAUTHENTICATED,this.I=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.R++,e.currentUser=e.A(),e.I=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.R,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){if(t.R!==e)throw new f(c.ABORTED,"getToken aborted due to token change.");return n?(Te("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new l(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype._=function(){this.forceRefresh=!0},t.prototype.l=function(t){this.u=t,this.I&&t(this.currentUser)},t.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},t.prototype.A=function(){var t=this.auth&&this.auth.getUid();return Te(null===t||"string"==typeof t,"Received invalid UID: "+t),new h(t)},t}(),y=function(){function t(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=h.o}return Object.defineProperty(t.prototype,"h",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),m=function(){function t(t,e){this.P=t,this.V=e}return t.prototype.getToken=function(){return Promise.resolve(new y(this.P,this.V))},t.prototype.l=function(t){t(h.o)},t.prototype.T=function(){},t.prototype._=function(){},t}(),v=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new f(c.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new f(c.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new f(c.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new f(c.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.p=function(t){return this.seconds===t.seconds?Ee(this.nanoseconds,t.nanoseconds):Ee(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),g=function(){function t(t){this.timestamp=t}return t.v=function(e){return new t(e)},t.S=function(){return t.MIN},t.prototype.D=function(t){return this.timestamp.p(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.k=function(){return this.timestamp},t}();g.MIN=new g(new v(0,0));var w=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&_e("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&_e("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.N=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.F(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.$(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.M=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},t.prototype.L=function(){return this.$(this.segments,this.offset,this.length-1)},t.prototype.O=function(){return this.segments[this.offset]},t.prototype.B=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.U=function(){return 0===this.length},t.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},t.F=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.$=function(t,n,r){return new e(t,n,r)},e.prototype.K=function(){return this.j().join("/")},e.prototype.toString=function(){return this.K()},e.G=function(t){if(t.indexOf("//")>=0)throw new f(c.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e}(w);b.H=new b([]);var _=/^[_a-zA-Z][_a-zA-Z0-9]*$/,T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.$=function(t,n,r){return new e(t,n,r)},e.J=function(t){return _.test(t)},e.prototype.K=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.J(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.K()},e.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},e.X=function(){return new e(["__name__"])},e.Z=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new f(c.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new f(c.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new f(c.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new f(c.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e}(w);T.H=new T([]);var I=function(){function t(t){this.path=t}return t.tt=function(e){return new t(b.G(e).M(5))},t.prototype.et=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===b.F(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.F=function(t,e){return b.F(t.path,e.path)},t.st=function(t){return t.length%2==0},t.nt=function(e){return new t(new b(e.slice()))},t}();I.EMPTY=new I(new b([]));var E=function(){function t(t,e){this.F=t,this.root=e||A.EMPTY}return t.prototype.it=function(e,n){return new t(this.F,this.root.it(e,n,this.F).rt(null,null,A.ot,null,null))},t.prototype.remove=function(e){return new t(this.F,this.root.remove(e,this.F).rt(null,null,A.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.U();){var n=this.F(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.U();){var r=this.F(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.U=function(){return this.root.U()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.ht=function(){return this.root.ht()},t.prototype.at=function(){return this.root.at()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.ut(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.ct=function(t){return this.root.ct(t)},t.prototype._t=function(){return new N(this.root,null,this.F,!1)},t.prototype.lt=function(t){return new N(this.root,t,this.F,!1)},t.prototype.dt=function(){return new N(this.root,null,this.F,!0)},t.prototype.ft=function(t){return new N(this.root,t,this.F,!0)},t}(),N=function(){function t(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.U();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}return t.prototype.wt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.U();)this.Et.push(t),t=t.right;else for(t=t.right;!t.U();)this.Et.push(t),t=t.left;return e},t.prototype.It=function(){return this.Et.length>0},t.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},t}(),A=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.rt=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.U=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},t.prototype.min=function(){return this.left.U()?this:this.left.min()},t.prototype.ht=function(){return this.min().key},t.prototype.at=function(){return this.right.U()?this.key:this.right.at()},t.prototype.it=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.rt(null,null,null,r.left.it(t,e,n),null):0===i?r.rt(null,e,null,null,null):r.rt(null,null,null,null,r.right.it(t,e,n))).At()},t.prototype.Pt=function(){if(this.left.U())return t.EMPTY;var e=this;return e.left.Vt()||e.left.left.Vt()||(e=e.gt()),(e=e.rt(null,null,null,e.left.Pt(),null)).At()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.U()||i.left.Vt()||i.left.left.Vt()||(i=i.gt()),i=i.rt(null,null,null,i.left.remove(e,n),null);else{if(i.left.Vt()&&(i=i.pt()),i.right.U()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===n(e,i.key)){if(i.right.U())return t.EMPTY;r=i.right.min(),i=i.rt(r.key,r.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(e,n))}return i.At()},t.prototype.Vt=function(){return this.color},t.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.pt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},t.prototype.gt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.pt())).bt()).vt()),t},t.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.pt()).vt()),t},t.prototype.bt=function(){var e=this.rt(null,null,t.RED,null,this.right.left);return this.right.rt(null,null,this.color,e,null)},t.prototype.pt=function(){var e=this.rt(null,null,t.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,e)},t.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},t.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},t.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw _e("Red node has red child("+this.key+","+this.value+")");if(this.right.Vt())throw _e("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Dt();if(t!==this.right.Dt())throw _e("Black depths differ");return t+(this.Vt()?0:1)},t}();A.EMPTY=null,A.RED=!0,A.ot=!1,A.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw _e("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw _e("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw _e("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw _e("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw _e("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.rt=function(t,e,n,r,i){return this},t.prototype.it=function(t,e,n){return new A(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.U=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ct=function(t){return!1},t.prototype.ht=function(){return null},t.prototype.at=function(){return null},t.prototype.Vt=function(){return!1},t.prototype.St=function(){return!0},t.prototype.Dt=function(){return 0},t}());var S=function(){function t(t){this.F=t,this.data=new E(this.F)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ht()},t.prototype.last=function(){return this.data.at()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut(function(e,n){return t(e),!1})},t.prototype.Ct=function(t,e){for(var n=this.data.lt(t[0]);n.It();){var r=n.wt();if(this.F(r.key,t[1])>=0)return;e(r.key)}},t.prototype.kt=function(t,e){var n;for(n=void 0!==e?this.data.lt(e):this.data._t();n.It();)if(!t(n.wt().key))return},t.prototype.Nt=function(t){var e=this.data.lt(t);return e.It()?e.wt().key:null},t.prototype._t=function(){return new D(this.data._t())},t.prototype.lt=function(t){return new D(this.data.lt(t))},t.prototype.add=function(t){return this.rt(this.data.remove(t).it(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},t.prototype.U=function(){return this.data.U()},t.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data._t(),r=e.data._t();n.It();){var i=n.wt().key,o=r.wt().key;if(0!==this.F(i,o))return!1}return!0},t.prototype.j=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.rt=function(e){var n=new t(this.F);return n.data=e,n},t}(),D=function(){function t(t){this.$t=t}return t.prototype.wt=function(){return this.$t.wt().key},t.prototype.It=function(){return this.$t.It()},t}();function k(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function x(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function R(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var V=function(){function t(t){this.Mt=t}return t.fromBase64String=function(e){return new t(de.Lt().atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return de.Lt().btoa(this.Mt)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Mt)},t.prototype.Ot=function(){return 2*this.Mt.length},t.prototype.D=function(t){return Ee(this.Mt,t.Mt)},t.prototype.isEqual=function(t){return this.Mt===t.Mt},t}();function L(t){return null==t}function U(t){return-0===t&&1/t==-1/0}function O(t){return"number"==typeof t&&Number.isInteger(t)&&!U(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function P(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function C(t){var e=K(t.mapValue.fields.__local_write_time__.timestampValue);return new v(e.seconds,e.nanos)}V.xt=new V("");var M=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function q(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?P(t)?4:10:_e("Invalid value type: "+JSON.stringify(t))}function F(t,e){var n=q(t);if(n!==q(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return C(t).isEqual(C(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=K(t.timestampValue),r=K(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Y(t.bytesValue).isEqual(Y(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return W(t.geoPointValue.latitude)===W(e.geoPointValue.latitude)&&W(t.geoPointValue.longitude)===W(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return W(t.integerValue)===W(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=W(t.doubleValue),r=W(e.doubleValue);return n===r?U(n)===U(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ne(t.arrayValue.values||[],e.arrayValue.values||[],F);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(k(n)!==k(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!F(n[i],r[i])))return!1;return!0}(t,e);default:return _e("Unexpected value type: "+JSON.stringify(t))}}function j(t,e){return void 0!==(t.values||[]).find(function(t){return F(t,e)})}function G(t,e){var n=q(t),r=q(e);if(n!==r)return Ee(n,r);switch(n){case 0:return 0;case 1:return Ee(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=W(t.integerValue||t.doubleValue),r=W(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return B(t.timestampValue,e.timestampValue);case 4:return B(C(t),C(e));case 5:return Ee(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Y(t),r=Y(e);return n.D(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ee(n[i],r[i]);if(0!==o)return o}return Ee(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ee(W(t.latitude),W(e.latitude));return 0!==n?n:Ee(W(t.longitude),W(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=G(n[i],r[i]);if(o)return o}return Ee(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ee(r[s],o[s]);if(0!==u)return u;var a=G(n[r[s]],i[o[s]]);if(0!==a)return a}return Ee(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _e("Invalid value type: "+n)}}function B(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ee(t,e);var n=K(t),r=K(e),i=Ee(n.seconds,r.seconds);return 0!==i?i:Ee(n.nanos,r.nanos)}function z(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=K(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Y(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,I.tt(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):_e("Invalid value type: "+JSON.stringify(e));var n,r}(t)}function K(t){if(Te(!!t,"Cannot normalize null or undefined timestamp."),"string"==typeof t){var e=0,n=M.exec(t);if(Te(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:W(t.seconds),nanos:W(t.nanos)}}function W(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Y(t){return"string"==typeof t?V.fromBase64String(t):V.fromUint8Array(t)}function Q(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.K()}}function J(t){return!!t&&"integerValue"in t}function H(t){return!!t&&"arrayValue"in t}function X(t){return!!t&&"nullValue"in t}function Z(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $(t){return!!t&&"mapValue"in t}var tt=function(){function t(){}return t.prototype.Bt=function(t,e){return function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(e,t)},t.prototype.Ut=function(t,e){return e},t.prototype.qt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t}();tt.instance=new tt;var et=function(){function t(t){this.elements=t}return t.prototype.Bt=function(t,e){return this.apply(t)},t.prototype.Ut=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=it(t),n=function(t){e.some(function(e){return F(e,t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.qt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Ne(this.elements,e.elements,F)},t}(),nt=function(){function t(t){this.elements=t}return t.prototype.Bt=function(t,e){return this.apply(t)},t.prototype.Ut=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=it(t),n=function(t){e=e.filter(function(e){return!F(e,t)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.qt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Ne(this.elements,e.elements,F)},t}(),rt=function(){function t(t,e){this.serializer=t,this.Qt=e}return t.prototype.Bt=function(t,e){var n=this.qt(t),r=this.asNumber(n)+this.asNumber(this.Qt);return J(n)&&J(this.Qt)?this.serializer.Wt(r):this.serializer.jt(r)},t.prototype.Ut=function(t,e){return e},t.prototype.qt=function(t){return J(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},t.prototype.isEqual=function(e){return e instanceof t&&F(this.Qt,e.Qt)},t.prototype.asNumber=function(t){return W(t.integerValue||t.doubleValue)},t}();function it(t){return H(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ot=function(){function t(t){this.fields=t}return t.Kt=function(e){return new t(e)},t.Gt=function(e){var n=new S(T.F);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.zt=function(t){var e=!1;return this.fields.forEach(function(n){n.q(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),st=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),ut=function(t,e){this.version=t,this.transformResults=e},at=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Ht",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Jt=function(t){return void 0!==this.updateTime?t instanceof gt&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof gt},t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();at.NONE=new at;var ht=function(){function t(){}return t.prototype.Yt=function(t){},t.Xt=function(t){return t instanceof gt?t.version:g.MIN},t}(),ct=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Zt=r,i.type=0,i}return n.__extends(e,t),e.prototype.Ut=function(t,e){this.Yt(t);var n=e.version;return new gt(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.Bt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var r=ht.Xt(t);return new gt(this.key,r,this.value,{te:!0})},e.prototype.ee=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},e}(ht),ft=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.se=r,o.Zt=i,o.type=1,o}return n.__extends(e,t),e.prototype.Ut=function(t,e){if(this.Yt(t),!this.Zt.Jt(t))return new bt(this.key,e.version);var n=this.ne(t);return new gt(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.Bt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var r=ht.Xt(t),i=this.ne(t);return new gt(this.key,r,i,{te:!0})},e.prototype.ee=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},e.prototype.ne=function(t){var e;return e=t instanceof gt?t.data():yt.EMPTY,this.ie(e)},e.prototype.ie=function(t){var e=this,n=t.re();return this.se.fields.forEach(function(t){if(!t.U()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}}),n.oe()},e}(ht),lt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Zt=at.exists(!0),r}return n.__extends(e,t),e.prototype.Ut=function(t,e){if(this.Yt(t),Te(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.Zt.Jt(t))return new bt(this.key,e.version);var n=this.he(t),r=this.ae(t,e.transformResults),i=e.version,o=this.ue(n.data(),r);return new gt(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.Bt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var r=this.he(t),i=this.ce(n,t,e),o=this.ue(r.data(),i);return new gt(this.key,r.version,o,{te:!0})},e.prototype.ee=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof gt?t.field(i.field):void 0,s=i.transform.qt(o||null);null!=s&&(e=null==e?yt._e().set(i.field,s):e.set(i.field,s))}return e?e.oe():null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&Ne(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},e.prototype.he=function(t){return t},e.prototype.ae=function(t,e){var n=[];Te(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof gt&&(s=t.field(i.field)),n.push(o.Ut(s,e[r]))}return n},e.prototype.ce=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof gt&&(a=e.field(s.field)),null===a&&n instanceof gt&&(a=n.field(s.field)),r.push(u.Bt(a,t))}return r},e.prototype.ue=function(t,e){for(var n=t.re(),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.oe()},e}(ht),pt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Zt=n,r.type=3,r}return n.__extends(e,t),e.prototype.Ut=function(t,e){return this.Yt(t),new wt(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.Bt=function(t,e,n){return this.Yt(t),this.Zt.Jt(t)?new wt(this.key,g.S()):t},e.prototype.ee=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},e}(ht),dt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Zt=n,r.type=4,r}return n.__extends(e,t),e.prototype.Ut=function(t,e){_e("VerifyMutation should only be used in Transactions.")},e.prototype.Bt=function(t,e,n){_e("VerifyMutation should only be used in Transactions.")},e.prototype.ee=function(t){_e("VerifyMutation should only be used in Transactions.")},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},e}(ht),yt=function(){function t(t){this.proto=t}return t._e=function(){return t.EMPTY.re()},t.prototype.field=function(t){if(t.U())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!$(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.B()])||null},t.prototype.se=function(){return this.le(this.proto.mapValue)},t.prototype.le=function(t){var e=this,n=new S(T.F);return x(t.fields||{},function(t,r){var i=new T([t]);if(10===q(r)){var o=e.le(r.mapValue).fields;o.U()?n=n.add(i):o.forEach(function(t){n=n.add(i.child(t))})}else n=n.add(i)}),ot.Kt(n)},t.prototype.isEqual=function(t){return F(this.proto,t.proto)},t.prototype.re=function(){return new mt(this)},t}();yt.EMPTY=new yt({mapValue:{}});var mt=function(){function t(t){this.de=t,this.fe=new Map}return t.prototype.set=function(t,e){return this.Te(t,e),this},t.prototype.delete=function(t){return this.Te(t,null),this},t.prototype.Te=function(t,e){for(var n=this.fe,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===q(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.B(),e)},t.prototype.oe=function(){var t=this.me(T.H,this.fe);return null!=t?new yt(t):this.de},t.prototype.me=function(t,e){var n=this,r=!1,i=this.de.field(t),o=$(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.me(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}(),vt=function(){function t(t,e){this.key=t,this.version=e}return t.Ee=function(t,e){return I.F(t.key,e.key)},t}(),gt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).we=r,o.te=!!i.te,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return n.__extends(e,t),e.prototype.field=function(t){return this.we.field(t)},e.prototype.data=function(){return this.we},e.prototype.Ie=function(){return this.we.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.Re=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?G(r,i):_e("Trying to compare documents on fields that don't exist")},e}(vt),wt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return n.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(vt),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(vt),_t=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Ae=null}return t.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.K();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),L(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},t.prototype.toString=function(){var t=this.path.K();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),L(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.Pe=function(){return I.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),Tt=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=r,this.limit=i,this.ge=o,this.startAt=s,this.endAt=u,this.pe=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}return t.ve=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.pe){var t=this.Se(),e=this.De();if(null!==t&&null===e)t.Y()?this.pe=[Ot]:this.pe=[new Ut(t),Ot];else{this.pe=[];for(var n=!1,r=0,i=this.Ve;r<i.length;r++){var o=i[r];this.pe.push(o),o.field.Y()&&(n=!0)}if(!n){var s=this.Ve.length>0?this.Ve[this.Ve.length-1].dir:xt.ASCENDING;this.pe.push(s===xt.ASCENDING?Ot:Pt)}}}return this.pe},enumerable:!0,configurable:!0}),t.prototype.Ce=function(e){var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.Ve.slice(),n,this.limit,this.ge,this.startAt,this.endAt)},t.prototype.ke=function(e){var n=this.Ve.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.ge,this.startAt,this.endAt)},t.prototype.Ne=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),e,"F",this.startAt,this.endAt)},t.prototype.Fe=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),e,"L",this.startAt,this.endAt)},t.prototype.$e=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,e,this.endAt)},t.prototype.Me=function(e){return new t(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,this.startAt,e)},t.prototype.Le=function(e){return new t(e,null,this.Ve.slice(),this.filters.slice(),this.limit,this.ge,this.startAt,this.endAt)},t.prototype.Oe=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.Y())},t.prototype.canonicalId=function(){return this.xe().canonicalId()+"|lt:"+this.ge},t.prototype.toString=function(){return"Query(target="+this.xe().toString()+"; limitType="+this.ge+")"},t.prototype.isEqual=function(t){return this.xe().isEqual(t.xe())&&this.ge===t.ge},t.prototype.Be=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},t.prototype.matches=function(t){return this.Ue(t)&&this.qe(t)&&this.Qe(t)&&this.We(t)},t.prototype.je=function(){return!L(this.limit)&&"F"===this.ge},t.prototype.Ke=function(){return!L(this.limit)&&"L"===this.ge},t.prototype.De=function(){return this.Ve.length>0?this.Ve[0].field:null},t.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Et&&n.Ge())return n.field}return null},t.prototype.ze=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Et&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.Pe=function(){return this.xe().Pe()},t.prototype.He=function(){return null!==this.collectionGroup},t.prototype.xe=function(){if(!this.ye)if("F"===this.ge)this.ye=new _t(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===xt.DESCENDING?xt.ASCENDING:xt.DESCENDING;t.push(new Ut(r.field,i))}var o=this.endAt?new Lt(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Lt(this.startAt.position,!this.startAt.before):null;this.ye=new _t(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},t.prototype.Ue=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.q(e):I.st(this.path)?this.path.isEqual(e):this.path.W(e)},t.prototype.qe=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},t.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.We=function(t){return!(this.startAt&&!this.startAt.Je(this.orderBy,t)||this.endAt&&this.endAt.Je(this.orderBy,t))},t.prototype.be=function(t){},t}(),It=function(){function t(t){this.name=t}return t.G=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return _e("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t}();It.LESS_THAN=new It("<"),It.LESS_THAN_OR_EQUAL=new It("<="),It.EQUAL=new It("=="),It.GREATER_THAN=new It(">"),It.GREATER_THAN_OR_EQUAL=new It(">="),It.ARRAY_CONTAINS=new It("array-contains"),It.IN=new It("in"),It.ARRAY_CONTAINS_ANY=new It("array-contains-any");var Et=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return n.__extends(e,t),e.create=function(t,n,r){if(t.Y())return n===It.IN?new At(t,r):new Nt(t,n,r);if(X(r)){if(n!==It.EQUAL)throw new f(c.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(Z(r)){if(n!==It.EQUAL)throw new f(c.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===It.ARRAY_CONTAINS?new St(t,r):n===It.IN?new Dt(t,r):n===It.ARRAY_CONTAINS_ANY?new kt(t,r):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&q(this.value)===q(e)&&this.Ye(G(e,this.value))},e.prototype.Ye=function(t){switch(this.op){case It.LESS_THAN:return t<0;case It.LESS_THAN_OR_EQUAL:return t<=0;case It.EQUAL:return 0===t;case It.GREATER_THAN:return t>0;case It.GREATER_THAN_OR_EQUAL:return t>=0;default:return _e("Unknown FieldFilter operator: "+this.op)}},e.prototype.Ge=function(){return[It.LESS_THAN,It.LESS_THAN_OR_EQUAL,It.GREATER_THAN,It.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.K()+this.op.toString()+z(this.value)},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&F(this.value,t.value)},e.prototype.toString=function(){return this.field.K()+" "+this.op+" "+z(this.value)},e}(function(){}),Nt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=I.tt(r.referenceValue),i}return n.__extends(e,t),e.prototype.matches=function(t){var e=I.F(t.key,this.key);return this.Ye(e)},e}(Et),At=function(t){function e(e,n){var r=this;return(r=t.call(this,e,It.IN,n)||this).keys=(n.arrayValue.values||[]).map(function(t){return I.tt(t.referenceValue)}),r}return n.__extends(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Et),St=function(t){function e(e,n){return t.call(this,e,It.ARRAY_CONTAINS,n)||this}return n.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return H(e)&&j(e.arrayValue,this.value)},e}(Et),Dt=function(t){function e(e,n){return t.call(this,e,It.IN,n)||this}return n.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&j(this.value.arrayValue,e)},e}(Et),kt=function(t){function e(e,n){return t.call(this,e,It.ARRAY_CONTAINS_ANY,n)||this}return n.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!H(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return j(e.value.arrayValue,t)})},e}(Et),xt=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t}();xt.ASCENDING=new xt("asc"),xt.DESCENDING=new xt("desc");var Rt,Vt,Lt=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return z(t)}).join(",")},t.prototype.Je=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.Y()?I.F(I.tt(o.referenceValue),e.key):G(o,e.field(i.field)),i.dir===xt.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!F(this.position[e],t.position[e]))return!1;return!0},t}(),Ut=function(){function t(t,e){this.field=t,void 0===e&&(e=xt.ASCENDING),this.dir=e,this.Xe=t.Y()}return t.prototype.compare=function(t,e){var n=this.Xe?gt.Ee(t,e):gt.Re(this.field,t,e);switch(this.dir){case xt.ASCENDING:return n;case xt.DESCENDING:return-1*n;default:return _e("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.K()+this.dir.toString()},t.prototype.toString=function(){return this.field.K()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Ot=new Ut(T.X(),xt.ASCENDING),Pt=new Ut(T.X(),xt.DESCENDING),Ct=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=g.MIN),void 0===o&&(o=g.MIN),void 0===s&&(s=V.xt),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=r,this.ts=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.es=function(e){return new t(this.target,this.targetId,this.Ze,e,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.ss=function(e,n){return new t(this.target,this.targetId,this.Ze,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.ns=function(e){return new t(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,e,this.resumeToken)},t}(),Mt=function(t){this.count=t};function qt(t){switch(t){case c.OK:return _e("Treated status OK as error");case c.CANCELLED:case c.UNKNOWN:case c.DEADLINE_EXCEEDED:case c.RESOURCE_EXHAUSTED:case c.INTERNAL:case c.UNAVAILABLE:case c.UNAUTHENTICATED:return!1;case c.INVALID_ARGUMENT:case c.NOT_FOUND:case c.ALREADY_EXISTS:case c.PERMISSION_DENIED:case c.FAILED_PRECONDITION:case c.ABORTED:case c.OUT_OF_RANGE:case c.UNIMPLEMENTED:case c.DATA_LOSS:return!0;default:return _e("Unknown status code: "+t)}}function Ft(t){if(void 0===t)return we("GRPC error has no .code"),c.UNKNOWN;switch(t){case Rt.OK:return c.OK;case Rt.CANCELLED:return c.CANCELLED;case Rt.UNKNOWN:return c.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return c.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return c.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return c.INTERNAL;case Rt.UNAVAILABLE:return c.UNAVAILABLE;case Rt.UNAUTHENTICATED:return c.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return c.INVALID_ARGUMENT;case Rt.NOT_FOUND:return c.NOT_FOUND;case Rt.ALREADY_EXISTS:return c.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return c.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return c.FAILED_PRECONDITION;case Rt.ABORTED:return c.ABORTED;case Rt.OUT_OF_RANGE:return c.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return c.UNIMPLEMENTED;case Rt.DATA_LOSS:return c.DATA_LOSS;default:return _e("Unknown status code: "+t)}}(Vt=Rt||(Rt={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";var jt=new E(I.F);function Gt(){return jt}function Bt(){return Gt()}var zt=new E(I.F);function Kt(){return zt}var Wt=new E(I.F);function Yt(){return Wt}var Qt=new S(I.F);function Jt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Qt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ht=new S(Ee);function Xt(){return Ht}var Zt=function(){function t(t){this.F=t?function(e,n){return t(e,n)||I.F(e.key,n.key)}:function(t,e){return I.F(t.key,e.key)},this.rs=Kt(),this.os=new E(this.F)}return t.hs=function(e){return new t(e.F)},t.prototype.has=function(t){return null!=this.rs.get(t)},t.prototype.get=function(t){return this.rs.get(t)},t.prototype.first=function(){return this.os.ht()},t.prototype.last=function(){return this.os.at()},t.prototype.U=function(){return this.os.U()},t.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.os.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.os.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.os.ut(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.it(t.key,t),e.os.it(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.os.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.os._t(),r=e.os._t();n.It();){var i=n.wt().key,o=r.wt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.rt=function(e,n){var r=new t;return r.F=this.F,r.rs=e,r.os=n,r},t}(),$t=function(){function t(){this.as=new E(I.F)}return t.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);n?0!==t.type&&3===n.type?this.as=this.as.it(e,t):3===t.type&&1!==n.type?this.as=this.as.it(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.it(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.it(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.it(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.it(e,{type:2,doc:t.doc}):_e("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.as=this.as.it(e,t)},t.prototype.us=function(){var t=[];return this.as.ut(function(e,n){t.push(n)}),t},t}(),te=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=r,this._s=i,this.fromCache=o,this.ls=s,this.ds=u}return t.fs=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Zt.hs(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this._s.U()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ls===t.ls&&this._s.isEqual(t._s)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),ee=function(){function t(t,e,n,r,i){this.ts=t,this.Ts=e,this.ms=n,this.Es=r,this.ws=i}return t.Is=function(e,n){var r=new Map;return r.set(e,ne.Rs(e,n)),new t(g.MIN,r,Xt(),Gt(),Jt())},t}(),ne=function(){function t(t,e,n,r,i){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=r,this.gs=i}return t.Rs=function(e,n){return new t(V.xt,n,Jt(),Jt(),Jt())},t}(),re=function(t,e,n,r){this.ps=t,this.removedTargetIds=e,this.key=n,this.ys=r},ie=function(t,e){this.targetId=t,this.bs=e},oe=function(t,e,n,r){void 0===n&&(n=V.xt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},se=function(){function t(){this.vs=0,this.Ss=he(),this.Ds=V.xt,this.Cs=!1,this.ks=!0}return Object.defineProperty(t.prototype,"As",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Fs",{get:function(){return this.ks},enumerable:!0,configurable:!0}),t.prototype.$s=function(t){t.Ot()>0&&(this.ks=!0,this.Ds=t)},t.prototype.Ms=function(){var t=Jt(),e=Jt(),n=Jt();return this.Ss.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:_e("Encountered invalid change type: "+i)}}),new ne(this.Ds,this.Cs,t,e,n)},t.prototype.Ls=function(){this.ks=!1,this.Ss=he()},t.prototype.Os=function(t,e){this.ks=!0,this.Ss=this.Ss.it(t,e)},t.prototype.xs=function(t){this.ks=!0,this.Ss=this.Ss.remove(t)},t.prototype.Bs=function(){this.vs+=1},t.prototype.Us=function(){this.vs-=1},t.prototype.qs=function(){this.ks=!0,this.Cs=!0},t}(),ue=function(){function t(t){this.Qs=t,this.Ws=new Map,this.js=Gt(),this.Ks=ae(),this.Gs=new S(Ee)}return t.prototype.zs=function(t){for(var e=0,n=t.ps;e<n.length;e++){var r=n[e];t.ys instanceof gt?this.Hs(r,t.ys):t.ys instanceof wt&&this.Js(r,t.key,t.ys)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Js(s,t.key,t.ys)}},t.prototype.Ys=function(t){var e=this;this.Xs(t,function(n){var r=e.Zs(n);switch(t.state){case 0:e.tn(n)&&r.$s(t.resumeToken);break;case 1:r.Us(),r.Ns||r.Ls(),r.$s(t.resumeToken);break;case 2:r.Us(),r.Ns||e.removeTarget(n);break;case 3:e.tn(n)&&(r.qs(),r.$s(t.resumeToken));break;case 4:e.tn(n)&&(e.en(n),r.$s(t.resumeToken));break;default:_e("Unknown target watch change state: "+t.state)}})},t.prototype.Xs=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Ws.forEach(function(t,r){n.tn(r)&&e(r)})},t.prototype.sn=function(t){var e=t.targetId,n=t.bs.count,r=this.nn(e);if(r){var i=r.target;if(i.Pe())if(0===n){var o=new I(i.path);this.Js(e,o,new wt(o,g.S()))}else Te(1===n,"Single document existence filter with count: "+n);else this.in(e)!==n&&(this.en(e),this.Gs=this.Gs.add(e))}},t.prototype.rn=function(t){var e=this,n=new Map;this.Ws.forEach(function(r,i){var o=e.nn(i);if(o){if(r.As&&o.target.Pe()){var s=new I(o.target.path);null!==e.js.get(s)||e.on(i,s)||e.Js(i,s,new wt(s,t))}r.Fs&&(n.set(i,r.Ms()),r.Ls())}});var r=Jt();this.Ks.forEach(function(t,n){var i=!0;n.kt(function(t){var n=e.nn(t);return!n||2===n.Ze||(i=!1,!1)}),i&&(r=r.add(t))});var i=new ee(t,n,this.Gs,this.js,r);return this.js=Gt(),this.Ks=ae(),this.Gs=new S(Ee),i},t.prototype.Hs=function(t,e){if(this.tn(t)){var n=this.on(t,e.key)?2:0;this.Zs(t).Os(e.key,n),this.js=this.js.it(e.key,e),this.Ks=this.Ks.it(e.key,this.hn(e.key).add(t))}},t.prototype.Js=function(t,e,n){if(this.tn(t)){var r=this.Zs(t);this.on(t,e)?r.Os(e,1):r.xs(e),this.Ks=this.Ks.it(e,this.hn(e).delete(t)),n&&(this.js=this.js.it(e,n))}},t.prototype.removeTarget=function(t){this.Ws.delete(t)},t.prototype.in=function(t){var e=this.Zs(t).Ms();return this.Qs.an(t).size+e.Ps.size-e.gs.size},t.prototype.Bs=function(t){this.Zs(t).Bs()},t.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new se,this.Ws.set(t,e)),e},t.prototype.hn=function(t){var e=this.Ks.get(t);return e||(e=new S(Ee),this.Ks=this.Ks.it(t,e)),e},t.prototype.tn=function(t){var e=null!==this.nn(t);return e||ge("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.nn=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.un(t)},t.prototype.en=function(t){var e=this;this.Ws.set(t,new se),this.Qs.an(t).forEach(function(n){e.Js(t,n,null)})},t.prototype.on=function(t,e){return this.Qs.an(t).has(e)},t}();function ae(){return new E(I.F)}function he(){return new E(I.F)}var ce=function(){var t={};return t[xt.ASCENDING.name]="ASCENDING",t[xt.DESCENDING.name]="DESCENDING",t}(),fe=function(){var t={};return t[It.LESS_THAN.name]="LESS_THAN",t[It.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[It.GREATER_THAN.name]="GREATER_THAN",t[It.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[It.EQUAL.name]="EQUAL",t[It.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",t[It.IN.name]="IN",t[It.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",t}(),le=function(){function e(t,e){this.cn=t,this.options=e}return e.prototype._n=function(t){var e=void 0===t.code?c.UNKNOWN:Ft(t.code);return new f(e,t.message||"")},e.prototype.ln=function(t){return this.options.dn||L(t)?t:{value:t}},e.prototype.fn=function(e){var n;return L(n="object"==t(e)?e.value:e)?null:n},e.prototype.Wt=function(t){return{integerValue:""+t}},e.prototype.jt=function(t){if(this.options.dn){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:U(t)?"-0":t}},e.prototype.Tn=function(t){return O(t)?this.Wt(t):this.jt(t)},e.prototype.k=function(t){return this.options.dn?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},e.prototype.v=function(t){var e=K(t);return new v(e.seconds,e.nanos)},e.prototype.mn=function(t){return this.options.dn?t.toBase64():t.toUint8Array()},e.prototype.En=function(t){return this.options.dn?(Te(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),V.fromBase64String(t||"")):(Te(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),V.fromUint8Array(t||new Uint8Array))},e.prototype.toVersion=function(t){return this.k(t.k())},e.prototype.fromVersion=function(t){return Te(!!t,"Trying to deserialize version that isn't set"),g.v(this.v(t))},e.prototype.wn=function(t,e){return this.In(e||this.cn).child("documents").child(t).K()},e.prototype.Rn=function(t){var e=b.G(t);return Te(pe(e),"Tried to deserialize invalid key "+e.toString()),e},e.prototype.An=function(t){return this.wn(t.path)},e.prototype.tt=function(t){var e=this.Rn(t);return Te(e.get(1)===this.cn.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.cn.projectId),Te(!e.get(3)&&!this.cn.database||e.get(3)===this.cn.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.cn.database),new I(this.Pn(e))},e.prototype.Vn=function(t){return this.wn(t)},e.prototype.gn=function(t){var e=this.Rn(t);return 4===e.length?b.H:this.Pn(e)},Object.defineProperty(e.prototype,"pn",{get:function(){return new b(["projects",this.cn.projectId,"databases",this.cn.database]).K()},enumerable:!0,configurable:!0}),e.prototype.In=function(t){return new b(["projects",t.projectId,"databases",t.database])},e.prototype.Pn=function(t){return Te(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.M(5)},e.prototype.yn=function(t,e){return{name:this.An(t),fields:e.proto.mapValue.fields}},e.prototype.bn=function(t){return{name:this.An(t.key),fields:t.Ie().mapValue.fields,updateTime:this.k(t.version.k())}},e.prototype.vn=function(t,e){var n=this.tt(t.name),r=this.fromVersion(t.updateTime),i=new yt({mapValue:{fields:t.fields}});return new gt(n,r,i,{hasCommittedMutations:!!e})},e.prototype.Sn=function(t){Te(!!t.found,"Tried to deserialize a found document from a missing document."),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),r=new yt({mapValue:{fields:t.found.fields}});return new gt(e,n,r,{})},e.prototype.Dn=function(t){Te(!!t.missing,"Tried to deserialize a missing document from a found document."),Te(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new wt(e,n)},e.prototype.Cn=function(t){return"found"in t?this.Sn(t):"missing"in t?this.Dn(t):_e("invalid batch get response: "+JSON.stringify(t))},e.prototype.kn=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Nn(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.En(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this._n(o);e=new oe(n,r,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.tt(u.document.name),h=this.fromVersion(u.document.updateTime),c=new yt({mapValue:{fields:u.document.fields}}),f=new gt(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new re(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.tt(d.document),m=d.readTime?this.fromVersion(d.readTime):g.S(),v=new wt(y,m),w=d.removedTargetIds||[];e=new re([],w,v.key,v)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var _=this.tt(b.document),T=b.removedTargetIds||[];e=new re([],T,_,null)}else{if(!("filter"in t))return _e("Unknown change type "+JSON.stringify(t));t.filter;var I=t.filter;I.targetId;var E=I.count||0,N=new Mt(E),A=I.targetId;e=new ie(A,N)}return e},e.prototype.Nn=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:_e("Got unexpected TargetChange.state: "+t)},e.prototype.Fn=function(t){if(!("targetChange"in t))return g.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?g.MIN:e.readTime?this.fromVersion(e.readTime):g.MIN},e.prototype.$n=function(t){var e,n=this;if(t instanceof ct)e={update:this.yn(t.key,t.value)};else if(t instanceof pt)e={delete:this.An(t.key)};else if(t instanceof ft)e={update:this.yn(t.key,t.data),updateMask:this.Mn(t.se)};else if(t instanceof lt)e={transform:{document:this.An(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ln(t)})}};else{if(!(t instanceof dt))return _e("Unknown mutation type "+t.type);e={verify:this.An(t.key)}}return t.Zt.Ht||(e.currentDocument=this.On(t.Zt)),e},e.prototype.xn=function(t){var e=this,n=t.currentDocument?this.Bn(t.currentDocument):at.NONE;if(t.update){t.update.name;var r=this.tt(t.update.name),i=new yt({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.Un(t.updateMask);return new ft(r,i,o,n)}return new ct(r,i,n)}if(t.delete){var s=this.tt(t.delete);return new pt(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.qn(t)});return Te(!0===n.exists,'Transforms only support precondition "exists == true"'),new lt(u,a)}if(t.verify){var h=this.tt(t.verify);return new dt(h,n)}return _e("unknown mutation proto: "+JSON.stringify(t))},e.prototype.On=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:_e("Unknown precondition")},e.prototype.Bn=function(t){return void 0!==t.updateTime?at.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?at.exists(t.exists):at.NONE},e.prototype.Qn=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(g.MIN)&&(n=this.fromVersion(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new ut(n,r)},e.prototype.Wn=function(t,e){var n=this;return t&&t.length>0?(Te(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.Qn(t,e)})):[]},e.prototype.Ln=function(t){var e=t.transform;if(e instanceof tt)return{fieldPath:t.field.K(),setToServerValue:"REQUEST_TIME"};if(e instanceof et)return{fieldPath:t.field.K(),appendMissingElements:{values:e.elements}};if(e instanceof nt)return{fieldPath:t.field.K(),removeAllFromArray:{values:e.elements}};if(e instanceof rt)return{fieldPath:t.field.K(),increment:e.Qt};throw _e("Unknown transform: "+t.transform)},e.prototype.qn=function(t){var e=null;if("setToServerValue"in t)Te("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),e=tt.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new et(n)}else if("removeAllFromArray"in t){var r=t.removeAllFromArray.values||[];e=new nt(r)}else"increment"in t?e=new rt(this,t.increment):_e("Unknown transform proto: "+JSON.stringify(t));var i=T.Z(t.fieldPath);return new st(i,e)},e.prototype.jn=function(t){return{documents:[this.Vn(t.path)]}},e.prototype.Kn=function(t){var e=t.documents.length;Te(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Tt.ve(this.gn(n)).xe()},e.prototype.Gn=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vn(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vn(n.L()),e.structuredQuery.from=[{collectionId:n.B()}]);var r=this.zn(t.filters);r&&(e.structuredQuery.where=r);var i=this.Hn(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ln(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Jn(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Jn(t.endAt)),e},e.prototype.Yn=function(t){var e=this.gn(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Te(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xn(n.where));var u=[];n.orderBy&&(u=this.Zn(n.orderBy));var a=null;n.limit&&(a=this.fn(n.limit));var h=null;n.startAt&&(h=this.ti(n.startAt));var c=null;return n.endAt&&(c=this.ti(n.endAt)),new Tt(e,i,u,s,a,"F",h,c).xe()},e.prototype.ei=function(t){var e=this.si(t.Ze);return null==e?null:{"goog-listen-tags":e}},e.prototype.si=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _e("Unrecognized query purpose: "+t)}},e.prototype.xe=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.jn(n)}:{query:this.Gn(n)}).targetId=t.targetId,t.resumeToken.Ot()>0&&(e.resumeToken=this.mn(t.resumeToken)),e},e.prototype.zn=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Et?e.ni(t):_e("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},e.prototype.Xn=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.ii(t)]:void 0!==t.fieldFilter?[this.ri(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xn(t)}).reduce(function(t,e){return t.concat(e)}):_e("Unknown filter: "+JSON.stringify(t)):[]},e.prototype.Hn=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.oi(t)})},e.prototype.Zn=function(t){var e=this;return t.map(function(t){return e.hi(t)})},e.prototype.Jn=function(t){return{before:t.before,values:t.position}},e.prototype.ti=function(t){var e=!!t.before,n=t.values||[];return new Lt(n,e)},e.prototype.ai=function(t){return ce[t.name]},e.prototype.ui=function(t){switch(t){case"ASCENDING":return xt.ASCENDING;case"DESCENDING":return xt.DESCENDING;default:return}},e.prototype.ci=function(t){return fe[t.name]},e.prototype._i=function(t){switch(t){case"EQUAL":return It.EQUAL;case"GREATER_THAN":return It.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return It.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return It.LESS_THAN;case"LESS_THAN_OR_EQUAL":return It.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return It.ARRAY_CONTAINS;case"IN":return It.IN;case"ARRAY_CONTAINS_ANY":return It.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return _e("Unspecified operator");default:return _e("Unknown operator")}},e.prototype.li=function(t){return{fieldPath:t.K()}},e.prototype.di=function(t){return T.Z(t.fieldPath)},e.prototype.oi=function(t){return{field:this.li(t.field),direction:this.ai(t.dir)}},e.prototype.hi=function(t){return new Ut(this.di(t.field),this.ui(t.direction))},e.prototype.ri=function(t){return Et.create(this.di(t.fieldFilter.field),this._i(t.fieldFilter.op),t.fieldFilter.value)},e.prototype.ni=function(t){if(t.op===It.EQUAL){if(Z(t.value))return{unaryFilter:{field:this.li(t.field),op:"IS_NAN"}};if(X(t.value))return{unaryFilter:{field:this.li(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.li(t.field),op:this.ci(t.op),value:t.value}}},e.prototype.ii=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.di(t.unaryFilter.field);return Et.create(e,It.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.di(t.unaryFilter.field);return Et.create(n,It.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _e("Unspecified filter");default:return _e("Unknown filter")}},e.prototype.Mn=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.K())}),{fieldPaths:e}},e.prototype.Un=function(t){var e=(t.fieldPaths||[]).map(function(t){return T.Z(t)});return ot.Gt(e)},e}();function pe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var de=function(){function t(){}return t.fi=function(e){t.platform&&_e("Platform already defined"),t.platform=e},t.Lt=function(){return t.platform||_e("Platform not set"),t.platform},t}(),ye=new i.Logger("@firebase/firestore");function me(){return ye.logLevel}function ve(t){ye.logLevel=t}function ge(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(ye.logLevel<=i.LogLevel.DEBUG){var o=e.map(be);ye.debug.apply(ye,n.__spreadArrays(["Firestore ("+a+"): "+t],o))}}function we(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(ye.logLevel<=i.LogLevel.ERROR){var o=e.map(be);ye.error.apply(ye,n.__spreadArrays(["Firestore ("+a+"): "+t],o))}}function be(t){if("string"==typeof t)return t;var e=de.Lt();try{return e.Ti(t)}catch(e){return t}}function _e(t){var e="FIRESTORE ("+a+") INTERNAL ASSERTION FAILED: "+t;throw we(e),new Error(e)}function Te(t,e){t||_e(e)}var Ie=function(){function t(){}return t.mi=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},t}();function Ee(t,e){return t<e?-1:t>e?1:0}function Ne(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Ae(t){return t+"\0"}var Se=function(t,e,n,r,i){this.cn=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},De=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"Ei",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.D=function(t){return Ee(this.projectId,t.projectId)||Ee(this.database,t.database)},t}(),ke=function(){function t(t){this.wi=t,this.Ii={}}return t.prototype.get=function(t){var e=this.wi(t),n=this.Ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.wi(t),r=this.Ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.wi(t),n=this.Ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.Ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){x(this.Ii,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}})},t.prototype.U=function(){return R(this.Ii)},t}(),xe=function(){function t(t,e,n,r){this.batchId=t,this.Ri=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ut=function(t,e,n){for(var r=n.Ai,i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.Ut(e,s)}}return e},t.prototype.Bt=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.Bt(e,e,this.Ri))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.Bt(e,o,this.Ri))}return e},t.prototype.Pi=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.Bt(r.key,t.get(r.key));i&&(n=n.it(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Jt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ne(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Ne(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},t}(),Re=function(){function t(t,e,n,r,i){this.batch=t,this.Vi=e,this.Ai=n,this.streamToken=r,this.gi=i}return t.from=function(e,n,r,i){Te(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Yt(),s=e.mutations,u=0;u<s.length;u++)o=o.it(s[u].key,r[u].version);return new t(e,n,r,i,o)},t}(),Ve=function(){function t(){this.pi=new S(Le.Ee),this.yi=new S(Le.bi)}return t.prototype.U=function(){return this.pi.U()},t.prototype.vi=function(t,e){var n=new Le(t,e);this.pi=this.pi.add(n),this.yi=this.yi.add(n)},t.prototype.Si=function(t,e){var n=this;t.forEach(function(t){return n.vi(t,e)})},t.prototype.Di=function(t,e){this.Ci(new Le(t,e))},t.prototype.ki=function(t,e){var n=this;t.forEach(function(t){return n.Di(t,e)})},t.prototype.Ni=function(t){var e=this,n=I.EMPTY,r=new Le(n,t),i=new Le(n,t+1),o=[];return this.yi.Ct([r,i],function(t){e.Ci(t),o.push(t.key)}),o},t.prototype.Fi=function(){var t=this;this.pi.forEach(function(e){return t.Ci(e)})},t.prototype.Ci=function(t){this.pi=this.pi.delete(t),this.yi=this.yi.delete(t)},t.prototype.$i=function(t){var e=I.EMPTY,n=new Le(e,t),r=new Le(e,t+1),i=Jt();return this.yi.Ct([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Mi=function(t){var e=new Le(t,0),n=this.pi.Nt(e);return null!==n&&t.isEqual(n.key)},t}(),Le=function(){function t(t,e){this.key=t,this.Li=e}return t.Ee=function(t,e){return I.F(t.key,e.key)||Ee(t.Li,e.Li)},t.bi=function(t,e){return Ee(t.Li,e.Li)||I.F(t.key,e.key)},t}(),Ue=function(){function t(t){var e=this;this.Oi=null,this.xi=null,this.result=void 0,this.error=void 0,this.Bi=!1,this.Ui=!1,t(function(t){e.Bi=!0,e.result=t,e.Oi&&e.Oi(t)},function(t){e.Bi=!0,e.error=t,e.xi&&e.xi(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Ui&&_e("Called next() or catch() twice for PersistencePromise"),this.Ui=!0,this.Bi?this.error?this.qi(n,this.error):this.Qi(e,this.result):new t(function(t,i){r.Oi=function(n){r.Qi(e,n).next(t,i)},r.xi=function(e){r.qi(n,e).next(t,i)}})},t.prototype.Wi=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.ji=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Qi=function(e,n){return e?this.ji(function(){return e(n)}):t.resolve(n)},t.prototype.qi=function(e,n){return e?this.ji(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.Ki=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Gi=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.Ki(r)},t}(),Oe=function(){function t(){this.zi=new ke(function(t){return t.toString()}),this.Hi=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Ji},set:function(t){this.Ji=t},enumerable:!0,configurable:!0}),t.prototype.Yi=function(t,e){this.Xi(),this.readTime=e,this.zi.set(t.key,t)},t.prototype.Zi=function(t,e){this.Xi(),e&&(this.readTime=e),this.zi.set(t,null)},t.prototype.tr=function(t,e){this.Xi();var n=this.zi.get(e);return void 0!==n?Ue.resolve(n):this.er(t,e)},t.prototype.getEntries=function(t,e){return this.sr(t,e)},t.prototype.apply=function(t){return this.Xi(),this.Hi=!0,this.nr(t)},t.prototype.Xi=function(){},t}(),Pe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ce=function(){function t(){this.ir=[]}return t.prototype.rr=function(t){this.ir.push(t)},t.prototype.or=function(){this.ir.forEach(function(t){return t()})},t}(),Me=function(){function t(t,e,n){this.hr=t,this.ar=e,this.ur=n}return t.prototype.cr=function(t,e){var n=this;return this.ar._r(t,e).next(function(r){return n.lr(t,e,r)})},t.prototype.lr=function(t,e,n){return this.hr.tr(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Bt(e,t);return t})},t.prototype.dr=function(t,e,n){var r=Bt();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Bt(t,e);r=r.it(t,e)}),r},t.prototype.Tr=function(t,e){var n=this;return this.hr.getEntries(t,e).next(function(e){return n.mr(t,e)})},t.prototype.mr=function(t,e){var n=this;return this.ar.Er(t,e).next(function(r){var i=n.dr(t,e,r),o=Gt();return i.forEach(function(t,e){e||(e=new wt(t,g.S())),o=o.it(t,e)}),o})},t.prototype.wr=function(t,e,n){return e.Pe()?this.Ir(t,e.path):e.He()?this.Rr(t,e,n):this.Ar(t,e,n)},t.prototype.Ir=function(t,e){return this.cr(t,new I(e)).next(function(t){var e=Kt();return t instanceof gt&&(e=e.it(t.key,t)),e})},t.prototype.Rr=function(t,e,n){var r=this,i=e.collectionGroup,o=Kt();return this.ur.Pr(t,i).next(function(s){return Ue.forEach(s,function(s){var u=e.Le(s.child(i));return r.Ar(t,u,n).next(function(t){t.forEach(function(t,e){o=o.it(t,e)})})}).next(function(){return o})})},t.prototype.Ar=function(t,e,n){var r,i,o=this;return this.hr.wr(t,e,n).next(function(n){return r=n,o.ar.Vr(t,e)}).next(function(e){return i=e,o.gr(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],h=a.key,c=r.get(h),f=a.Bt(c,c,o.Ri);r=f instanceof gt?r.it(h,f):r.remove(h)}})}).next(function(){return r.forEach(function(t,n){e.matches(n)||(r=r.remove(t))}),r})},t.prototype.gr=function(t,e,n){for(var r=Jt(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ft&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.hr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof gt&&(h=h.it(t,e))}),h})},t}(),qe=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.pr=n,this.yr=r}return t.br=function(e,n){for(var r=Jt(),i=Jt(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Fe=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.vr=function(t){return n.Sr(t)},this.Dr=function(t){return e.Cr(t)})}return t.prototype.Sr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.Dr&&this.Dr(t),t},t}();Fe.kr=-1;var je=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Ge=function(){function t(t,e,n,r,i){this.Nr=t,this.Fr=e,this.$r=n,this.op=r,this.Mr=i,this.Lr=new je,this.then=this.Lr.promise.then.bind(this.Lr.promise),this.catch=this.Lr.promise.catch.bind(this.Lr.promise),this.Lr.promise.catch(function(t){})}return t.Or=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.xr=setTimeout(function(){return e.Br()},t)},t.prototype.Ur=function(){return this.Br()},t.prototype.cancel=function(t){null!==this.xr&&(this.clearTimeout(),this.Lr.reject(new f(c.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Br=function(){var t=this;this.Nr.qr(function(){return null!==t.xr?(t.clearTimeout(),t.op().then(function(e){return t.Lr.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.xr&&(this.Mr(this),clearTimeout(this.xr),this.xr=null)},t}(),Be=function(){function t(){this.Qr=Promise.resolve(),this.Wr=!1,this.jr=[],this.Kr=null,this.Gr=!1,this.zr=[]}return Object.defineProperty(t.prototype,"Hr",{get:function(){return this.Wr},enumerable:!0,configurable:!0}),t.prototype.qr=function(t){this.enqueue(t)},t.prototype.Jr=function(t){this.Yr(),this.Xr(t)},t.prototype.Zr=function(t){return this.Yr(),this.Xr(t)},t.prototype.to=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return this.Yr(),this.Wr?[3,2]:(this.Wr=!0,[4,this.Zr(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.enqueue=function(t){return this.Yr(),this.Wr?new Promise(function(t){}):this.Xr(t)},t.prototype.Xr=function(t){var e=this,n=this.Qr.then(function(){return e.Gr=!0,t().catch(function(t){throw e.Kr=t,e.Gr=!1,we("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Gr=!1,t})});return this.Qr=n,n},t.prototype.eo=function(t,e,n){var r=this;this.Yr(),this.zr.indexOf(t)>-1&&(e=0);var i=Ge.Or(this,t,e,n,function(t){return r.so(t)});return this.jr.push(i),i},t.prototype.Yr=function(){this.Kr&&_e("AsyncQueue is already failed: "+(this.Kr.stack||this.Kr.message))},t.prototype.no=function(){},t.prototype.io=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,t=this.Qr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Qr)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.ro=function(t){for(var e=0,n=this.jr;e<n.length;e++)if(n[e].Fr===t)return!0;return!1},t.prototype.oo=function(t){var e=this;return this.io().then(function(){e.jr.sort(function(t,e){return t.$r-e.$r});for(var n=0,r=e.jr;n<r.length;n++){var i=r[n];if(i.Ur(),"all"!==t&&i.Fr===t)break}return e.io()})},t.prototype.ho=function(t){this.zr.push(t)},t.prototype.so=function(t){var e=this.jr.indexOf(t);this.jr.splice(e,1)},t}();function ze(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ee(n,i);return 0===s?Ee(r,o):s}var Ke=function(){function t(t){this.ao=t,this.buffer=new S(ze),this.uo=0}return t.prototype.co=function(){return++this.uo},t.prototype._o=function(t){var e=[t,this.co()];if(this.buffer.size<this.ao)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ze(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),We={lo:!1,do:0,fo:0,To:0},Ye=function(){function t(t,e,n){this.mo=t,this.Eo=e,this.wo=n}return t.Io=function(e){return new t(e,t.Ro,t.Ao)},t}();Ye.Po=-1,Ye.Vo=1048576,Ye.po=41943040,Ye.Ro=10,Ye.Ao=1e3,Ye.yo=new Ye(Ye.po,Ye.Ro,Ye.Ao),Ye.DISABLED=new Ye(Ye.Po,0,0);var Qe=function(){function t(t,e){this.bo=t,this.Nr=e,this.vo=!1,this.So=null}return t.prototype.start=function(t){this.bo.Do.mo!==Ye.Po&&this.Co(t)},t.prototype.stop=function(){this.So&&(this.So.cancel(),this.So=null)},Object.defineProperty(t.prototype,"ko",{get:function(){return null!==this.So},enumerable:!0,configurable:!0}),t.prototype.Co=function(t){var e=this,n=this.vo?3e5:6e4;ge("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.So=this.Nr.eo("lru_garbage_collection",n,function(){return e.So=null,e.vo=!0,t.No(e.bo).then(function(){return e.Co(t)}).catch(Xe)})},t}(),Je=function(){function t(t,e){this.Fo=t,this.Do=e}return t.prototype.$o=function(t,e){return this.Fo.Mo(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Lo=function(t,e){var n=this;if(0===e)return Ue.resolve(Fe.kr);var r=new Ke(e);return this.Fo.Xs(t,function(t){return r._o(t.sequenceNumber)}).next(function(){return n.Fo.Oo(t,function(t){return r._o(t)})}).next(function(){return r.maxValue})},t.prototype.xo=function(t,e,n){return this.Fo.xo(t,e,n)},t.prototype.Bo=function(t,e){return this.Fo.Bo(t,e)},t.prototype.Uo=function(t,e){var n=this;return this.Do.mo===Ye.Po?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),Ue.resolve(We)):this.qo(t).next(function(r){return r<n.Do.mo?(ge("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.Do.mo),We):n.Qo(t,e)})},t.prototype.qo=function(t){return this.Fo.qo(t)},t.prototype.Qo=function(t,e){var n,r,o,s,u,a,h,c=this,f=Date.now();return this.$o(t,this.Do.Eo).next(function(e){return e>c.Do.wo?(ge("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.Do.wo+" from "+e),r=c.Do.wo):r=e,s=Date.now(),c.Lo(t,r)}).next(function(r){return n=r,u=Date.now(),c.xo(t,n,e)}).next(function(e){return o=e,a=Date.now(),c.Bo(t,n)}).next(function(t){return h=Date.now(),me()<=i.LogLevel.DEBUG&&ge("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+r+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Ue.resolve({lo:!0,do:r,fo:o,To:t})})},t}(),He=function(){function t(t,e,n){this.persistence=t,this.Wo=e,this.jo=new Ve,this.Ko=new E(Ee),this.Go=new ke(function(t){return t.canonicalId()}),this.zo=g.MIN,this.persistence.Jo.Ho(this.jo),this.ar=t.Yo(n),this.Xo=t.Zo(),this.th=t.eh(),this.sh=new Me(this.Xo,this.ar,this.persistence.nh()),this.Wo.ih(this.sh)}return t.prototype.start=function(){return this.rh()},t.prototype.oh=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i,o=this;return n.__generator(this,function(n){switch(n.label){case 0:return e=this.ar,r=this.sh,[4,this.persistence.runTransaction("Handle user change","readonly",function(n){var i;return o.ar.hh(n).next(function(s){return i=s,e=o.persistence.Yo(t),r=new Me(o.Xo,e,o.persistence.nh()),e.hh(n)}).next(function(t){for(var e=[],o=[],s=Jt(),u=0,a=i;u<a.length;u++){var h=a[u];e.push(h.batchId);for(var c=0,f=h.mutations;c<f.length;c++){var l=f[c];s=s.add(l.key)}}for(var p=0,d=t;p<d.length;p++){var y=d[p];o.push(y.batchId);for(var m=0,v=y.mutations;m<v.length;m++){var g=v[m];s=s.add(g.key)}}return r.Tr(n,s).next(function(t){return{ah:t,uh:e,_h:o}})})})];case 1:return i=n.sent(),[2,(this.ar=e,this.sh=r,this.Wo.ih(this.sh),i)]}})})},t.prototype.lh=function(t){var e,n=this,r=v.now(),i=t.reduce(function(t,e){return t.add(e.key)},Jt());return this.persistence.runTransaction("Locally write mutations","readwrite",function(o){return n.sh.Tr(o,i).next(function(i){e=i;for(var s=[],u=0,a=t;u<a.length;u++){var h=a[u],c=h.ee(e.get(h.key));null!=c&&s.push(new ft(h.key,c,c.se(),at.exists(!0)))}return n.ar.dh(o,r,s,t)})}).then(function(t){var n=t.Pi(e);return{batchId:t.batchId,zi:n}})},t.prototype.fh=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.ar.Th(n,t).next(function(t){return t?e.sh.Tr(n,t):Ue.resolve(null)})})},t.prototype.mh=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.Xo.Eh({wh:!0});return e.ar.mh(n,t.batch,t.streamToken).next(function(){return e.Ih(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.ar.Rh(n)}).next(function(){return e.sh.Tr(n,r)})})},t.prototype.Ah=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.ar.Ph(n,t).next(function(t){return Te(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.ar.Vh(n,t)}).next(function(){return e.ar.Rh(n)}).next(function(){return e.sh.Tr(n,r)})})},t.prototype.gh=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t.ar.gh(e)})},t.prototype.ph=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.ar.ph(e)})},t.prototype.yh=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.ar.yh(n,t)})},t.prototype.bh=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.th.bh(e)})},t.prototype.vh=function(e){var n=this,r=e.ts,i=this.Ko;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var s=n.Xo.Eh({wh:!0});i=n.Ko;var u=[];e.Ts.forEach(function(e,s){var a=i.get(s);if(a){u.push(n.th.Sh(o,e.gs,s).next(function(){return n.th.Dh(o,e.Ps,s)}));var h=e.resumeToken;if(h.Ot()>0){var c=a.ss(h,r).es(o.Ch);i=i.it(s,c),t.kh(a,c,e)&&u.push(n.th.Nh(o,c))}}});var a=Gt(),h=Jt();if(e.Es.forEach(function(t,e){h=h.add(t)}),u.push(s.getEntries(o,h).next(function(t){e.Es.forEach(function(i,h){var c=t.get(i);h instanceof wt&&h.version.isEqual(g.MIN)?(s.Zi(i,r),a=a.it(i,h)):null==c||h.version.D(c.version)>0||0===h.version.D(c.version)&&c.hasPendingWrites?(s.Yi(h,r),a=a.it(i,h)):ge("LocalStore","Ignoring outdated watch update for ",i,". Current version:",c.version," Watch version:",h.version),e.ws.has(i)&&u.push(n.persistence.Jo.Fh(o,i))})})),!r.isEqual(g.MIN)){var c=n.th.bh(o).next(function(t){return n.th.$h(o,o.Ch,r)});u.push(c)}return Ue.Ki(u).next(function(){return s.apply(o)}).next(function(){return n.sh.mr(o,a)})}).then(function(t){return n.Ko=i,t})},t.kh=function(t,e,n){return Te(e.resumeToken.Ot()>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.Ot()||e.ts.C()-t.ts.C()>=this.Mh||n.Ps.size+n.Vs.size+n.gs.size>0},t.prototype.Lh=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.jo.Si(i.pr,o),this.jo.ki(i.yr,o),!i.fromCache){var s=this.Ko.get(o),u=s.ts,a=s.ns(u);this.Ko=this.Ko.it(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ue.forEach(t,function(t){return Ue.forEach(t.yr,function(t){return e.persistence.Jo.Di(n,t)})})})},t.prototype.Oh=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.ar.xh(n,t)})},t.prototype.Bh=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.sh.cr(n,t)})},t.prototype.Uh=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",function(n){var r;return e.th.qh(n,t).next(function(i){return i?(r=i,Ue.resolve(r)):e.th.Qh(n).next(function(i){return r=new Ct(t,i,0,n.Ch),e.th.Wh(n,r).next(function(){return r})})})}).then(function(n){return null===e.Ko.get(n.targetId)&&(e.Ko=e.Ko.it(n.targetId,n),e.Go.set(t,n.targetId)),n})},t.prototype.qh=function(t,e){var n=this.Go.get(e);return void 0!==n?Ue.resolve(this.Ko.get(n)):this.th.qh(t,e)},t.prototype.jh=function(t,e){var n=this,r=this.Ko.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(i){var o=n.jo.Ni(t);return e?Ue.resolve():Ue.forEach(o,function(t){return n.persistence.Jo.Di(i,t)}).next(function(){n.persistence.Jo.removeTarget(i,r)})}).then(function(){n.Ko=n.Ko.remove(t),n.Go.delete(r.target)})},t.prototype.Kh=function(t,e){var n=this,r=g.MIN,i=Jt();return this.persistence.runTransaction("Execute query","readonly",function(o){return n.qh(o,t.xe()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.th.Gh(o,t.targetId).next(function(t){i=t})}).next(function(){return n.Wo.wr(o,t,e?r:g.MIN,e?i:Jt())}).next(function(t){return{documents:t,zh:i}})})},t.prototype.Hh=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.th.Gh(n,t)})},t.prototype.Jh=function(){return this.persistence.Jh()},t.prototype.Yh=function(t){this.ar.Xh(t)},t.prototype.Zh=function(t){this.persistence.Zh(t)},t.prototype.Ih=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=Ue.resolve();return o.forEach(function(r){s=s.next(function(){return n.tr(t,r)}).next(function(t){var o=t,s=e.gi.get(r);Te(null!==s,"ackVersions should contain every doc in the write."),(!o||o.version.D(s)<0)&&(o=i.Ut(r,o,e))&&n.Yi(o,e.Vi)})}),s.next(function(){return r.ar.Vh(t,i)})},t.prototype.No=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Uo(n,e.Ko)})},t.prototype.ta=function(t){var e=this,n=this.Ko.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly",function(n){return e.th.un(n,t).next(function(t){return t?t.target:null})})},t.prototype.ea=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.Xo.ea(e,t.zo)}).then(function(e){var n=e.sa,r=e.readTime;return t.zo=r,n})},t.prototype.rh=function(){return n.__awaiter(this,void 0,void 0,function(){var t,e=this;return n.__generator(this,function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return e.Xo.na(t)})];case 1:return t.zo=n.sent(),[2]}})})},t}();function Xe(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){if(t.code!==c.FAILED_PRECONDITION||t.message!==Pe)throw t;return ge("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ze(t,e){if(0!==e.length)throw new f(c.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+mn(e.length,"argument")+".")}function $e(t,e,n){if(e.length!==n)throw new f(c.INVALID_ARGUMENT,"Function "+t+"() requires "+mn(n,"argument")+", but was called with "+mn(e.length,"argument")+".")}function tn(t,e,n){if(e.length<n)throw new f(c.INVALID_ARGUMENT,"Function "+t+"() requires at least "+mn(n,"argument")+", but was called with "+mn(e.length,"argument")+".")}function en(t,e,n,r){if(e.length<n||e.length>r)throw new f(c.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+mn(e.length,"argument")+".")}function nn(t,e,n,r){an(t,e,yn(n)+" argument",r)}function rn(t,e,n,r){void 0!==r&&nn(t,e,n,r)}function on(t,e,n,r){an(t,e,n+" option",r)}function sn(t,e,n,r){void 0!==r&&on(t,e,n,r)}function un(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(cn(a))}var h=cn(r);throw new f(c.INVALID_ARGUMENT,"Invalid value "+h+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function an(e,n,r,i){if(!("object"===n?hn(i):"non-empty string"===n?"string"==typeof i&&""!==i:t(i)===n)){var o=cn(i);throw new f(c.INVALID_ARGUMENT,"Function "+e+"() requires its "+r+" to be of type "+n+", but it was: "+o)}}function hn(e){return"object"==t(e)&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function cn(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==t(e)){if(e instanceof Array)return"an array";var n=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(e);return n?"a custom "+n+" object":"an object"}return"function"==typeof e?"a function":_e("Unknown wrong type: "+t(e))}function fn(t,e,n){if(void 0===n)throw new f(c.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+yn(e)+" argument, but it was undefined.")}function ln(t,e,n){x(e,function(e,r){if(n.indexOf(e)<0)throw new f(c.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function pn(t,e,n,r){var i=cn(r);return new f(c.INVALID_ARGUMENT,"Function "+t+"() requires its "+yn(n)+" argument to be a "+e+", but it was: "+i)}function dn(t,e,n){if(n<=0)throw new f(c.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+yn(e)+" argument to be a positive number, but it was: "+n+".")}function yn(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function mn(t,e){return t+" "+e+(1===t?"":"s")}function vn(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new f(c.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function gn(){if("undefined"==typeof Uint8Array)throw new f(c.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wn(){if(!de.Lt().ia)throw new f(c.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}He.Mh=3e8;var bn=function(){function t(t){wn(),this.ra=t}return t.fromBase64String=function(e){$e("Blob.fromBase64String",arguments,1),nn("Blob.fromBase64String","string",1,e),wn();try{return new t(V.fromBase64String(e))}catch(e){throw new f(c.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if($e("Blob.fromUint8Array",arguments,1),gn(),!(e instanceof Uint8Array))throw pn("Blob.fromUint8Array","Uint8Array",1,e);return new t(V.fromUint8Array(e))},t.prototype.toBase64=function(){return $e("Blob.toBase64",arguments,0),wn(),this.ra.toBase64()},t.prototype.toUint8Array=function(){return $e("Blob.toUint8Array",arguments,0),gn(),this.ra.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.ra.isEqual(t.ra)},t}(),_n=vn(bn,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Tn=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new f(c.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+mn(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(nn("FieldPath","string",n,t[n]),0===t[n].length)throw new f(c.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.oa=new T(t)}return t.documentId=function(){return t.ha},t.prototype.isEqual=function(e){if(!(e instanceof t))throw pn("isEqual","FieldPath",1,e);return this.oa.isEqual(e.oa)},t}();Tn.ha=new Tn(T.X().K());var In=new RegExp("[~\\*/\\[\\]]"),En=function(){function t(t){this.aa=t}return t.delete=function(){return Ze("FieldValue.delete",arguments),Nn.instance},t.serverTimestamp=function(){return Ze("FieldValue.serverTimestamp",arguments),An.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tn("FieldValue.arrayUnion",arguments,1),new Sn(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tn("FieldValue.arrayRemove",arguments,1),new Dn(t)},t.increment=function(t){return nn("FieldValue.increment","number",1,t),$e("FieldValue.increment",arguments,1),new kn(t)},t.prototype.isEqual=function(t){return this===t},t}(),Nn=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return n.__extends(e,t),e}(En);Nn.instance=new Nn;var An=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return n.__extends(e,t),e}(En);An.instance=new An;var Sn=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.arrayUnion")||this).ua=e,n}return n.__extends(e,t),e}(En),Dn=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.arrayRemove")||this).ua=e,n}return n.__extends(e,t),e}(En),kn=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.increment")||this).ca=e,n}return n.__extends(e,t),e}(En),xn=vn(En,"Use FieldValue.<field>() instead."),Rn=function(){function t(t,e){if($e("GeoPoint",arguments,2),nn("GeoPoint","number",1,t),nn("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new f(c.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new f(c.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._a=t,this.la=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._a},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.la},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._a===t._a&&this.la===t.la},t.prototype.p=function(t){return Ee(this._a,t._a)||Ee(this.la,t.la)},t}(),Vn=/^__.*__$/,Ln=function(){function t(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}return t.prototype.da=function(t,e){var n=[];return null!==this.se?n.push(new ft(t,this.data,this.se,e)):n.push(new ct(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new lt(t,this.fieldTransforms)),n},t}(),Un=function(){function t(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}return t.prototype.da=function(t,e){var n=[new ft(t,this.data,this.se,e)];return this.fieldTransforms.length>0&&n.push(new lt(t,this.fieldTransforms)),n},t}();function On(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e("Unexpected case for UserDataSource: "+t)}}var Pn=function(){function t(t,e,n,r,i,o){this.fa=t,this.methodName=e,this.path=n,this.Ta=r,void 0===i&&this.ma(),this.Ta=void 0!==r&&r,this.fieldTransforms=i||[],this.se=o||[]}return t.prototype.Ea=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.fa,this.methodName,n,!1,this.fieldTransforms,this.se);return r.wa(e),r},t.prototype.Ia=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.fa,this.methodName,n,!1,this.fieldTransforms,this.se);return r.ma(),r},t.prototype.Ra=function(e){return new t(this.fa,this.methodName,null,!0,this.fieldTransforms,this.se)},t.prototype.Aa=function(t){var e=null===this.path||this.path.U()?"":" (found in field "+this.path.toString()+")";return new f(c.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.se.find(function(e){return t.q(e)})||void 0!==this.fieldTransforms.find(function(e){return t.q(e.field)})},t.prototype.ma=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.wa(this.path.get(t))},t.prototype.wa=function(t){if(0===t.length)throw this.Aa("Document fields must not be empty");if(On(this.fa)&&Vn.test(t))throw this.Aa('Document fields cannot begin and end with "__"')},t}(),Cn=function(t,e){this.cn=t,this.key=e},Mn=function(){function t(t,e){this.serializer=t,this.Pa=e}return t.prototype.Va=function(t,e){var n=new Pn(0,t,T.H);Fn("Data must be an object, but it was:",n,e);var r=this.ga(e,n);return new Ln(new yt(r),null,n.fieldTransforms)},t.prototype.pa=function(t,e,n){var r=new Pn(2,t,T.H);Fn("Data must be an object, but it was:",r,e);var i,o,s=this.ga(e,r);if(n){for(var u=new S(T.F),a=0,h=n;a<h.length;a++){var l=h[a],p=void 0;if(l instanceof Tn)p=l.oa;else{if("string"!=typeof l)throw _e("Expected stringOrFieldPath to be a string or a FieldPath");p=Gn(t,l)}if(!r.contains(p))throw new f(c.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");u=u.add(p)}i=ot.Kt(u),o=r.fieldTransforms.filter(function(t){return i.zt(t.field)})}else i=ot.Gt(r.se),o=r.fieldTransforms;return new Ln(new yt(s),i,o)},t.prototype.ya=function(t,e){var n=this,r=new Pn(1,t,T.H);Fn("Data must be an object, but it was:",r,e);var i=new S(T.F),o=yt._e();x(e,function(e,s){var u=Gn(t,e),a=r.Ia(u);if((s=n.ba(s,a))instanceof Nn)i=i.add(u);else{var h=n.va(s,a);null!=h&&(i=i.add(u),o.set(u,h))}});var s=ot.Kt(i);return new Un(o.oe(),s,r.fieldTransforms)},t.prototype.Sa=function(t,e,n,r){var i=new Pn(1,t,T.H),o=[jn(t,e)],s=[n];if(r.length%2!=0)throw new f(c.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(jn(t,r[u])),s.push(r[u+1]);for(var a=new S(T.F),h=yt._e(),l=0;l<o.length;++l){var p=o[l],d=i.Ia(p),y=this.ba(s[l],d);if(y instanceof Nn)a=a.add(p);else{var m=this.va(y,d);null!=m&&(a=a.add(p),h.set(p,m))}}var v=ot.Kt(a);return new Un(h.oe(),v,i.fieldTransforms)},t.prototype.Da=function(t,e,n){void 0===n&&(n=!1);var r=new Pn(n?4:3,t,T.H);return this.va(e,r)},t.prototype.ba=function(t,e){try{return this.Pa(t)}catch(t){var n=Bn(t);throw e.Aa(n)}},t.prototype.va=function(t,e){if(qn(t=this.ba(t,e)))return Fn("Unsupported field value:",e,t),this.ga(t,e);if(t instanceof En)return this.Ca(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.Ta&&4!==e.fa)throw e.Aa("Nested arrays are not supported");return this.ka(t,e)}return this.Na(t,e)},t.prototype.ga=function(t,e){var n=this,r={};return R(t)?e.path&&e.path.length>0&&e.se.push(e.path):x(t,function(t,i){var o=n.va(i,e.Ea(t));null!=o&&(r[t]=o)}),{mapValue:{fields:r}}},t.prototype.ka=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],u=this.va(s,e.Ra(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}},t.prototype.Ca=function(t,e){if(!On(e.fa))throw e.Aa(t.aa+"() can only be used with update() and set()");if(null===e.path)throw e.Aa(t.aa+"() is not currently supported inside arrays");if(t instanceof Nn){if(2!==e.fa)throw 1===e.fa?e.Aa("FieldValue.delete() can only appear at the top level of your update data"):e.Aa("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof An)e.fieldTransforms.push(new st(e.path,tt.instance));else if(t instanceof Sn){var n=this.Fa(t.aa,t.ua),r=new et(n);e.fieldTransforms.push(new st(e.path,r))}else if(t instanceof Dn){var i=this.Fa(t.aa,t.ua),o=new nt(i);e.fieldTransforms.push(new st(e.path,o))}else if(t instanceof kn){var s=this.Da("FieldValue.increment",t.ca),u=new rt(this.serializer,s);e.fieldTransforms.push(new st(e.path,u))}else _e("Unknown FieldValue type: "+t)},t.prototype.Na=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.Tn(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=v.fromDate(t);return{timestampValue:this.serializer.k(n)}}if(t instanceof v){var r=new v(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.k(r)}}if(t instanceof Rn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bn)return{bytesValue:this.serializer.mn(t)};if(t instanceof Cn)return{referenceValue:this.serializer.wn(t.key.path,t.cn)};throw e.Aa("Unsupported field value: "+cn(t))},t.prototype.Fa=function(t,e){var n=this;return e.map(function(e,r){var i=new Pn(3,t,T.H);return n.va(e,i.Ra(r))})},t}();function qn(e){return!("object"!=t(e)||null===e||e instanceof Array||e instanceof Date||e instanceof v||e instanceof Rn||e instanceof bn||e instanceof Cn||e instanceof En)}function Fn(t,e,n){if(!qn(n)||!hn(n)){var r=cn(n);throw"an object"===r?e.Aa(t+" a custom object"):e.Aa(t+" "+r)}}function jn(t,e){if(e instanceof Tn)return e.oa;if("string"==typeof e)return Gn(t,e);throw new f(c.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Gn(t,e){try{return function(t){if(t.search(In)>=0)throw new f(c.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Tn.bind.apply(Tn,n.__spreadArrays([void 0],t.split("."))))}catch(n){throw new f(c.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).oa}catch(e){var r=Bn(e);throw new f(c.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+r)}}function Bn(t){return t instanceof Error?t.message:t.toString()}var zn=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.$a=t,this.Fr=e,this.Ma=n,this.La=r,this.Oa=i,this.xa=0,this.Ba=null,this.Ua=Date.now(),this.reset()}return t.prototype.reset=function(){this.xa=0},t.prototype.qa=function(){this.xa=this.Oa},t.prototype.Qa=function(t){var e=this;this.cancel();var n=Math.floor(this.xa+this.Wa()),r=Math.max(0,Date.now()-this.Ua),i=Math.max(0,n-r);this.xa>0&&ge("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.xa+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ba=this.$a.eo(this.Fr,i,function(){return e.Ua=Date.now(),t()}),this.xa*=this.La,this.xa<this.Ma&&(this.xa=this.Ma),this.xa>this.Oa&&(this.xa=this.Oa)},t.prototype.cancel=function(){null!==this.Ba&&(this.Ba.cancel(),this.Ba=null)},t.prototype.Wa=function(){return(Math.random()-.5)*this.xa},t}(),Kn=function(){function t(t,e,n,r,i,o){this.$a=t,this.ja=n,this.Ka=r,this.Ga=i,this.listener=o,this.state=0,this.za=0,this.Ha=null,this.stream=null,this.Ja=new zn(t,e)}return t.prototype.Ya=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Xa=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Za()},t.prototype.stop=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.Ya()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.tu=function(){this.state=0,this.Ja.reset()},t.prototype.eu=function(){var t=this;this.Xa()&&null===this.Ha&&(this.Ha=this.$a.eo(this.ja,6e4,function(){return t.su()}))},t.prototype.nu=function(t){this.iu(),this.stream.send(t)},t.prototype.su=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return this.Xa()?[2,this.close(0)]:[2]})})},t.prototype.iu=function(){this.Ha&&(this.Ha.cancel(),this.Ha=null)},t.prototype.close=function(t,e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return this.iu(),this.Ja.cancel(),this.za++,3!==t?this.Ja.reset():e&&e.code===c.RESOURCE_EXHAUSTED?(we(e.toString()),we("Using maximum backoff delay to prevent overloading the backend."),this.Ja.qa()):e&&e.code===c.UNAUTHENTICATED&&this.Ga._(),null!==this.stream&&(this.ru(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.ou(e)];case 1:return n.sent(),[2]}})})},t.prototype.ru=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hu(this.za),n=this.za;this.Ga.getToken().then(function(e){t.za===n&&t.au(e)},function(n){e(function(){var e=new f(c.UNKNOWN,"Fetching auth token failed: "+n.message);return t.uu(e)})})},t.prototype.au=function(t){var e=this,n=this.hu(this.za);this.stream=this.cu(t),this.stream._u(function(){n(function(){return e.state=2,e.listener._u()})}),this.stream.ou(function(t){n(function(){return e.uu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Za=function(){var t=this;this.state=4,this.Ja.Qa(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.uu=function(t){return ge("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hu=function(t){var e=this;return function(n){e.$a.qr(function(){return e.za===t?n():(ge("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Wn=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return n.__extends(e,t),e.prototype.cu=function(t){return this.Ka.lu("Listen",t)},e.prototype.onMessage=function(t){this.Ja.reset();var e=this.serializer.kn(t),n=this.serializer.Fn(t);return this.listener.du(e,n)},e.prototype.fu=function(t){var e={};e.database=this.serializer.pn,e.addTarget=this.serializer.xe(t);var n=this.serializer.ei(t);n&&(e.labels=n),this.nu(e)},e.prototype.Tu=function(t){var e={};e.database=this.serializer.pn,e.removeTarget=t,this.nu(e)},e}(Kn),Yn=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.mu=!1,s.lastStreamToken=V.xt,s}return n.__extends(e,t),Object.defineProperty(e.prototype,"Eu",{get:function(){return this.mu},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.mu=!1,t.prototype.start.call(this)},e.prototype.ru=function(){this.mu&&this.wu([])},e.prototype.cu=function(t){return this.Ka.lu("Write",t)},e.prototype.onMessage=function(t){if(Te(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.En(t.streamToken),this.mu){this.Ja.reset();var e=this.serializer.Wn(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Iu(n,e)}return Te(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.mu=!0,this.listener.Ru()},e.prototype.Au=function(){var t={};t.database=this.serializer.pn,this.nu(t)},e.prototype.wu=function(t){var e=this,n={streamToken:this.serializer.mn(this.lastStreamToken),writes:t.map(function(t){return e.serializer.$n(t)})};this.nu(n)},e}(Kn),Qn=function(){function t(t,e,n,r){this.$a=t,this.Ka=e,this.credentials=n,this.serializer=r}return t.prototype.Pu=function(t){return new Yn(this.$a,this.Ka,this.credentials,this.serializer,t)},t.prototype.Vu=function(t){return new Wn(this.$a,this.Ka,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.pn,writes:t.map(function(t){return e.serializer.$n(t)})};return this.gu("Commit",n).then(function(t){return e.serializer.Wn(t.writeResults,t.commitTime)})},t.prototype.pu=function(t){var e=this,n={database:this.serializer.pn,documents:t.map(function(t){return e.serializer.An(t)})};return this.yu("BatchGetDocuments",n).then(function(n){var r=Gt();n.forEach(function(t){var n=e.serializer.Cn(t);r=r.it(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);Te(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.gu=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.Ka.gu(t,e,r)}).catch(function(t){throw t.code===c.UNAUTHENTICATED&&n.credentials._(),t})},t.prototype.yu=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.Ka.yu(t,e,r)}).catch(function(t){throw t.code===c.UNAUTHENTICATED&&n.credentials._(),t})},t}(),Jn=function(){function t(t){this.bu=t,this.vu=Yt(),this.mutations=[],this.Su=!1,this.Du=null,this.Cu=new Set}return t.prototype.pu=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r=this;return n.__generator(this,function(n){switch(n.label){case 0:if(this.ku(),this.mutations.length>0)throw new f(c.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.bu.pu(t)];case 1:return[2,((e=n.sent()).forEach(function(t){t instanceof wt||t instanceof gt?r.Nu(t):_e("Document in a transaction was a "+t.constructor.name)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.da(t,this.Zt(t))),this.Cu.add(t)},t.prototype.update=function(t,e){try{this.write(e.da(t,this.Fu(t)))}catch(t){this.Du=t}this.Cu.add(t)},t.prototype.delete=function(t){this.write([new pt(t,this.Zt(t))]),this.Cu.add(t)},t.prototype.commit=function(){return n.__awaiter(this,void 0,void 0,function(){var t,e=this;return n.__generator(this,function(n){switch(n.label){case 0:if(this.ku(),this.Du)throw this.Du;return t=this.vu,this.mutations.forEach(function(e){t=t.remove(e.key)}),t.forEach(function(t,n){e.mutations.push(new dt(t,e.Zt(t)))}),[4,this.bu.commit(this.mutations)];case 1:return n.sent(),this.Su=!0,[2]}})})},t.prototype.Nu=function(t){var e;if(t instanceof gt)e=t.version;else{if(!(t instanceof wt))throw _e("Document in a transaction was a "+t.constructor.name);e=g.S()}var n=this.vu.get(t.key);if(null!==n){if(!e.isEqual(n))throw new f(c.ABORTED,"Document version changed between two reads.")}else this.vu=this.vu.it(t.key,e)},t.prototype.Zt=function(t){var e=this.vu.get(t);return!this.Cu.has(t)&&e?at.updateTime(e):at.NONE},t.prototype.Fu=function(t){var e=this.vu.get(t);if(!this.Cu.has(t)&&e){if(e.isEqual(g.S()))throw new f(c.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return at.updateTime(e)}return at.exists(!0)},t.prototype.write=function(t){this.ku(),this.mutations=this.mutations.concat(t)},t.prototype.ku=function(){},t}(),Hn=function(){function t(t,e){this.Nr=t,this.$u=e,this.state="Unknown",this.Mu=0,this.Lu=null,this.Ou=!0}return t.prototype.xu=function(){var t=this;0===this.Mu&&(this.Bu("Unknown"),this.Lu=this.Nr.eo("online_state_timeout",1e4,function(){return t.Lu=null,t.Uu("Backend didn't respond within 10 seconds."),t.Bu("Offline"),Promise.resolve()}))},t.prototype.qu=function(t){"Online"===this.state?this.Bu("Unknown"):(this.Mu++,this.Mu>=1&&(this.Qu(),this.Uu("Connection failed 1 times. Most recent error: "+t.toString()),this.Bu("Offline")))},t.prototype.set=function(t){this.Qu(),this.Mu=0,"Online"===t&&(this.Ou=!1),this.Bu(t)},t.prototype.Bu=function(t){t!==this.state&&(this.state=t,this.$u(t))},t.prototype.Uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ou?(we(e),this.Ou=!1):ge("OnlineStateTracker",e)},t.prototype.Qu=function(){null!==this.Lu&&(this.Lu.cancel(),this.Lu=null)},t}(),Xn=function(){function t(t,e,r,i,o){var s=this;this.Wu=t,this.bu=e,this.ju=[],this.Ku=new Map,this.Gu=null,this.networkEnabled=!1,this.isPrimary=!1,this.zu=o,this.zu.Hu(function(t){r.qr(function(){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.Ju()?(ge("RemoteStore","Restarting streams for network reachability change."),[4,this.Yu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xu=new Hn(r,i),this.Zu=this.bu.Vu({_u:this.tc.bind(this),ou:this.ec.bind(this),du:this.sc.bind(this)}),this.nc=this.bu.Pu({_u:this.ic.bind(this),ou:this.rc.bind(this),Ru:this.oc.bind(this),Iu:this.Iu.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.Ju()?(t=this.nc,[4,this.Wu.ph()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.hc()?this.ac():this.Xu.set("Unknown"),[4,this.uc()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.cc()];case 1:return t.sent(),this.Xu.set("Offline"),[2]}})})},t.prototype.cc=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,this.nc.stop()];case 1:return t.sent(),[4,this.Zu.stop()];case 2:return t.sent(),this.ju.length>0&&(ge("RemoteStore","Stopping write stream with "+this.ju.length+" pending writes"),this.ju=[]),this._c(),[2]}})})},t.prototype.lc=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return ge("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.cc()];case 1:return t.sent(),this.zu.lc(),this.Xu.set("Unknown"),[2]}})})},t.prototype.listen=function(t){this.Ku.has(t.targetId)||(this.Ku.set(t.targetId,t),this.hc()?this.ac():this.Zu.Xa()&&this.dc(t))},t.prototype.fc=function(t){this.Ku.delete(t),this.Zu.Xa()&&this.Tc(t),0===this.Ku.size&&(this.Zu.Xa()?this.Zu.eu():this.Ju()&&this.Xu.set("Unknown"))},t.prototype.un=function(t){return this.Ku.get(t)||null},t.prototype.an=function(t){return this.mc.an(t)},t.prototype.dc=function(t){this.Gu.Bs(t.targetId),this.Zu.fu(t)},t.prototype.Tc=function(t){this.Gu.Bs(t),this.Zu.Tu(t)},t.prototype.ac=function(){this.Gu=new ue(this),this.Zu.start(),this.Xu.xu()},t.prototype.hc=function(){return this.Ju()&&!this.Zu.Ya()&&this.Ku.size>0},t.prototype.Ju=function(){return this.isPrimary&&this.networkEnabled},t.prototype._c=function(){this.Gu=null},t.prototype.tc=function(){return n.__awaiter(this,void 0,void 0,function(){var t=this;return n.__generator(this,function(e){return this.Ku.forEach(function(e,n){t.dc(e)}),[2]})})},t.prototype.ec=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return this._c(),this.hc()?(this.Xu.qu(t),this.ac()):this.Xu.set("Unknown"),[2]})})},t.prototype.sc=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return this.Xu.set("Online"),t instanceof oe&&2===t.state&&t.cause?[2,this.Ec(t)]:(t instanceof re?this.Gu.zs(t):t instanceof ie?this.Gu.sn(t):this.Gu.Ys(t),e.isEqual(g.MIN)?[3,4]:[4,this.Wu.bh()]);case 1:return r=n.sent(),e.D(r)>=0?[4,this.wc(e)]:[3,3];case 2:n.sent(),n.label=3;case 3:n.label=4;case 4:return[2]}})})},t.prototype.wc=function(t){var e=this,n=this.Gu.rn(t);return n.Ts.forEach(function(n,r){if(n.resumeToken.Ot()>0){var i=e.Ku.get(r);i&&e.Ku.set(r,i.ss(n.resumeToken,t))}}),n.ms.forEach(function(t){var n=e.Ku.get(t);if(n){e.Ku.set(t,n.ss(V.xt,n.ts)),e.Tc(t);var r=new Ct(n.target,t,1,n.sequenceNumber);e.dc(r)}}),this.mc.vh(n)},t.prototype.Ec=function(t){var e=this,r=t.cause,i=Promise.resolve();return t.targetIds.forEach(function(t){i=i.then(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){return this.Ku.has(t)?[2,(this.Ku.delete(t),this.Gu.removeTarget(t),this.mc.Ic(t,r))]:[2]})})})}),i},t.prototype.uc=function(){return n.__awaiter(this,void 0,void 0,function(){var t,e;return n.__generator(this,function(n){switch(n.label){case 0:return this.Rc()?(t=this.ju.length>0?this.ju[this.ju.length-1].batchId:-1,[4,this.Wu.Oh(t)]):[3,5];case 1:return null!==(e=n.sent())?[3,2]:(0===this.ju.length&&this.nc.eu(),[3,4]);case 2:return this.Ac(e),[4,this.uc()];case 3:n.sent(),n.label=4;case 4:n.label=5;case 5:return this.Pc()&&this.Vc(),[2]}})})},t.prototype.Rc=function(){return this.Ju()&&this.ju.length<10},t.prototype.gc=function(){return this.ju.length},t.prototype.Ac=function(t){this.ju.push(t),this.nc.Xa()&&this.nc.Eu&&this.nc.wu(t.mutations)},t.prototype.Pc=function(){return this.Ju()&&!this.nc.Ya()&&this.ju.length>0},t.prototype.Vc=function(){this.nc.start()},t.prototype.ic=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return this.nc.Au(),[2]})})},t.prototype.oc=function(){var t=this;return this.Wu.yh(this.nc.lastStreamToken).then(function(){for(var e=0,n=t.ju;e<n.length;e++){var r=n[e];t.nc.wu(r.mutations)}}).catch(Xe)},t.prototype.Iu=function(t,e){var n=this,r=this.ju.shift(),i=Re.from(r,t,e,this.nc.lastStreamToken);return this.mc.pc(i).then(function(){return n.uc()})},t.prototype.rc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r=this;return n.__generator(this,function(n){return t&&this.ju.length>0?[2,(e=this.nc.Eu?this.yc(t):this.bc(t),e.then(function(){r.Pc()&&r.Vc()}))]:[2]})})},t.prototype.bc=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return qt(t.code)?[2,(ge("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.nc.lastStreamToken),this.nc.lastStreamToken=V.xt,this.Wu.yh(V.xt).catch(Xe))]:[2]})})},t.prototype.yc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i=this;return n.__generator(this,function(n){return qt(r=t.code)&&r!==c.ABORTED?(e=this.ju.shift(),[2,(this.nc.tu(),this.mc.vc(e.batchId,t).then(function(){return i.uc()}))]):[2]})})},t.prototype.Sc=function(){return new Jn(this.bu)},t.prototype.Yu=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.cc()];case 1:return t.sent(),this.Xu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},t.prototype.Dc=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.Ju()?(ge("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Yu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Cc=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:[4,this.cc()];case 3:e.sent(),this.Xu.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}})})},t}();function Zn(t,e){return"firestore_clients_"+t+"_"+e}function $n(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function tr(t,e){return"firestore_targets_"+t+"_"+e}var er=function(){function e(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return e.kc=function(n,r,i){var o=JSON.parse(i),s="object"==t(o)&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==t(o.error)),u=void 0;return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(u=new f(o.error.code,o.error.message)),s?new e(n,r,o.state,u):(we("SharedClientState","Failed to parse mutation state for ID '"+r+"': "+i),null)},e.prototype.Nc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),nr=function(){function e(t,e,n){this.targetId=t,this.state=e,this.error=n}return e.kc=function(n,r){var i=JSON.parse(r),o="object"==t(i)&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==t(i.error)),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new f(i.error.code,i.error.message)),o?new e(n,i.state,s):(we("SharedClientState","Failed to parse target state for ID '"+n+"': "+r),null)},e.prototype.Nc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),rr=function(){function e(t,e){this.clientId=t,this.activeTargetIds=e}return e.kc=function(n,r){for(var i=JSON.parse(r),o="object"==t(i)&&i.activeTargetIds instanceof Array,s=Xt(),u=0;o&&u<i.activeTargetIds.length;++u)o=O(i.activeTargetIds[u]),s=s.add(i.activeTargetIds[u]);return o?new e(n,s):(we("SharedClientState","Failed to parse client data for instance '"+n+"': "+r),null)},e}(),ir=function(){function e(t,e){this.clientId=t,this.onlineState=e}return e.kc=function(n){var r=JSON.parse(n);return"object"==t(r)&&-1!==["Unknown","Online","Offline"].indexOf(r.onlineState)&&"string"==typeof r.clientId?new e(r.clientId,r.onlineState):(we("SharedClientState","Failed to parse online state: "+n),null)},e}(),or=function(){function t(){this.activeTargetIds=Xt()}return t.prototype.Fc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.$c=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Nc=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),sr=function(){function t(e,n,r,i,o){if(this.$a=e,this.platform=n,this.persistenceKey=r,this.Mc=i,this.mc=null,this.$u=null,this.vr=null,this.Lc={},this.Oc=this.xc.bind(this),this.ko=!1,this.Bc=[],!t.Uc(this.platform))throw new f(c.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.qc=Zn(this.persistenceKey,this.Mc),this.Qc=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Lc[this.Mc]=new or,this.Wc=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.jc=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.Kc=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.Gc=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.Oc)}return t.Uc=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return n.__awaiter(this,void 0,void 0,function(){var t,e,r,i,o,s,u,a,h,c,f,l=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.mc.Jh()];case 1:for(t=n.sent(),e=0,r=t;e<r.length;e++)(i=r[e])!==this.Mc&&(o=this.getItem(Zn(this.persistenceKey,i)))&&(s=rr.kc(i,o))&&(this.Lc[s.clientId]=s);for(this.zc(),(u=this.storage.getItem(this.Gc))&&(a=this.Hc(u))&&this.Jc(a),h=0,c=this.Bc;h<c.length;h++)f=c[h],this.xc(f);return this.Bc=[],this.platform.window.addEventListener("unload",function(){return l.lc()}),this.ko=!0,[2]}})})},t.prototype.Cr=function(t){this.setItem(this.Qc,JSON.stringify(t))},t.prototype.Yc=function(){var t=Xt();return x(this.Lc,function(e,n){t=t.Ft(n.activeTargetIds)}),t},t.prototype.Xc=function(t){for(var e in this.Lc)if(this.Lc.hasOwnProperty(e)&&this.Lc[e].activeTargetIds.has(t))return!0;return!1},t.prototype.Zc=function(t){this.t_(t,"pending")},t.prototype.e_=function(t,e,n){this.t_(t,e,n),this.s_(t)},t.prototype.n_=function(t){var e="not-current";if(this.Xc(t)){var n=this.storage.getItem(tr(this.persistenceKey,t));if(n){var r=nr.kc(t,n);r&&(e=r.state)}}return this.i_.Fc(t),this.zc(),e},t.prototype.r_=function(t){this.i_.$c(t),this.zc()},t.prototype.o_=function(t){return this.i_.activeTargetIds.has(t)},t.prototype.h_=function(t){this.removeItem(tr(this.persistenceKey,t))},t.prototype.a_=function(t,e,n){this.u_(t,e,n)},t.prototype.oh=function(t,e,n){var r=this;e.forEach(function(t){r.s_(t)}),this.currentUser=t,n.forEach(function(t){r.Zc(t)})},t.prototype.c_=function(t){this.__(t)},t.prototype.lc=function(){this.ko&&(this.platform.window.removeEventListener("storage",this.Oc),this.removeItem(this.qc),this.ko=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return ge("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){ge("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){ge("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.xc=function(t){var e=this;if(t.storageArea===this.storage){if(ge("SharedClientState","EVENT",t.key,t.newValue),t.key===this.qc)return void we("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.$a.qr(function(){return n.__awaiter(e,void 0,void 0,function(){var e,r,i,o,s,u;return n.__generator(this,function(n){if(this.ko){if(null!==t.key)if(this.Wc.test(t.key)){if(null==t.newValue)return e=this.l_(t.key),[2,this.d_(e,null)];if(r=this.f_(t.key,t.newValue))return[2,this.d_(r.clientId,r)]}else if(this.jc.test(t.key)){if(null!==t.newValue&&(i=this.T_(t.key,t.newValue)))return[2,this.m_(i)]}else if(this.Kc.test(t.key)){if(null!==t.newValue&&(o=this.E_(t.key,t.newValue)))return[2,this.w_(o)]}else if(t.key===this.Gc){if(null!==t.newValue&&(s=this.Hc(t.newValue)))return[2,this.Jc(s)]}else t.key===this.Qc&&(u=function(t){var e=Fe.kr;if(null!=t)try{var n=JSON.parse(t);Te("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){we("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Fe.kr&&this.vr(u)}else this.Bc.push(t);return[2]})})})}},Object.defineProperty(t.prototype,"i_",{get:function(){return this.Lc[this.Mc]},enumerable:!0,configurable:!0}),t.prototype.zc=function(){this.setItem(this.qc,this.i_.Nc())},t.prototype.t_=function(t,e,n){var r=new er(this.currentUser,t,e,n),i=$n(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Nc())},t.prototype.s_=function(t){var e=$n(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.__=function(t){var e={clientId:this.Mc,onlineState:t};this.storage.setItem(this.Gc,JSON.stringify(e))},t.prototype.u_=function(t,e,n){var r=tr(this.persistenceKey,t),i=new nr(t,e,n);this.setItem(r,i.Nc())},t.prototype.l_=function(t){var e=this.Wc.exec(t);return e?e[1]:null},t.prototype.f_=function(t,e){var n=this.l_(t);return rr.kc(n,e)},t.prototype.T_=function(t,e){var n=this.jc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return er.kc(new h(i),r,e)},t.prototype.E_=function(t,e){var n=this.Kc.exec(t),r=Number(n[1]);return nr.kc(r,e)},t.prototype.Hc=function(t){return ir.kc(t)},t.prototype.m_=function(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.mc.I_(t.batchId,t.state,t.error)]:(ge("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.w_=function(t){return this.mc.R_(t.targetId,t.state,t.error)},t.prototype.d_=function(t,e){var r=this,i=this.Yc();e?this.Lc[t]=e:delete this.Lc[t];var o=this.Yc(),s=[],u=[];return o.forEach(function(t){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(e){return i.has(t)||s.push(t),[2]})})}),i.forEach(function(t){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(e){return o.has(t)||u.push(t),[2]})})}),this.mc.A_(s,u)},t.prototype.Jc=function(t){this.Lc[t.clientId]&&this.$u(t.onlineState)},t}(),ur=function(){function t(){this.P_=new or,this.V_={},this.mc=null,this.$u=null,this.vr=null}return t.prototype.Zc=function(t){},t.prototype.e_=function(t,e,n){},t.prototype.n_=function(t){return this.P_.Fc(t),this.V_[t]||"not-current"},t.prototype.a_=function(t,e,n){this.V_[t]=e},t.prototype.r_=function(t){this.P_.$c(t)},t.prototype.o_=function(t){return this.P_.activeTargetIds.has(t)},t.prototype.h_=function(t){delete this.V_[t]},t.prototype.Yc=function(){return this.P_.activeTargetIds},t.prototype.Xc=function(t){return this.P_.activeTargetIds.has(t)},t.prototype.start=function(){return this.P_=new or,Promise.resolve()},t.prototype.oh=function(t,e,n){},t.prototype.c_=function(t){},t.prototype.lc=function(){},t.prototype.Cr=function(t){},t}(),ar=function(){function t(t){this.g_=t}return t.prototype.next=function(){return this.g_+=2,this.g_},t.p_=function(){return new t(0)},t.y_=function(){return new t(-1)},t}(),hr=function(t){this.key=t},cr=function(t){this.key=t},fr=function(){function t(t,e){this.query=t,this.b_=e,this.v_=null,this.As=!1,this.S_=Jt(),this._s=Jt(),this.D_=new Zt(t.Be.bind(t))}return Object.defineProperty(t.prototype,"C_",{get:function(){return this.b_},enumerable:!0,configurable:!0}),t.prototype.k_=function(t,e){var n=this,r=e?e.N_:new $t,i=e?e.D_:this.D_,o=e?e._s:this._s,s=i,u=!1,a=this.query.je()&&i.size===this.query.limit?i.last():null,h=this.query.Ke()&&i.size===this.query.limit?i.first():null;if(t.ut(function(t,e){var c=i.get(t),f=e instanceof gt?e:null;f&&(f=n.query.matches(f)?f:null);var l=!!c&&n._s.has(c.key),p=!!f&&(f.te||n._s.has(f.key)&&f.hasCommittedMutations),d=!1;c&&f?c.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.F_(c,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.query.Be(f,a)>0||h&&n.query.Be(f,h)<0)&&(u=!0)):!c&&f?(r.track({type:0,doc:f}),d=!0):c&&!f&&(r.track({type:1,doc:c}),d=!0,(a||h)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),this.query.je()||this.query.Ke())for(;s.size>this.query.limit;){var c=this.query.je()?s.last():s.first();s=s.delete(c.key),o=o.delete(c.key),r.track({type:1,doc:c})}return{D_:s,N_:r,M_:u,_s:o}},t.prototype.F_=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},t.prototype.nr=function(t,e,n){var r=this,i=this.D_;this.D_=t.D_,this._s=t._s;var o=t.N_.us();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.Be(t.doc,e.doc)}),this.L_(n);var s=e?this.O_():[],u=0===this.S_.size&&this.As?1:0,a=u!==this.v_;return this.v_=u,0!==o.length||a?{snapshot:new te(this.query,t.D_,i,o,t._s,0===u,a,!1),x_:s}:{x_:s}},t.prototype.B_=function(t){return this.As&&"Offline"===t?(this.As=!1,this.nr({D_:this.D_,N_:new $t,_s:this._s,M_:!1},!1)):{x_:[]}},t.prototype.U_=function(t){return!this.b_.has(t)&&!!this.D_.has(t)&&!this.D_.get(t).te},t.prototype.L_=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.b_=e.b_.add(t)}),t.Vs.forEach(function(t){}),t.gs.forEach(function(t){return e.b_=e.b_.delete(t)}),this.As=t.As)},t.prototype.O_=function(){var t=this;if(!this.As)return[];var e=this.S_;this.S_=Jt(),this.D_.forEach(function(e){t.U_(e.key)&&(t.S_=t.S_.add(e.key))});var n=[];return e.forEach(function(e){t.S_.has(e)||n.push(new cr(e))}),this.S_.forEach(function(t){e.has(t)||n.push(new hr(t))}),n},t.prototype.q_=function(t){this.b_=t.zh,this.S_=Jt();var e=this.k_(t.documents);return this.nr(e,!0)},t.prototype.Q_=function(){return te.fs(this.query,this.D_,this._s,0===this.v_)},t}(),lr=function(){function t(t,e,n,r){this.Nr=t,this.W_=e,this.updateFunction=n,this.Lr=r,this.j_=5,this.Ja=new zn(this.Nr,"retry_transaction")}return t.prototype.K_=function(){this.G_()},t.prototype.G_=function(){var t=this;this.Ja.Qa(function(){return n.__awaiter(t,void 0,void 0,function(){var t,e,r=this;return n.__generator(this,function(n){return t=this.W_.Sc(),(e=this.z_(t))&&e.then(function(e){r.Nr.qr(function(){return t.commit().then(function(){r.Lr.resolve(e)}).catch(function(t){r.H_(t)})})}).catch(function(t){r.H_(t)}),[2]})})})},t.prototype.z_=function(t){try{var e=this.updateFunction(t);return!L(e)&&e.catch&&e.then?e:(this.Lr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Lr.reject(t),null}},t.prototype.H_=function(t){var e=this;this.j_>0&&this.J_(t)?(this.j_-=1,this.Nr.qr(function(){return e.G_(),Promise.resolve()})):this.Lr.reject(t)},t.prototype.J_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!qt(e)}return!1},t}(),pr=function(t,e,n){this.query=t,this.targetId=e,this.view=n},dr=function(t){this.key=t,this.Y_=!1},yr=function(){function t(t,e,n,r,i){this.Wu=t,this.W_=e,this.X_=n,this.currentUser=r,this.Z_=i,this.tl=null,this.el=new ke(function(t){return t.canonicalId()}),this.sl=new Map,this.nl=[],this.il=new E(I.F),this.rl=new Map,this.ol=new Ve,this.hl={},this.al=new Map,this.ul=ar.y_(),this.isPrimary=void 0,this.onlineState="Unknown"}return Object.defineProperty(t.prototype,"cl",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.tl=t},t.prototype.listen=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i,o,s;return n.__generator(this,function(n){switch(n.label){case 0:return this._l("listen()"),(i=this.el.get(t))?(e=i.targetId,this.X_.n_(e),r=i.view.Q_(),[3,4]):[3,1];case 1:return[4,this.Wu.Uh(t.xe())];case 2:return o=n.sent(),s=this.X_.n_(o.targetId),e=o.targetId,[4,this.ll(t,e,"current"===s)];case 3:r=n.sent(),this.isPrimary&&this.W_.listen(o),n.label=4;case 4:return[2,(this.tl.du([r]),e)]}})})},t.prototype.ll=function(t,e,r){return n.__awaiter(this,void 0,void 0,function(){var i,o,s,u,a,h;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.Wu.Kh(t,!0)];case 1:return i=n.sent(),o=new fr(t,i.zh),s=o.k_(i.documents),u=ne.Rs(e,r&&"Offline"!==this.onlineState),a=o.nr(s,!0===this.isPrimary,u),h=new pr(t,e,o),[2,(this.el.set(t,h),this.sl.has(e)?this.sl.get(e).push(t):this.sl.set(e,[t]),a.snapshot)]}})})},t.prototype.dl=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.Wu.Kh(t.query,!0)];case 1:return e=n.sent(),r=t.view.q_(e),[2,(this.isPrimary&&this.fl(t.targetId,r.x_),r)]}})})},t.prototype.fc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i=this;return n.__generator(this,function(n){switch(n.label){case 0:return this._l("unlisten()"),e=this.el.get(t),(r=this.sl.get(e.targetId)).length>1?[2,(this.sl.set(e.targetId,r.filter(function(e){return!e.isEqual(t)})),void this.el.delete(t))]:this.isPrimary?(this.X_.r_(e.targetId),this.X_.Xc(e.targetId)?[3,2]:[4,this.Wu.jh(e.targetId,!1).then(function(){i.X_.h_(e.targetId),i.W_.fc(e.targetId),i.Tl(e.targetId)}).catch(Xe)]):[3,3];case 1:n.sent(),n.label=2;case 2:return[3,5];case 3:return this.Tl(e.targetId),[4,this.Wu.jh(e.targetId,!0)];case 4:n.sent(),n.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return this._l("write()"),[4,this.Wu.lh(t)];case 1:return r=n.sent(),this.X_.Zc(r.batchId),this.ml(r.batchId,e),[4,this.El(r.zi)];case 2:return n.sent(),[4,this.W_.uc()];case 3:return n.sent(),[2]}})})},t.prototype.runTransaction=function(t,e,n){new lr(t,this.W_,e,n).K_()},t.prototype.vh=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r=this;return n.__generator(this,function(n){switch(n.label){case 0:this._l("applyRemoteEvent()"),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.Wu.vh(t)];case 2:return e=n.sent(),t.Ts.forEach(function(t,e){var n=r.rl.get(e);n&&(Te(t.Ps.size+t.Vs.size+t.gs.size<=1,"Limbo resolution for single document contains multiple changes."),t.Ps.size>0?n.Y_=!0:t.Vs.size>0?Te(n.Y_,"Received change for limbo target document without add."):t.gs.size>0&&(Te(n.Y_,"Received remove for limbo target document without add."),n.Y_=!1))}),[4,this.El(e,t)];case 3:return n.sent(),[3,6];case 4:return[4,Xe(n.sent())];case 5:return n.sent(),[3,6];case 6:return[2]}})})},t.prototype.B_=function(t,e){if(this.isPrimary&&0===e||!this.isPrimary&&1===e){this._l("applyOnlineStateChange()");var n=[];this.el.forEach(function(e,r){var i=r.view.B_(t);i.snapshot&&n.push(i.snapshot)}),this.tl.wl(t),this.tl.du(n),this.onlineState=t,this.isPrimary&&this.X_.c_(t)}},t.prototype.Ic=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,a=this;return n.__generator(this,function(n){switch(n.label){case 0:return this._l("rejectListens()"),this.X_.a_(t,"rejected",e),r=this.rl.get(t),(i=r&&r.key)?(this.il=this.il.remove(i),this.rl.delete(t),this.Il(),o=(o=new E(I.F)).it(i,new wt(i,g.S())),s=Jt().add(i),u=new ee(g.MIN,new Map,new S(Ee),o,s),[2,this.vh(u)]):[4,this.Wu.jh(t,!1).then(function(){return a.Tl(t,e)}).catch(Xe)];case 1:return n.sent(),[2]}})})},t.prototype.I_=function(t,e,r){return n.__awaiter(this,void 0,void 0,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return this._l("applyBatchState()"),[4,this.Wu.fh(t)];case 1:return null===(i=n.sent())?[3,6]:"pending"!==e?[3,3]:[4,this.W_.uc()];case 2:return n.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.Rl(t,r||null),this.Wu.Yh(t)):_e("Unknown batchState: "+e),n.label=4;case 4:return[4,this.El(i)];case 5:return n.sent(),[3,7];case 6:ge("SyncEngine","Cannot apply mutation batch with id: "+t),n.label=7;case 7:return[2]}})})},t.prototype.pc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:this._l("applySuccessfulWrite()"),e=t.batch.batchId,this.Rl(e,null),this.Al(e),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.Wu.mh(t)];case 2:return r=n.sent(),this.X_.e_(e,"acknowledged"),[4,this.El(r)];case 3:return n.sent(),[3,6];case 4:return[4,Xe(n.sent())];case 5:return n.sent(),[3,6];case 6:return[2]}})})},t.prototype.vc=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:this._l("rejectFailedWrite()"),this.Rl(t,e),this.Al(t),n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.Wu.Ah(t)];case 2:return r=n.sent(),this.X_.e_(t,"rejected",e),[4,this.El(r)];case 3:return n.sent(),[3,6];case 4:return[4,Xe(n.sent())];case 5:return n.sent(),[3,6];case 6:return[2]}})})},t.prototype.Pl=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return this.W_.Ju()||ge("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.Wu.gh()];case 1:return-1===(e=n.sent())?[2,void t.resolve()]:((r=this.al.get(e)||[]).push(t),this.al.set(e,r),[2])}})})},t.prototype.Al=function(t){(this.al.get(t)||[]).forEach(function(t){t.resolve()}),this.al.delete(t)},t.prototype.Vl=function(t){this.al.forEach(function(e){e.forEach(function(e){e.reject(new f(c.CANCELLED,t))})}),this.al.clear()},t.prototype.ml=function(t,e){var n=this.hl[this.currentUser.s()];n||(n=new E(Ee)),n=n.it(t,e),this.hl[this.currentUser.s()]=n},t.prototype.Rl=function(t,e){var n=this.hl[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.hl[this.currentUser.s()]=n}},t.prototype.Tl=function(t,e){var n=this;void 0===e&&(e=null),this.X_.r_(t);for(var r=0,i=this.sl.get(t);r<i.length;r++){var o=i[r];this.el.delete(o),e&&this.tl.gl(o,e)}if(this.sl.delete(t),this.isPrimary){var s=this.ol.$i(t);this.ol.Ni(t),s.forEach(function(t){n.ol.Mi(t)||n.pl(t)})}},t.prototype.pl=function(t){var e=this.il.get(t);null!==e&&(this.W_.fc(e),this.il=this.il.remove(t),this.rl.delete(e),this.Il())},t.prototype.fl=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof hr?(this.ol.vi(i.key,t),this.yl(i)):i instanceof cr?(ge("SyncEngine","Document no longer in limbo: "+i.key),this.ol.Di(i.key,t),this.ol.Mi(i.key)||this.pl(i.key)):_e("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.yl=function(t){var e=t.key;this.il.get(e)||(ge("SyncEngine","New document in limbo: "+e),this.nl.push(e),this.Il())},t.prototype.Il=function(){for(;this.nl.length>0&&this.il.size<this.Z_;){var t=this.nl.shift(),e=this.ul.next();this.rl.set(e,new dr(t)),this.il=this.il.it(t,e),this.W_.listen(new Ct(Tt.ve(t.path).xe(),e,2,Fe.kr))}},t.prototype.bl=function(){return this.il},t.prototype.vl=function(){return this.nl},t.prototype.El=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r,i,o,s=this;return n.__generator(this,function(n){switch(n.label){case 0:return r=[],i=[],o=[],this.el.forEach(function(n,u){o.push(Promise.resolve().then(function(){var e=u.view.k_(t);return e.M_?s.Wu.Kh(u.query,!1).then(function(t){var n=t.documents;return u.view.k_(n,e)}):e}).then(function(t){var n=e&&e.Ts.get(u.targetId),o=u.view.nr(t,!0===s.isPrimary,n);if(s.fl(u.targetId,o.x_),o.snapshot){s.isPrimary&&s.X_.a_(u.targetId,o.snapshot.fromCache?"not-current":"current"),r.push(o.snapshot);var a=qe.br(u.targetId,o.snapshot);i.push(a)}}))}),[4,Promise.all(o)];case 1:return n.sent(),this.tl.du(r),[4,this.Wu.Lh(i)];case 2:return n.sent(),[2]}})})},t.prototype._l=function(t){},t.prototype.Dc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.Vl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.Wu.oh(t)]):[3,3];case 1:return r=n.sent(),this.X_.oh(t,r.uh,r._h),[4,this.El(r.ah)];case 2:n.sent(),n.label=3;case 3:return[4,this.W_.Dc()];case 4:return n.sent(),[2]}})})},t.prototype.Cc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i,o,s,u,a,h=this;return n.__generator(this,function(n){switch(n.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.W_.Cc(!0)]);case 1:return n.sent(),e=this.X_.Yc(),[4,this.Sl(e.j())];case 2:for(r=n.sent(),i=0,o=r;i<o.length;i++)s=o[i],this.W_.listen(s);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,u=[],a=Promise.resolve(),this.sl.forEach(function(t,e){h.X_.o_(e)?u.push(e):a=a.then(function(){return h.Tl(e),h.Wu.jh(e,!0)}),h.W_.fc(e)}),[4,a]);case 4:return n.sent(),[4,this.Sl(u)];case 5:return n.sent(),this.Dl(),[4,this.W_.Cc(!1)];case 6:n.sent(),n.label=7;case 7:return[2]}})})},t.prototype.Dl=function(){var t=this;this.rl.forEach(function(e,n){t.W_.fc(n)}),this.ol.Fi(),this.rl=new Map,this.il=new E(I.F)},t.prototype.Sl=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i,o,s,u,a,h,c,f,l,p,d;return n.__generator(this,function(n){switch(n.label){case 0:e=[],r=[],i=0,o=t,n.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=this.sl.get(s))&&0!==a.length?[4,this.Wu.jh(s,!0)]:[3,8]):[3,14];case 2:return n.sent(),[4,this.Wu.Uh(a[0].xe())];case 3:u=n.sent(),h=0,c=a,n.label=4;case 4:return h<c.length?(f=c[h],l=this.el.get(f),[4,this.dl(l)]):[3,7];case 5:(p=n.sent()).snapshot&&r.push(p.snapshot),n.label=6;case 6:return h++,[3,4];case 7:return[3,12];case 8:return[4,this.Wu.ta(s)];case 9:return d=n.sent(),[4,this.Wu.Uh(d)];case 10:return u=n.sent(),[4,this.ll(this.Cl(d),s,!1)];case 11:n.sent(),n.label=12;case 12:e.push(u),n.label=13;case 13:return i++,[3,1];case 14:return[2,(this.tl.du(r),e)]}})})},t.prototype.Cl=function(t){return new Tt(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},t.prototype.Jh=function(){return this.Wu.Jh()},t.prototype.R_=function(t,e,r){return n.__awaiter(this,void 0,void 0,function(){var i,o;return n.__generator(this,function(n){switch(n.label){case 0:return this.isPrimary?(ge("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.sl.has(t))return[3,8];switch(e){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.Wu.ea()];case 3:return i=n.sent(),o=ee.Is(t,"current"===e),[4,this.El(i,o)];case 4:return n.sent(),[3,8];case 5:return[4,this.Wu.jh(t,!0)];case 6:return n.sent(),this.Tl(t,r),[3,8];case 7:_e("Unexpected target state: "+e),n.label=8;case 8:return[2]}})})},t.prototype.A_=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r,i,o,s,u,a,h,c,f,l,p=this;return n.__generator(this,function(d){switch(d.label){case 0:if(!this.isPrimary)return[3,10];r=0,i=t,d.label=1;case 1:return r<i.length?(o=i[r],[4,this.Wu.ta(o)]):[3,6];case 2:return s=d.sent(),[4,this.Wu.Uh(s)];case 3:return u=d.sent(),[4,this.ll(this.Cl(s),u.targetId,!1)];case 4:d.sent(),this.W_.listen(u),d.label=5;case 5:return r++,[3,1];case 6:a=function(t){return n.__generator(this,function(e){switch(e.label){case 0:return h.sl.has(t)?[4,h.Wu.jh(t,!1).then(function(){p.W_.fc(t),p.Tl(t)}).catch(Xe)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=this,c=0,f=e,d.label=7;case 7:return c<f.length?(l=f[c],[5,a(l)]):[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.Wu.Zh(!0),this.W_.enableNetwork()},t.prototype.disableNetwork=function(){return this.Wu.Zh(!1),this.W_.disableNetwork()},t.prototype.an=function(t){var e=this.rl.get(t);if(e&&e.Y_)return Jt().add(e.key);var n=Jt(),r=this.sl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.el.get(s);n=n.Ft(u.view.C_)}return n},t}(),mr=function(){this.kl=null,this.targetId=0,this.Nl=[]},vr=function(){function t(t){this.mc=t,this.Fl=new ke(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.$l=new Set,this.mc.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.Fl.get(e);return r||(n=!0,r=new mr,this.Fl.set(e,r)),r.Nl.push(t),t.B_(this.onlineState),r.kl&&t.Ml(r.kl)&&this.Ll(),n?this.mc.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.fc=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,i,o;return n.__generator(this,function(n){return e=t.query,r=!1,(i=this.Fl.get(e))&&(o=i.Nl.indexOf(t))>=0&&(i.Nl.splice(o,1),r=0===i.Nl.length),r?[2,(this.Fl.delete(e),this.mc.fc(e))]:[2]})})},t.prototype.du=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Fl.get(o);if(s){for(var u=0,a=s.Nl;u<a.length;u++)a[u].Ml(i)&&(e=!0);s.kl=i}}e&&this.Ll()},t.prototype.gl=function(t,e){var n=this.Fl.get(t);if(n)for(var r=0,i=n.Nl;r<i.length;r++)i[r].onError(e);this.Fl.delete(t)},t.prototype.wl=function(t){this.onlineState=t;var e=!1;this.Fl.forEach(function(n,r){for(var i=0,o=r.Nl;i<o.length;i++)o[i].B_(t)&&(e=!0)}),e&&this.Ll()},t.prototype.Ol=function(t){this.$l.add(t),t.next()},t.prototype.xl=function(t){this.$l.delete(t)},t.prototype.Ll=function(){this.$l.forEach(function(t){t.next()})},t}(),gr=function(){function t(t,e,n){this.query=t,this.Bl=e,this.Ul=!1,this.ql=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Ml=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new te(t.query,t.docs,t.cs,e,t._s,t.fromCache,t.ls,!0)}var o=!1;return this.Ul?this.Ql(t)&&(this.Bl.next(t),o=!0):this.Wl(t,this.onlineState)&&(this.jl(t),o=!0),this.ql=t,o},t.prototype.onError=function(t){this.Bl.error(t)},t.prototype.B_=function(t){this.onlineState=t;var e=!1;return this.ql&&!this.Ul&&this.Wl(this.ql,t)&&(this.jl(this.ql),e=!0),e},t.prototype.Wl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Kl&&n||t.docs.U()&&"Offline"!==e)},t.prototype.Ql=function(t){if(t.docChanges.length>0)return!0;var e=this.ql&&this.ql.hasPendingWrites!==t.hasPendingWrites;return!(!t.ls&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.jl=function(t){t=te.fs(t.query,t.docs,t._s,t.fromCache),this.Ul=!0,this.Bl.next(t)},t}(),wr=function(){function t(){}return t.prototype.ih=function(t){this.Gl=t},t.prototype.wr=function(t,e,n,r){var o=this;return e.Oe()||n.isEqual(g.MIN)?this.zl(t,e):this.Gl.Tr(t,r).next(function(s){var u=o.Hl(e,s);return(e.je()||e.Ke())&&o.M_(e.ge,u,r,n)?o.zl(t,e):(me()<=i.LogLevel.DEBUG&&ge("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),o.Gl.wr(t,e,n).next(function(t){return u.forEach(function(e){t=t.it(e.key,e)}),t}))})},t.prototype.Hl=function(t,e){var n=new S(function(e,n){return t.Be(e,n)});return e.forEach(function(e,r){r instanceof gt&&t.matches(r)&&(n=n.add(r))}),n},t.prototype.M_=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.D(r)>0)},t.prototype.zl=function(t,e){return me()<=i.LogLevel.DEBUG&&ge("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Gl.wr(t,e,g.MIN)},t}();function br(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Tr(e)),e=_r(t.get(n),e);return Tr(e)}function _r(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Tr(t){return t+""}function Ir(t){var e=t.length;if(Te(e>=2,"Invalid path "+t),2===e)return Te(""===t.charAt(0)&&""===t.charAt(1),"Non-empty path "+t+" had length 2"),b.H;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&_e('Invalid encoded resource path: "'+t+'"'),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:_e('Invalid encoded resource path: "'+t+'"')}o=s+2}return new b(r)}var Er=function(){function e(t){this.db=t,12.2===e.Jl(o.getUA())&&we("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.Yl=function(t,n,r){return ge("SimpleDb","Opening database:",t),new Ue(function(i,o){var s=window.indexedDB.open(t,n);s.onsuccess=function(t){var n=t.target.result;i(new e(n))},s.onblocked=function(){o(new f(c.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new f(c.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},s.onupgradeneeded=function(e){ge("SimpleDb",'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result;r.createOrUpgrade(n,s.transaction,e.oldVersion,Jr).next(function(){ge("SimpleDb","Database upgrade to version "+Jr+" complete")})}}).Wi()},e.delete=function(t){return ge("SimpleDb","Removing database:",t),Dr(window.indexedDB.deleteDatabase(t)).Wi()},e.Uc=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(e.Xl())return!0;if(void 0===window.navigator)return!1;var t=o.getUA(),n=e.Jl(t),r=0<n&&n<10,i=e.Zl(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||s)},e.Xl=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.td)},e.ed=function(t,e){return t.store(e)},e.Jl=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Zl=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.sd=function(t){this.db.onversionchange=function(e){return t(e)}},e.prototype.runTransaction=function(e,r,i){return n.__awaiter(this,void 0,void 0,function(){var o,s,u,a,h;return n.__generator(this,function(c){switch(c.label){case 0:o="readonly"===e,s=0,u=function(){var t,e,u,h,c;return n.__generator(this,function(n){switch(n.label){case 0:++s,t=Ar.open(a.db,o?"readonly":"readwrite",r),n.label=1;case 1:return n.trys.push([1,3,,4]),e=i(t).catch(function(e){return t.abort(e),Ue.reject(e)}).Wi(),u={},e.catch(function(){}),[4,t.nd];case 2:return[2,(u.value=(n.sent(),e),u)];case 3:return h=n.sent(),c="FirebaseError"!==h.name&&s<3,ge("SimpleDb","Transaction failed with error: %s. Retrying: %s.",h.message,c),c?[3,4]:[2,{value:Promise.reject(h)}];case 4:return[2]}})},a=this,c.label=1;case 1:return[5,u()];case 2:if("object"==t(h=c.sent()))return[2,h.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db.close()},e}(),Nr=function(){function t(t){this.rd=t,this.od=!1,this.hd=null}return Object.defineProperty(t.prototype,"Bi",{get:function(){return this.od},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ad",{get:function(){return this.hd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.rd=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.od=!0},t.prototype.ud=function(t){this.hd=t},t.prototype.delete=function(){return Dr(this.rd.delete())},t}(),Ar=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this._d=new je,this.transaction.oncomplete=function(){e._d.resolve()},this.transaction.onabort=function(){t.error?e._d.reject(t.error):e._d.resolve()},this.transaction.onerror=function(t){var n=xr(t.target.error);e._d.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"nd",{get:function(){return this._d.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this._d.reject(t),this.aborted||(ge("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Sr(e)},t}(),Sr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(ge("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(ge("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Dr(n)},t.prototype.add=function(t){return ge("SimpleDb","ADD",this.store.name,t,t),Dr(this.store.add(t))},t.prototype.get=function(t){var e=this;return Dr(this.store.get(t)).next(function(n){return void 0===n&&(n=null),ge("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return ge("SimpleDb","DELETE",this.store.name,t),Dr(this.store.delete(t))},t.prototype.count=function(){return ge("SimpleDb","COUNT",this.store.name),Dr(this.store.count())},t.prototype.ld=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.dd(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.fd=function(t,e){ge("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Td=!1;var r=this.cursor(n);return this.dd(r,function(t,e,n){return n.delete()})},t.prototype.md=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.dd(r,e)},t.prototype.Ed=function(t){var e=this.cursor({});return new Ue(function(n,r){e.onerror=function(t){var e=xr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.dd=function(t,e){var n=[];return new Ue(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Nr(i),s=e(i.primaryKey,i.value,o);if(s instanceof Ue){var u=s.catch(function(t){return o.done(),Ue.reject(t)});n.push(u)}o.Bi?r():null===o.ad?i.continue():i.continue(o.ad)}else r()}}).next(function(){return Ue.Ki(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Td?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Dr(t){return new Ue(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=xr(t.target.error);n(e)}})}var kr=!1;function xr(t){var e=Er.Jl(o.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new f("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return kr||(kr=!0,setTimeout(function(){throw r},0)),r}}return t}var Rr=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.ur=n,this.Jo=r,this.wd={}}return t.Id=function(e,n,r,i){return Te(""!==e.uid,"UserID must not be an empty string."),new t(e.t()?e.uid:"",n,r,i)},t.prototype.Rd=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ur(t).md({index:ti.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.mh=function(t,e,n){return this.Ad(t).next(function(e){return e.lastStreamToken=n.toBase64(),Pr(t).put(e)})},t.prototype.ph=function(t){return this.Ad(t).next(function(t){return V.fromBase64String(t.lastStreamToken)})},t.prototype.yh=function(t,e){return this.Ad(t).next(function(n){return n.lastStreamToken=e.toBase64(),Pr(t).put(n)})},t.prototype.dh=function(t,e,n,r){var i=this,o=Or(t),s=Ur(t);return s.add({}).next(function(u){Te("number"==typeof u,"Auto-generated key is not a number");for(var a=new xe(u,e,n,r),h=i.serializer.Pd(i.userId,a),c=[],f=new S(function(t,e){return Ee(t.K(),e.K())}),l=0,p=r;l<p.length;l++){var d=p[l],y=ei.key(i.userId,d.key.path,u);f=f.add(d.key.path.L()),c.push(s.put(h)),c.push(o.put(y,ei.PLACEHOLDER))}return f.forEach(function(e){c.push(i.ur.Vd(t,e))}),t.rr(function(){i.wd[u]=a.keys()}),Ue.Ki(c).next(function(){return a})})},t.prototype.Ph=function(t,e){var n=this;return Ur(t).get(e).next(function(t){return t?(Te(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.gd(t)):null})},t.prototype.Th=function(t,e){var n=this;return this.wd[e]?Ue.resolve(this.wd[e]):this.Ph(t,e).next(function(t){if(t){var r=t.keys();return n.wd[e]=r,r}return null})},t.prototype.xh=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ur(t).md({index:ti.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Te(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.gd(e)),i.done()}).next(function(){return o})},t.prototype.gh=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ur(t).md({index:ti.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.hh=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ur(t).ld(ti.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.gd(t)})})},t.prototype._r=function(t,e){var n=this,r=ei.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Or(t).md({range:i},function(r,i,s){var u=r[0],a=r[1],h=r[2],c=Ir(a);if(u===n.userId&&e.path.isEqual(c))return Ur(t).get(h).next(function(t){if(!t)throw _e("Dangling document-mutation reference found: "+r+" which points to "+h);Te(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+h),o.push(n.serializer.gd(t))});s.done()}).next(function(){return o})},t.prototype.Er=function(t,e){var n=this,r=new S(Ee),i=[];return e.forEach(function(e){var o=ei.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Or(t).md({range:s},function(t,i,o){var s=t[0],u=t[1],a=t[2],h=Ir(u);s===n.userId&&e.path.isEqual(h)?r=r.add(a):o.done()});i.push(u)}),Ue.Ki(i).next(function(){return n.pd(t,r)})},t.prototype.Vr=function(t,e){var n=this,r=e.path,i=r.length+1,o=ei.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new S(Ee);return Or(t).md({range:s},function(t,e,o){var s=t[0],a=t[1],h=t[2],c=Ir(a);s===n.userId&&r.q(c)?c.length===i&&(u=u.add(h)):o.done()}).next(function(){return n.pd(t,u)})},t.prototype.pd=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Ur(t).get(e).next(function(t){if(null===t)throw _e("Dangling document-mutation reference found, which points to "+e);Te(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.gd(t))}))}),Ue.Ki(i).next(function(){return r})},t.prototype.Vh=function(t,e){var n=this;return Lr(t.yd,this.userId,e).next(function(r){return t.rr(function(){n.Xh(e.batchId)}),Ue.forEach(r,function(e){return n.Jo.bd(t,e)})})},t.prototype.Xh=function(t){delete this.wd[t]},t.prototype.Rh=function(t){var e=this;return this.Rd(t).next(function(n){if(!n)return Ue.resolve();var r=IDBKeyRange.lowerBound(ei.prefixForUser(e.userId)),i=[];return Or(t).md({range:r},function(t,n,r){if(t[0]===e.userId){var o=Ir(t[1]);i.push(o)}else r.done()}).next(function(){Te(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.K()}))})})},t.prototype.Mi=function(t,e){return Vr(t,this.userId,e)},t.prototype.Ad=function(t){var e=this;return Pr(t).get(this.userId).next(function(t){return t||new $r(e.userId,-1,"")})},t}();function Vr(t,e,n){var r=ei.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Or(t).md({range:o,Td:!0},function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()}).next(function(){return s})}function Lr(t,e,n){var r=t.store(ti.store),i=t.store(ei.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.md({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Te(1===u,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=ei.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Ue.Ki(o).next(function(){return h})}function Ur(t){return gi.ed(t,ti.store)}function Or(t){return gi.ed(t,ei.store)}function Pr(t){return gi.ed(t,$r.store)}var Cr=function(){function t(t,e){this.Jo=t,this.serializer=e}return t.prototype.Qh=function(t){var e=this;return this.vd(t).next(function(n){var r=new ar(n.highestTargetId);return n.highestTargetId=r.next(),e.Sd(t,n).next(function(){return n.highestTargetId})})},t.prototype.bh=function(t){return this.vd(t).next(function(t){return g.v(new v(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Dd=function(t){return Fr(t.yd)},t.prototype.$h=function(t,e,n){var r=this;return this.vd(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.k()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Sd(t,i)})},t.prototype.Wh=function(t,e){var n=this;return this.Cd(t,e).next(function(){return n.vd(t).next(function(r){return r.targetCount+=1,n.kd(e,r),n.Sd(t,r)})})},t.prototype.Nh=function(t,e){return this.Cd(t,e)},t.prototype.Nd=function(t,e){var n=this;return this.Fd(t,e.targetId).next(function(){return Mr(t).delete(e.targetId)}).next(function(){return n.vd(t)}).next(function(e){return Te(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.Sd(t,e)})},t.prototype.xo=function(t,e,n){var r=this,i=0,o=[];return Mr(t).md(function(s,u){var a=r.serializer.$d(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Nd(t,a)))}).next(function(){return Ue.Ki(o)}).next(function(){return i})},t.prototype.Xs=function(t,e){var n=this;return Mr(t).md(function(t,r){var i=n.serializer.$d(r);e(i)})},t.prototype.vd=function(t){return qr(t.yd)},t.prototype.Sd=function(t,e){return(n=t,gi.ed(n,ai.store)).put(ai.key,e);var n},t.prototype.Cd=function(t,e){return Mr(t).put(this.serializer.Md(e))},t.prototype.kd=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Ld=function(t){return this.vd(t).next(function(t){return t.targetCount})},t.prototype.qh=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Mr(t).md({range:i,index:si.queryTargetsIndexName},function(t,r,i){var s=n.serializer.$d(r);e.isEqual(s.target)&&(o=s,i.done())}).next(function(){return o})},t.prototype.Dh=function(t,e,n){var r=this,i=[],o=jr(t);return e.forEach(function(e){var s=br(e.path);i.push(o.put(new ui(n,s))),i.push(r.Jo.vi(t,e))}),Ue.Ki(i)},t.prototype.Sh=function(t,e,n){var r=this,i=jr(t);return Ue.forEach(e,function(e){var o=br(e.path);return Ue.Ki([i.delete([n,o]),r.Jo.Di(t,e)])})},t.prototype.Fd=function(t,e){var n=jr(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Gh=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=jr(t),i=Jt();return r.md({range:n,Td:!0},function(t,e,n){var r=Ir(t[1]),o=new I(r);i=i.add(o)}).next(function(){return i})},t.prototype.Mi=function(t,e){var n=br(e.path),r=IDBKeyRange.bound([n],[Ae(n)],!1,!0),i=0;return jr(t).md({index:ui.documentTargetsIndex,Td:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.un=function(t,e){var n=this;return Mr(t).get(e).next(function(t){return t?n.serializer.$d(t):null})},t}();function Mr(t){return gi.ed(t,si.store)}function qr(t){return Er.ed(t,ai.store).get(ai.key).next(function(t){return Te(null!==t,"Missing metadata row."),t})}function Fr(t){return qr(t).next(function(t){return t.highestListenSequenceNumber})}function jr(t){return gi.ed(t,ui.store)}var Gr=function(){function t(t,e){this.serializer=t,this.ur=e}return t.prototype.Yi=function(t,e,n){return zr(t).put(Kr(e),n)},t.prototype.Zi=function(t,e){var n=zr(t),r=Kr(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Od(t,r)})},t.prototype.tr=function(t,e){var n=this;return zr(t).get(Kr(e)).next(function(t){return n.xd(t)})},t.prototype.Bd=function(t,e){var n=this;return zr(t).get(Kr(e)).next(function(t){var e=n.xd(t);return e?{Ud:e,size:Wr(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Bt();return this.qd(t,e,function(t,e){var i=n.xd(e);r=r.it(t,i)}).next(function(){return r})},t.prototype.Qd=function(t,e){var n=this,r=Bt(),i=new E(I.F);return this.qd(t,e,function(t,e){var o=n.xd(e);o?(r=r.it(t,o),i=i.it(t,Wr(e))):(r=r.it(t,null),i=i.it(t,0))}).next(function(){return{Wd:r,jd:i}})},t.prototype.qd=function(t,e,n){if(e.U())return Ue.resolve();var r=IDBKeyRange.bound(e.first().path.j(),e.last().path.j()),i=e._t(),o=i.wt();return zr(t).md({range:r},function(t,e,r){for(var s=I.nt(t);o&&I.F(o,s)<0;)n(o,null),o=i.wt();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.wt():null),o?r.ud(o.path.j()):r.done()}).next(function(){for(;o;)n(o,null),o=i.It()?i.wt():null})},t.prototype.wr=function(t,e,n){var r=this,i=Kt(),o=e.path.length+1,s={};if(n.isEqual(g.MIN)){var u=e.path.j();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.j(),h=this.serializer.Kd(n);s.range=IDBKeyRange.lowerBound([a,h],!0),s.index=ii.collectionReadTimeIndex}return zr(t).md(s,function(t,n,s){if(t.length===o){var u=r.serializer.Gd(n);e.path.q(u.key.path)?u instanceof gt&&e.matches(u)&&(i=i.it(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.ea=function(t,e){var n=this,r=Gt(),i=this.serializer.Kd(e),o=zr(t),s=IDBKeyRange.lowerBound(i,!0);return o.md({index:ii.readTimeIndex,range:s},function(t,e){var o=n.serializer.Gd(e);r=r.it(o.key,o),i=e.readTime}).next(function(){return{sa:r,readTime:n.serializer.zd(i)}})},t.prototype.na=function(t){var e=this,n=zr(t),r=g.MIN;return n.md({index:ii.readTimeIndex,reverse:!0},function(t,n,i){n.readTime&&(r=e.serializer.zd(n.readTime)),i.done()}).next(function(){return r})},t.prototype.Eh=function(e){return new t.Hd(this,!!e&&e.wh)},t.prototype.Jd=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Br(t).get(oi.key).next(function(t){return Te(!!t,"Missing document cache metadata"),t})},t.prototype.Od=function(t,e){return Br(t).put(oi.key,e)},t.prototype.xd=function(t){if(t){var e=this.serializer.Gd(t);return e instanceof wt&&e.version.isEqual(g.S())?null:e}return null},t}();function Br(t){return gi.ed(t,oi.store)}function zr(t){return gi.ed(t,ii.store)}function Kr(t){return t.path.j()}function Wr(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _e("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}Gr.Hd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Yd=e,r.wh=n,r.Xd=new ke(function(t){return t.toString()}),r}return n.__extends(e,t),e.prototype.nr=function(t){var e=this,n=[],r=0,i=new S(function(t,e){return Ee(t.K(),e.K())});return this.zi.forEach(function(o,s){var u=e.Xd.get(o);if(s){var a=e.Yd.serializer.Zd(s,e.readTime);i=i.add(o.path.L());var h=Wr(a);r+=h-u,n.push(e.Yd.Yi(t,o,a))}else if(r-=u,e.wh){var c=e.Yd.serializer.Zd(new wt(o,g.S()),e.readTime);n.push(e.Yd.Yi(t,o,c))}else n.push(e.Yd.Zi(t,o))}),i.forEach(function(r){n.push(e.Yd.ur.Vd(t,r))}),n.push(this.Yd.updateMetadata(t,r)),Ue.Ki(n)},e.prototype.er=function(t,e){var n=this;return this.Yd.Bd(t,e).next(function(t){return null===t?(n.Xd.set(e,0),null):(n.Xd.set(e,t.size),t.Ud)})},e.prototype.sr=function(t,e){var n=this;return this.Yd.Qd(t,e).next(function(t){var e=t.Wd;return t.jd.forEach(function(t,e){n.Xd.set(t,e)}),e})},e}(Oe);var Yr=function(){function t(){this.tf=new Qr}return t.prototype.Vd=function(t,e){return this.tf.add(e),Ue.resolve()},t.prototype.Pr=function(t,e){return Ue.resolve(this.tf.getEntries(e))},t}(),Qr=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.B(),n=t.L(),r=this.index[e]||new S(b.F),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.B(),n=t.L(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new S(b.F)).j()},t}(),Jr=10,Hr=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Te(n<r&&n>=0&&r<=Jr,"Unexpected schema upgrade from v"+n+" to v"+r+".");var o=new Ar(e);n<1&&r>=1&&(function(t){t.createObjectStore(Zr.store)}(t),function(t){t.createObjectStore($r.store,{keyPath:$r.keyPath}),t.createObjectStore(ti.store,{keyPath:ti.keyPath,autoIncrement:!0}).createIndex(ti.userMutationsIndex,ti.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ei.store)}(t),ci(t),function(t){t.createObjectStore(ii.store)}(t));var s=Ue.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ui.store),t.deleteObjectStore(si.store),t.deleteObjectStore(ai.store)}(t),ci(t)),s=s.next(function(){return t=o.store(ai.store),e=new ai(0,0,g.MIN.k(),0),t.put(ai.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(ti.store).ld().next(function(n){t.deleteObjectStore(ti.store),t.createObjectStore(ti.store,{keyPath:ti.keyPath,autoIncrement:!0}).createIndex(ti.userMutationsIndex,ti.userMutationsKeyPath,{unique:!0});var r=e.store(ti.store),i=n.map(function(t){return r.put(t)});return Ue.Ki(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(fi.store,{keyPath:fi.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(oi.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ii.store);e.createIndex(ii.readTimeIndex,ii.readTimeIndexPath,{unique:!1}),e.createIndex(ii.collectionReadTimeIndex,ii.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(ii.store).md(function(t,n){e+=Wr(n)}).next(function(){var n=new oi(e);return t.store(oi.store).put(oi.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store($r.store),r=t.store(ti.store);return n.ld().next(function(n){return Ue.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ld(ti.userMutationsIndex,i).next(function(r){return Ue.forEach(r,function(r){Te(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.gd(r);return Lr(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ui.store),n=t.store(ii.store);return Fr(t).next(function(t){var r=[];return n.md(function(n,i){var o=new b(n),s=[0,br(o)];r.push(e.get(s).next(function(n){return n?Ue.resolve():function(n){return e.put(new ui(0,br(n),t))}(o)}))}).next(function(){return Ue.Ki(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(hi.store,{keyPath:hi.keyPath});var n=e.store(hi.store),r=new Qr,i=function(t){if(r.add(t)){var e=t.B(),i=t.L();return n.put({collectionId:e,parent:br(i)})}};return e.store(ii.store).md({Td:!0},function(t,e){var n=new b(t);return i(n.L())}).next(function(){return e.store(ei.store).md({Td:!0},function(t,e){t[0];var n=t[1],r=(t[2],Ir(n));return i(r.L())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(si.store);return n.md(function(t,r){var i=e.serializer.$d(r),o=e.serializer.Md(i);return n.put(o)})},t}(),Xr=function(t,e){this.seconds=t,this.nanoseconds=e},Zr=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Zr.store="owner",Zr.key="owner";var $r=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};$r.store="mutationQueues",$r.keyPath="userId";var ti=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ti.store="mutations",ti.keyPath="batchId",ti.userMutationsIndex="userMutationsIndex",ti.userMutationsKeyPath=["userId","batchId"];var ei=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,br(e)]},t.key=function(t,e,n){return[t,br(e),n]},t}();ei.store="documentMutations",ei.PLACEHOLDER=new ei;var ni=function(t,e){this.path=t,this.readTime=e},ri=function(t,e){this.path=t,this.version=e},ii=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ii.store="remoteDocuments",ii.readTimeIndex="readTimeIndex",ii.readTimeIndexPath="readTime",ii.collectionReadTimeIndex="collectionReadTimeIndex",ii.collectionReadTimeIndexPath=["parentPath","readTime"];var oi=function(t){this.byteSize=t};oi.store="remoteDocumentGlobal",oi.key="remoteDocumentGlobalKey";var si=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};si.store="targets",si.keyPath="targetId",si.queryTargetsIndexName="queryTargetsIndex",si.queryTargetsKeyPath=["canonicalId","targetId"];var ui=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ui.store="targetDocuments",ui.keyPath=["targetId","path"],ui.documentTargetsIndex="documentTargetsIndex",ui.documentTargetsKeyPath=["path","targetId"];var ai=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ai.key="targetGlobalKey",ai.store="targetGlobal";var hi=function(t,e){this.collectionId=t,this.parent=e};function ci(t){t.createObjectStore(ui.store,{keyPath:ui.keyPath}).createIndex(ui.documentTargetsIndex,ui.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(si.store,{keyPath:si.keyPath}).createIndex(si.queryTargetsIndexName,si.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ai.store)}hi.store="collectionParents",hi.keyPath=["collectionId","parent"];var fi=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};fi.store="clientMetadata",fi.keyPath="clientId";var li=n.__spreadArrays(n.__spreadArrays(n.__spreadArrays([$r.store,ti.store,ei.store,ii.store,si.store,Zr.store,ai.store,ui.store],[fi.store]),[oi.store]),[hi.store]),pi=function(){function t(){this.ef=new Qr}return t.prototype.Vd=function(t,e){var n=this;if(!this.ef.has(e)){var r=e.B(),i=e.L();t.rr(function(){n.ef.add(e)});var o={collectionId:r,parent:br(i)};return di(t).put(o)}return Ue.resolve()},t.prototype.Pr=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ae(e),""],!1,!0);return di(t).ld(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ir(o.parent))}return n})},t}();function di(t){return gi.ed(t,hi.store)}var yi=function(){function t(t){this.sf=t}return t.prototype.Gd=function(t){if(t.document)return this.sf.vn(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=I.nt(t.noDocument.path),n=this.nf(t.noDocument.readTime);return new wt(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=I.nt(t.unknownDocument.path),i=this.nf(t.unknownDocument.version);return new bt(r,i)}return _e("Unexpected DbRemoteDocument")},t.prototype.Zd=function(t,e){var n=this.Kd(e),r=t.key.path.L().j();if(t instanceof gt){var i=this.sf.bn(t),o=t.hasCommittedMutations;return new ii(null,null,i,o,n,r)}if(t instanceof wt){var s=t.key.path.j(),u=this.if(t.version),a=t.hasCommittedMutations;return new ii(null,new ni(s,u),null,a,n,r)}if(t instanceof bt){var h=t.key.path.j(),c=this.if(t.version);return new ii(new ri(h,c),null,null,!0,n,r)}return _e("Unexpected MaybeDocument")},t.prototype.Kd=function(t){var e=t.k();return[e.seconds,e.nanoseconds]},t.prototype.zd=function(t){var e=new v(t[0],t[1]);return g.v(e)},t.prototype.if=function(t){var e=t.k();return new Xr(e.seconds,e.nanoseconds)},t.prototype.nf=function(t){var e=new v(t.seconds,t.nanoseconds);return g.v(e)},t.prototype.Pd=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.sf.$n(t)}),i=e.mutations.map(function(t){return n.sf.$n(t)});return new ti(t,e.batchId,e.Ri.toMillis(),r,i)},t.prototype.gd=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.sf.xn(t)}),r=t.mutations.map(function(t){return e.sf.xn(t)}),i=v.fromMillis(t.localWriteTimeMs);return new xe(t.batchId,i,n,r)},t.prototype.$d=function(t){var e,n=this.nf(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.nf(t.lastLimboFreeSnapshotVersion):g.MIN;return e=void 0!==t.query.documents?this.sf.Kn(t.query):this.sf.Yn(t.query),new Ct(e,t.targetId,0,t.lastListenSequenceNumber,n,r,V.fromBase64String(t.resumeToken))},t.prototype.Md=function(t){var e,n=this.if(t.ts),r=this.if(t.lastLimboFreeSnapshotVersion);e=t.target.Pe()?this.sf.jn(t.target):this.sf.Gn(t.target);var i=t.resumeToken.toBase64();return new si(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}(),mi="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",vi=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).yd=e,r.Ch=n,r}return n.__extends(e,t),e}(Ce),gi=function(){function t(e,n,r,i,o,s,u,a){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.$a=s,this.rf=a,this.hf=!1,this.isPrimary=!1,this.networkEnabled=!0,this.af=null,this.inForeground=!1,this.uf=null,this.cf=null,this._f=Number.NEGATIVE_INFINITY,this.lf=function(t){return Promise.resolve()},this.Jo=new _i(this,o),this.df=n+t.ff,this.serializer=new yi(u),this.document=i.document,this.th=new Cr(this.Jo,this.serializer),this.ur=new pi,this.hr=new Gr(this.serializer,this.ur),!i.window||!i.window.localStorage)throw new f(c.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.Tf=this.window.localStorage}return t.ed=function(t,e){if(t instanceof vi)return Er.ed(t.yd,e);throw _e("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.mf=function(e){if(!t.Uc())throw new f(c.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.Ef,e.$a,e.serializer,e.rf)},t.prototype.start=function(){var t=this;return Er.Yl(this.df,Jr,new Hr(this.serializer)).then(function(e){return t.wf=e,t.If()}).then(function(){return t.Rf(),t.Af(),t.Pf(),t.wf.runTransaction("readonly",[ai.store],function(t){return Fr(t)})}).then(function(e){t.Vf=new Fe(e,t.rf)}).then(function(){t.hf=!0}).catch(function(e){return t.wf&&t.wf.close(),Promise.reject(e)})},t.prototype.gf=function(t){var e=this;return this.lf=function(r){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){return this.ko?[2,t(r)]:[2]})})},t(this.isPrimary)},t.prototype.pf=function(t){var e=this;this.wf.sd(function(r){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return null===r.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Zh=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.$a.qr(function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.ko?[4,this.If()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.If=function(){var t=this;return this.wf.runTransaction("readwrite",li,function(e){return bi(e).put(new fi(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.yf(e).next(function(e){e||(t.isPrimary=!1,t.$a.qr(function(){return t.lf(!1)}))})}).next(function(){return t.bf(e)}).next(function(n){return t.isPrimary&&!n?t.vf(e).next(function(){return!1}):!!n&&t.Sf(e).next(function(){return!0})})}).catch(function(e){if(!t.allowTabSynchronization)throw e;return ge("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.$a.qr(function(){return t.lf(e)}),t.isPrimary=e})},t.prototype.yf=function(t){var e=this;return wi(t).get(Zr.key).next(function(t){return Ue.resolve(e.Df(t))})},t.prototype.Cf=function(t){return bi(t).delete(this.clientId)},t.prototype.kf=function(){return n.__awaiter(this,void 0,void 0,function(){var e=this;return n.__generator(this,function(n){switch(n.label){case 0:return!this.isPrimary||this.Nf(this._f,18e5)?[3,2]:(this._f=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(n){var r=t.ed(n,fi.store);return r.ld().next(function(t){var n=e.Ff(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Ue.forEach(i,function(t){return r.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:n.sent().forEach(function(t){e.window.localStorage.removeItem(e.$f(t.clientId))}),n.label=2;case 2:return[2]}})})},t.prototype.Pf=function(){var t=this;this.cf=this.$a.eo("client_metadata_refresh",4e3,function(){return t.If().then(function(){return t.kf()}).then(function(){return t.Pf()})})},t.prototype.Df=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bf=function(t){var e=this;return wi(t).get(Zr.key).next(function(n){if(null!==n&&e.Nf(n.leaseTimestampMs,5e3)&&!e.Mf(n.ownerId)){if(e.Df(n)&&e.networkEnabled)return!0;if(!e.Df(n)){if(!n.allowTabSynchronization)throw new f(c.FAILED_PRECONDITION,mi);return!1}}return!(!e.networkEnabled||!e.inForeground)||bi(t).ld().next(function(t){return void 0===e.Ff(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&ge("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.lc=function(){return n.__awaiter(this,void 0,void 0,function(){var t=this;return n.__generator(this,function(e){switch(e.label){case 0:return this.hf=!1,this.Lf(),this.cf&&(this.cf.cancel(),this.cf=null),this.Of(),this.xf(),[4,this.wf.runTransaction("readwrite",[Zr.store,fi.store],function(e){return t.vf(e).next(function(){return t.Cf(e)})})];case 1:return e.sent(),this.wf.close(),this.Bf(),[2]}})})},t.prototype.Ff=function(t,e){var n=this;return t.filter(function(t){return n.Nf(t.updateTimeMs,e)&&!n.Mf(t.clientId)})},t.prototype.Jh=function(){var t=this;return this.wf.runTransaction("readonly",[fi.store],function(e){return bi(e).ld().next(function(e){return t.Ff(e,18e5).map(function(t){return t.clientId})})})},t.clearPersistence=function(e){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return t.Uc()?(r=e+t.ff,[4,Er.delete(r)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})},Object.defineProperty(t.prototype,"ko",{get:function(){return this.hf},enumerable:!0,configurable:!0}),t.prototype.Yo=function(t){return Rr.Id(t,this.serializer,this.ur,this.Jo)},t.prototype.eh=function(){return this.th},t.prototype.Zo=function(){return this.hr},t.prototype.nh=function(){return this.ur},t.prototype.runTransaction=function(t,e,n){var r=this;ge("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.wf.runTransaction(o,li,function(o){return i=new vi(o,r.Vf.next()),"readwrite-primary"===e?r.yf(o).next(function(t){return!!t||r.bf(o)}).next(function(e){if(!e)throw we("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.$a.qr(function(){return r.lf(!1)}),new f(c.FAILED_PRECONDITION,Pe);return n(i)}).next(function(t){return r.Sf(o).next(function(){return t})}):r.Uf(o).next(function(){return n(i)})}).then(function(t){return i.or(),t})},t.prototype.Uf=function(t){var e=this;return wi(t).get(Zr.key).next(function(t){if(null!==t&&e.Nf(t.leaseTimestampMs,5e3)&&!e.Mf(t.ownerId)&&!e.Df(t)&&!t.allowTabSynchronization)throw new f(c.FAILED_PRECONDITION,mi)})},t.prototype.Sf=function(t){var e=new Zr(this.clientId,this.allowTabSynchronization,Date.now());return wi(t).put(Zr.key,e)},t.Uc=function(){return Er.Uc()},t.qf=function(t){var e=t.cn.projectId;return t.cn.Ei||(e+="."+t.cn.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.vf=function(t){var e=this,n=wi(t);return n.get(Zr.key).next(function(t){return e.Df(t)?(ge("IndexedDbPersistence","Releasing primary lease."),n.delete(Zr.key)):Ue.resolve()})},t.prototype.Nf=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(we("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Rf=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.uf=function(){t.$a.qr(function(){return t.inForeground="visible"===t.document.visibilityState,t.If()})},this.document.addEventListener("visibilitychange",this.uf),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Of=function(){this.uf&&(this.document.removeEventListener("visibilitychange",this.uf),this.uf=null)},t.prototype.Af=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.af=function(){t.Lf(),t.$a.qr(function(){return t.lc()})},this.window.addEventListener("unload",this.af))},t.prototype.xf=function(){this.af&&(this.window.removeEventListener("unload",this.af),this.af=null)},t.prototype.Mf=function(t){try{var e=null!==this.Tf.getItem(this.$f(t));return ge("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return we("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Lf=function(){try{this.Tf.setItem(this.$f(this.clientId),String(Date.now()))}catch(t){we("Failed to set zombie client id.",t)}},t.prototype.Bf=function(){try{this.Tf.removeItem(this.$f(this.clientId))}catch(t){}},t.prototype.$f=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function wi(t){return t.store(Zr.store)}function bi(t){return t.store(fi.store)}gi.ff="main";var _i=function(){function t(t,e){this.db=t,this.Qf=null,this.bo=new Je(this,e)}return t.prototype.Mo=function(t){var e=this.Wf(t);return this.db.eh().Ld(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Wf=function(t){var e=0;return this.Oo(t,function(t){e++}).next(function(){return e})},t.prototype.Xs=function(t,e){return this.db.eh().Xs(t,e)},t.prototype.Oo=function(t,e){return this.jf(t,function(t,n){return e(n)})},t.prototype.Ho=function(t){this.Qf=t},t.prototype.vi=function(t,e){return Ti(t,e)},t.prototype.Di=function(t,e){return Ti(t,e)},t.prototype.xo=function(t,e,n){return this.db.eh().xo(t,e,n)},t.prototype.bd=function(t,e){return Ti(t,e)},t.prototype.Kf=function(t,e){return this.Qf.Mi(e)?Ue.resolve(!0):function(t,e){var n=!1;return Pr(t).Ed(function(r){return Vr(t,r,e).next(function(t){return t&&(n=!0),Ue.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Bo=function(t,e){var n=this,r=this.db.Zo().Eh(),i=[],o=0;return this.jf(t,function(s,u){if(u<=e){var a=n.Kf(t,s).next(function(e){if(!e)return o++,r.tr(t,s).next(function(){return r.Zi(s),jr(t).delete([0,br(s.path)])})});i.push(a)}}).next(function(){return Ue.Ki(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.es(t.Ch);return this.db.eh().Nh(t,n)},t.prototype.Fh=function(t,e){return Ti(t,e)},t.prototype.jf=function(t,e){var n,r=jr(t),i=Fe.kr;return r.md({index:ui.documentTargetsIndex},function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Fe.kr&&e(new I(Ir(n)),i),i=u,n=s):i=Fe.kr}).next(function(){i!==Fe.kr&&e(new I(Ir(n)),i)})},t.prototype.qo=function(t){return this.db.Zo().Jd(t)},t}();function Ti(t,e){return jr(t).put(function(t,e){return new ui(0,br(t.path),e)}(e,t.Ch))}var Ii=function(){function t(t,e){this.ur=t,this.Jo=e,this.ar=[],this.Gf=1,this.lastStreamToken=V.xt,this.zf=new S(Le.Ee)}return t.prototype.Rd=function(t){return Ue.resolve(0===this.ar.length)},t.prototype.mh=function(t,e,n){var r=e.batchId,i=this.Hf(r,"acknowledged");return Te(0===i,"Can only acknowledge the first batch in the mutation queue"),this.ar[i],this.lastStreamToken=n,Ue.resolve()},t.prototype.ph=function(t){return Ue.resolve(this.lastStreamToken)},t.prototype.yh=function(t,e){return this.lastStreamToken=e,Ue.resolve()},t.prototype.dh=function(t,e,n,r){var i=this.Gf;this.Gf++,this.ar.length>0&&this.ar[this.ar.length-1];var o=new xe(i,e,n,r);this.ar.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.zf=this.zf.add(new Le(a.key,i)),this.ur.Vd(t,a.key.path.L())}return Ue.resolve(o)},t.prototype.Ph=function(t,e){return Ue.resolve(this.Jf(e))},t.prototype.Th=function(t,e){var n=this.Jf(e);return Ue.resolve(n.keys())},t.prototype.xh=function(t,e){var n=e+1,r=this.Yf(n),i=r<0?0:r;return Ue.resolve(this.ar.length>i?this.ar[i]:null)},t.prototype.gh=function(){return Ue.resolve(0===this.ar.length?-1:this.Gf-1)},t.prototype.hh=function(t){return Ue.resolve(this.ar.slice())},t.prototype._r=function(t,e){var n=this,r=new Le(e,0),i=new Le(e,Number.POSITIVE_INFINITY),o=[];return this.zf.Ct([r,i],function(t){var e=n.Jf(t.Li);o.push(e)}),Ue.resolve(o)},t.prototype.Er=function(t,e){var n=this,r=new S(Ee);return e.forEach(function(t){var e=new Le(t,0),i=new Le(t,Number.POSITIVE_INFINITY);n.zf.Ct([e,i],function(t){r=r.add(t.Li)})}),Ue.resolve(this.Xf(r))},t.prototype.Vr=function(t,e){var n=e.path,r=n.length+1,i=n;I.st(i)||(i=i.child(""));var o=new Le(new I(i),0),s=new S(Ee);return this.zf.kt(function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.Li)),!0)},o),Ue.resolve(this.Xf(s))},t.prototype.Xf=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Jf(t);null!==r&&n.push(r)}),n},t.prototype.Vh=function(t,e){var n=this;Te(0===this.Hf(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.ar.shift();var r=this.zf;return Ue.forEach(e.mutations,function(i){var o=new Le(i.key,e.batchId);return r=r.delete(o),n.Jo.bd(t,i.key)}).next(function(){n.zf=r})},t.prototype.Xh=function(t){},t.prototype.Mi=function(t,e){var n=new Le(e,0),r=this.zf.Nt(n);return Ue.resolve(e.isEqual(r&&r.key))},t.prototype.Rh=function(t){return this.ar.length,Ue.resolve()},t.prototype.Hf=function(t,e){return this.Yf(t)},t.prototype.Yf=function(t){return 0===this.ar.length?0:t-this.ar[0].batchId},t.prototype.Jf=function(t){var e=this.Yf(t);return e<0||e>=this.ar.length?null:this.ar[e]},t}(),Ei=function(){function t(t,e){this.ur=t,this.Zf=e,this.docs=new E(I.F),this.size=0}return t.prototype.Yi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Zf(e);return this.docs=this.docs.it(r,{Ud:e,size:s,readTime:n}),this.size+=s-o,this.ur.Vd(t,r.path.L())},t.prototype.Zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.tr=function(t,e){var n=this.docs.get(e);return Ue.resolve(n?n.Ud:null)},t.prototype.getEntries=function(t,e){var n=this,r=Bt();return e.forEach(function(t){var e=n.docs.get(t);r=r.it(t,e?e.Ud:null)}),Ue.resolve(r)},t.prototype.wr=function(t,e,n){for(var r=Kt(),i=new I(e.path.child("")),o=this.docs.lt(i);o.It();){var s=o.wt(),u=s.key,a=s.value,h=a.Ud,c=a.readTime;if(!e.path.q(u.path))break;c.D(n)<=0||h instanceof gt&&e.matches(h)&&(r=r.it(h.key,h))}return Ue.resolve(r)},t.prototype.tT=function(t,e){return Ue.forEach(this.docs,function(t){return e(t)})},t.prototype.ea=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.na=function(t){return Ue.resolve(g.MIN)},t.prototype.Eh=function(e){return new t.Hd(this)},t.prototype.Jd=function(t){return Ue.resolve(this.size)},t}();Ei.Hd=function(t){function e(e){var n=this;return(n=t.call(this)||this).Yd=e,n}return n.__extends(e,t),e.prototype.nr=function(t){var e=this,n=[];return this.zi.forEach(function(r,i){i?n.push(e.Yd.Yi(t,i,e.readTime)):e.Yd.Zi(r)}),Ue.Ki(n)},e.prototype.er=function(t,e){return this.Yd.tr(t,e)},e.prototype.sr=function(t,e){return this.Yd.getEntries(t,e)},e}(Oe);var Ni=function(){function t(t){this.persistence=t,this.eT=new ke(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=g.MIN,this.highestTargetId=0,this.sT=0,this.nT=new Ve,this.targetCount=0,this.iT=ar.p_()}return t.prototype.Xs=function(t,e){return this.eT.forEach(function(t,n){return e(n)}),Ue.resolve()},t.prototype.bh=function(t){return Ue.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Dd=function(t){return Ue.resolve(this.sT)},t.prototype.Qh=function(t){return this.highestTargetId=this.iT.next(),Ue.resolve(this.highestTargetId)},t.prototype.$h=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.sT&&(this.sT=e),Ue.resolve()},t.prototype.Cd=function(t){this.eT.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.iT=new ar(e),this.highestTargetId=e),t.sequenceNumber>this.sT&&(this.sT=t.sequenceNumber)},t.prototype.Wh=function(t,e){return this.Cd(e),this.targetCount+=1,Ue.resolve()},t.prototype.Nh=function(t,e){return this.Cd(e),Ue.resolve()},t.prototype.Nd=function(t,e){return this.eT.delete(e.target),this.nT.Ni(e.targetId),this.targetCount-=1,Ue.resolve()},t.prototype.xo=function(t,e,n){var r=this,i=0,o=[];return this.eT.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.eT.delete(s),o.push(r.Fd(t,u.targetId)),i++)}),Ue.Ki(o).next(function(){return i})},t.prototype.Ld=function(t){return Ue.resolve(this.targetCount)},t.prototype.qh=function(t,e){var n=this.eT.get(e)||null;return Ue.resolve(n)},t.prototype.un=function(t,e){return _e("Not yet implemented.")},t.prototype.Dh=function(t,e,n){this.nT.Si(e,n);var r=this.persistence.Jo,i=[];return r&&e.forEach(function(e){i.push(r.vi(t,e))}),Ue.Ki(i)},t.prototype.Sh=function(t,e,n){this.nT.ki(e,n);var r=this.persistence.Jo,i=[];return r&&e.forEach(function(e){i.push(r.Di(t,e))}),Ue.Ki(i)},t.prototype.Fd=function(t,e){return this.nT.Ni(e),Ue.resolve()},t.prototype.Gh=function(t,e){var n=this.nT.$i(e);return Ue.resolve(n)},t.prototype.Mi=function(t,e){return Ue.resolve(this.nT.Mi(e))},t}(),Ai=function(){function t(t,e){var n=this;this.clientId=t,this.rT={},this.Vf=new Fe(0),this.hf=!1,this.hf=!0,this.Jo=e(this),this.th=new Ni(this),this.ur=new Yr,this.hr=new Ei(this.ur,function(t){return n.Jo.oT(t)})}return t.prototype.start=function(){return Promise.resolve()},t.prototype.lc=function(){return this.hf=!1,Promise.resolve()},Object.defineProperty(t.prototype,"ko",{get:function(){return this.hf},enumerable:!0,configurable:!0}),t.prototype.Jh=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,[this.clientId]]})})},t.prototype.gf=function(t){return t(!0)},t.prototype.pf=function(){},t.prototype.Zh=function(t){},t.prototype.nh=function(){return this.ur},t.prototype.Yo=function(t){var e=this.rT[t.s()];return e||(e=new Ii(this.ur,this.Jo),this.rT[t.s()]=e),e},t.prototype.eh=function(){return this.th},t.prototype.Zo=function(){return this.hr},t.prototype.runTransaction=function(t,e,n){var r=this;ge("MemoryPersistence","Starting transaction:",t);var i=new Si(this.Vf.next());return this.Jo.hT(),n(i).next(function(t){return r.Jo.aT(i).next(function(){return t})}).Wi().then(function(t){return i.or(),t})},t.prototype.uT=function(t,e){return Ue.Gi(Object.values(this.rT).map(function(n){return function(){return n.Mi(t,e)}}))},t}(),Si=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ch=e,n}return n.__extends(e,t),e}(Ce),Di=function(){function t(t){this.persistence=t,this.Qf=null,this.cT=null}return t._T=function(e){return new t(e)},Object.defineProperty(t.prototype,"lT",{get:function(){if(this.cT)return this.cT;throw _e("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.Ho=function(t){this.Qf=t},t.prototype.vi=function(t,e){return this.lT.delete(e),Ue.resolve()},t.prototype.Di=function(t,e){return this.lT.add(e),Ue.resolve()},t.prototype.bd=function(t,e){return this.lT.add(e),Ue.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.eh();return r.Gh(t,e.targetId).next(function(t){t.forEach(function(t){return n.lT.add(t)})}).next(function(){return r.Nd(t,e)})},t.prototype.hT=function(){this.cT=new Set},t.prototype.aT=function(t){var e=this,n=this.persistence.Zo().Eh();return Ue.forEach(this.lT,function(r){return e.dT(t,r).next(function(t){t||n.Zi(r)})}).next(function(){return e.cT=null,n.apply(t)})},t.prototype.Fh=function(t,e){var n=this;return this.dT(t,e).next(function(t){t?n.lT.delete(e):n.lT.add(e)})},t.prototype.oT=function(t){return 0},t.prototype.dT=function(t,e){var n=this;return Ue.Gi([function(){return n.persistence.eh().Mi(t,e)},function(){return n.persistence.uT(t,e)},function(){return Ue.resolve(n.Qf.Mi(e))}])},t}(),ki=function(){function t(){}return t.prototype.initialize=function(t){return n.__awaiter(this,void 0,void 0,function(){var e=this;return n.__generator(this,function(r){switch(r.label){case 0:return this.X_=this.fT(t),this.persistence=this.TT(t),[4,this.persistence.start()];case 1:return r.sent(),this.mT=this.ET(t),this.Wu=this.wT(t),this.W_=this.IT(t),this.mc=this.RT(t),this.AT=this.PT(t),this.X_.$u=function(t){return e.mc.B_(t,1)},this.W_.mc=this.mc,this.X_.mc=this.mc,[4,this.X_.start()];case 2:return r.sent(),[4,this.W_.start()];case 3:return r.sent(),[4,this.Wu.start()];case 4:return r.sent(),[4,this.persistence.gf(function(t){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.mc.Cc(t)];case 1:return e.sent(),this.mT&&(t&&!this.mT.ko?this.mT.start(this.Wu):t||this.mT.stop()),[2]}})})})];case 5:return r.sent(),[2]}})})},t.prototype.PT=function(t){return new vr(this.mc)},t.prototype.ET=function(t){return null},t.prototype.wT=function(t){return new He(this.persistence,new wr,t.VT)},t.prototype.TT=function(t){return new Ai(t.clientId,Di._T)},t.prototype.IT=function(t){var e=this;return new Xn(this.Wu,t.bu,t.Nr,function(t){return e.mc.B_(t,0)},t.platform.gT())},t.prototype.fT=function(t){return new ur},t.prototype.RT=function(t){return new yr(this.Wu,this.W_,this.X_,t.VT,t.Z_)},t.prototype.clearPersistence=function(t){throw new f(c.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},t}(),xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.ET=function(t){var e=this.persistence.Jo.bo;return new Qe(e,t.Nr)},e.prototype.TT=function(t){var e=gi.qf(t.pT),n=t.platform.yT(t.pT.cn);return gi.mf({allowTabSynchronization:t.bT.synchronizeTabs,persistenceKey:e,clientId:t.clientId,platform:t.platform,$a:t.Nr,serializer:n,Ef:Ye.Io(t.bT.cacheSizeBytes),rf:this.X_})},e.prototype.fT=function(t){if(t.bT.synchronizeTabs){if(!sr.Uc(t.platform))throw new f(c.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=gi.qf(t.pT);return new sr(t.Nr,t.platform,e,t.clientId,t.VT)}return new ur},e.prototype.clearPersistence=function(t){var e=gi.qf(t);return gi.clearPersistence(e)},e}(ki),Ri=function(){function t(t,e,n,r){this.platform=t,this.pT=e,this.credentials=n,this.Nr=r,this.clientId=Ie.mi()}return t.prototype.start=function(t,e){var n=this;this.vT();var r=new je,i=new je,o=!1;return this.credentials.l(function(s){if(!o)return o=!0,ge("FirestoreClient","Initializing. user=",s.uid),n.ST(t,e,s,i).then(r.resolve,r.reject);n.Nr.qr(function(){return n.Dc(s)})}),this.Nr.qr(function(){return r.promise}),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.vT(),this.Nr.enqueue(function(){return t.mc.enableNetwork()})},t.prototype.ST=function(t,e,r,i){return n.__awaiter(this,void 0,void 0,function(){var o,s,u,a,h=this;return n.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,this.platform.DT(this.pT)];case 1:return o=c.sent(),s=this.platform.yT(this.pT.cn),u=new Qn(this.Nr,o,this.credentials,s),[4,t.initialize({Nr:this.Nr,pT:this.pT,platform:this.platform,bu:u,clientId:this.clientId,VT:r,Z_:100,bT:e})];case 2:return c.sent(),this.persistence=t.persistence,this.X_=t.X_,this.Wu=t.Wu,this.W_=t.W_,this.mc=t.mc,this.mT=t.mT,this.CT=t.AT,this.persistence.pf(function(){return n.__awaiter(h,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),i.resolve(),[3,4];case 3:if(a=c.sent(),i.reject(a),!this.kT(a))throw a;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),this.ST(new ki,{NT:!1},r,i))];case 4:return[2]}})})},t.prototype.kT=function(t){return"FirebaseError"===t.name?t.code===c.FAILED_PRECONDITION||t.code===c.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.vT=function(){if(this.Nr.Hr)throw new f(c.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Dc=function(t){return this.Nr.no(),ge("FirestoreClient","Credential Changed. Current user: "+t.uid),this.mc.Dc(t)},t.prototype.disableNetwork=function(){var t=this;return this.vT(),this.Nr.enqueue(function(){return t.mc.disableNetwork()})},t.prototype.terminate=function(){var t=this;return this.Nr.to(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.mT&&this.mT.stop(),[4,this.W_.lc()];case 1:return t.sent(),[4,this.X_.lc()];case 2:return t.sent(),[4,this.persistence.lc()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},t.prototype.waitForPendingWrites=function(){var t=this;this.vT();var e=new je;return this.Nr.qr(function(){return t.mc.Pl(e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.vT();var i=new gr(t,e,n);return this.Nr.qr(function(){return r.CT.listen(i)}),i},t.prototype.fc=function(t){var e=this;this.FT||this.Nr.qr(function(){return e.CT.fc(t)})},t.prototype.$T=function(t){var e=this;return this.vT(),this.Nr.enqueue(function(){return e.Wu.Bh(t)}).then(function(t){if(t instanceof gt)return t;if(t instanceof wt)return null;throw new f(c.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.MT=function(t){var e=this;return this.vT(),this.Nr.enqueue(function(){return n.__awaiter(e,void 0,void 0,function(){var e,r,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.Wu.Kh(t,!0)];case 1:return e=n.sent(),r=new fr(t,e.zh),i=r.k_(e.documents),[2,r.nr(i,!1).snapshot]}})})})},t.prototype.write=function(t){var e=this;this.vT();var n=new je;return this.Nr.qr(function(){return e.mc.write(t,n)}),n.promise},t.prototype.cn=function(){return this.pT.cn},t.prototype.Ol=function(t){var e=this;this.vT(),this.Nr.qr(function(){return e.CT.Ol(t),Promise.resolve()})},t.prototype.xl=function(t){this.FT||this.CT.xl(t)},Object.defineProperty(t.prototype,"FT",{get:function(){return this.Nr.Hr},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.vT();var n=new je;return this.Nr.qr(function(){return e.mc.runTransaction(e.Nr,t,n),Promise.resolve()}),n.promise},t}(),Vi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.LT(this.observer.next,t)},t.prototype.error=function(t){this.LT(this.observer.error,t)},t.prototype.OT=function(){this.muted=!0},t.prototype.LT=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}();function Li(e){return function(e,n){if("object"!=t(e)||null===e)return!1;for(var r=e,i=0,o=["next","error","complete"];i<o.length;i++){var s=o[i];if(s in r&&"function"==typeof r[s])return!0}return!1}(e)}var Ui=function(){function t(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.xT=n,this.converter=r}return t.prototype.BT=function(t){switch(q(t)){case 0:return null;case 1:return t.booleanValue;case 2:return W(t.integerValue||t.doubleValue);case 3:return this.UT(t.timestampValue);case 4:return this.qT(t);case 5:return t.stringValue;case 6:return new bn(Y(t.bytesValue));case 7:return this.QT(t.referenceValue);case 8:return new Rn(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.WT(t.arrayValue);case 10:return this.jT(t.mapValue);default:throw _e("Invalid value type: "+JSON.stringify(t))}},t.prototype.jT=function(t){var e=this,n={};return x(t.fields||{},function(t,r){n[t]=e.BT(r)}),n},t.prototype.WT=function(t){var e=this;return(t.values||[]).map(function(t){return e.BT(t)})},t.prototype.qT=function(t){switch(this.xT){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return P(n)?t(n):n}(t);return null==e?null:this.BT(e);case"estimate":return this.UT(C(t));default:return null}},t.prototype.UT=function(t){var e=K(t),n=new v(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.QT=function(t){var e=b.G(t);Te(pe(e),"ReferenceValue is not valid "+t);var n=new De(e.get(1),e.get(3)),r=new I(e.M(5));return n.isEqual(this.firestore.KT)||we("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.KT.projectId+"/"+this.firestore.KT.database+") instead."),new Fi(r,this.firestore,this.converter)},t}(),Oi=Ye.Po,Pi=function(){function t(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new f(c.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else on("settings","non-empty string","host",t.host),this.host=t.host,sn("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ln("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),sn("settings","object","credentials",t.credentials),this.credentials=t.credentials,sn("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?we("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&we("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,sn("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ye.po;else{if(t.cacheSizeBytes!==Oi&&t.cacheSizeBytes<Ye.Vo)throw new f(c.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ye.Vo);this.cacheSizeBytes=t.cacheSizeBytes}sn("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Ci=function(){function e(r,i,o){var s=this;if(void 0===o&&(o=new ki),this.GT=null,this.zT=new Be,this.INTERNAL={delete:function(){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return this.HT(),[4,this.JT.terminate()];case 1:return t.sent(),[2]}})})}},"object"==t(r.options)){var u=r;this.GT=u,this.KT=e.YT(u),this.XT=u.name,this.ZT=new d(i)}else{var a=r;if(!a.projectId)throw new f(c.INVALID_ARGUMENT,"Must provide projectId");this.KT=new De(a.projectId,a.database),this.XT="[DEFAULT]",this.ZT=new p}this.tm=o,this.em=new Pi({}),this.sm=this.nm(this.KT)}return e.prototype.settings=function(e){$e("Firestore.settings",arguments,1),nn("Firestore.settings","object",1,e);var n=new Pi(e);if(this.JT&&!this.em.isEqual(n))throw new f(c.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.em=n,void 0!==n.credentials&&(this.ZT=function(e){if(!e)return new p;switch(e.type){case"gapi":var n=e.im;return Te(!("object"!=t(n)||null===n||!n.auth||!n.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new m(n,e.V||"0");case"provider":return e.im;default:throw new f(c.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(n.credentials))},e.prototype.enableNetwork=function(){return this.HT(),this.JT.enableNetwork()},e.prototype.disableNetwork=function(){return this.HT(),this.JT.disableNetwork()},e.prototype.enablePersistence=function(t){var e,n;if(this.JT)throw new f(c.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&we("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.rm(this.tm,{NT:!0,cacheSizeBytes:this.em.cacheSizeBytes,synchronizeTabs:r})},e.prototype.clearPersistence=function(){return n.__awaiter(this,void 0,void 0,function(){var t,e=this;return n.__generator(this,function(r){if(void 0!==this.JT&&!this.JT.FT)throw new f(c.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return t=new je,[2,(this.zT.Jr(function(){return n.__awaiter(e,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=this.om(),[4,this.tm.clearPersistence(e)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return r=n.sent(),t.reject(r),[3,3];case 3:return[2]}})})}),t.promise)]})})},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,"hm",{get:function(){return this.HT(),this.JT.FT},enumerable:!0,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this.HT(),this.JT.waitForPendingWrites()},e.prototype.onSnapshotsInSync=function(t){if(this.HT(),Li(t))return this.am(t);nn("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.am(e)},e.prototype.am=function(t){var e=this,n=new Vi({next:function(){t.next&&t.next()},error:function(t){throw _e("Uncaught Error in onSnapshotsInSync")}});return this.JT.Ol(n),function(){n.OT(),e.JT.xl(n)}},e.prototype.HT=function(){return this.JT||this.rm(new ki,{NT:!1}),this.JT},e.prototype.om=function(){return new Se(this.KT,this.XT,this.em.host,this.em.ssl,this.em.forceLongPolling)},e.prototype.rm=function(t,e){var n=this.om();return this.JT=new Ri(de.Lt(),n,this.ZT,this.zT),this.JT.start(t,e)},e.prototype.nm=function(t){var e=new le(t,{dn:de.Lt().dn});return new Mn(e,function(e){if(e instanceof Fi){var n=t,r=e.firestore.KT;if(!r.isEqual(n))throw new f(c.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Cn(t,e.um)}return e})},e.YT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new f(c.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new f(c.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new De(n)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.GT)throw new f(c.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.GT},enumerable:!0,configurable:!0}),e.prototype.collection=function(t){return $e("Firestore.collection",arguments,1),nn("Firestore.collection","non-empty string",1,t),this.HT(),new Wi(b.G(t),this)},e.prototype.doc=function(t){return $e("Firestore.doc",arguments,1),nn("Firestore.doc","non-empty string",1,t),this.HT(),Fi.cm(b.G(t),this)},e.prototype.collectionGroup=function(t){if($e("Firestore.collectionGroup",arguments,1),nn("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new f(c.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.HT(),new zi(new Tt(b.H,t),this)},e.prototype.runTransaction=function(t){var e=this;return $e("Firestore.runTransaction",arguments,1),nn("Firestore.runTransaction","function",1,t),this.HT().transaction(function(n){return t(new Mi(e,n))})},e.prototype.batch=function(){return this.HT(),new qi(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(me()){case i.LogLevel.DEBUG:return"debug";case i.LogLevel.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),e.setLogLevel=function(t){switch($e("Firestore.setLogLevel",arguments,1),nn("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":ve(i.LogLevel.DEBUG);break;case"error":ve(i.LogLevel.ERROR);break;case"silent":ve(i.LogLevel.SILENT);break;default:throw new f(c.INVALID_ARGUMENT,"Invalid log level: "+t)}},e.prototype._m=function(){return this.em.timestampsInSnapshots},e}(),Mi=function(){function t(t,e){this.lm=t,this.dm=e}return t.prototype.get=function(t){var e=this;$e("Transaction.get",arguments,1);var n=Hi("Transaction.get",t,this.lm);return this.dm.pu([n.um]).then(function(t){if(!t||1!==t.length)return _e("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof wt)return new Gi(e.lm,n.um,null,!1,!1,n.fm);if(r instanceof gt)return new Gi(e.lm,n.um,r,!1,!1,n.fm);throw _e("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){en("Transaction.set",arguments,2,3);var r=Hi("Transaction.set",t,this.lm);n=Yi("Transaction.set",n);var i=Zi(r.fm,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.lm.sm.pa(s,o,n.mergeFields):this.lm.sm.Va(s,o);return this.dm.set(r.um,u),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Tn?(tn("Transaction.update",arguments,3),r=Hi("Transaction.update",t,this.lm),i=this.lm.sm.Sa("Transaction.update",e,n,o)):($e("Transaction.update",arguments,2),r=Hi("Transaction.update",t,this.lm),i=this.lm.sm.ya("Transaction.update",e)),this.dm.update(r.um,i),this},t.prototype.delete=function(t){$e("Transaction.delete",arguments,1);var e=Hi("Transaction.delete",t,this.lm);return this.dm.delete(e.um),this},t}(),qi=function(){function t(t){this.lm=t,this.Tm=[],this.mm=!1}return t.prototype.set=function(t,e,n){en("WriteBatch.set",arguments,2,3),this.Em();var r=Hi("WriteBatch.set",t,this.lm);n=Yi("WriteBatch.set",n);var i=Zi(r.fm,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.lm.sm.pa(s,o,n.mergeFields):this.lm.sm.Va(s,o);return this.Tm=this.Tm.concat(u.da(r.um,at.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Em(),"string"==typeof e||e instanceof Tn?(tn("WriteBatch.update",arguments,3),r=Hi("WriteBatch.update",t,this.lm),i=this.lm.sm.Sa("WriteBatch.update",e,n,o)):($e("WriteBatch.update",arguments,2),r=Hi("WriteBatch.update",t,this.lm),i=this.lm.sm.ya("WriteBatch.update",e)),this.Tm=this.Tm.concat(i.da(r.um,at.exists(!0))),this},t.prototype.delete=function(t){$e("WriteBatch.delete",arguments,1),this.Em();var e=Hi("WriteBatch.delete",t,this.lm);return this.Tm=this.Tm.concat(new pt(e.um,at.NONE)),this},t.prototype.commit=function(){return this.Em(),this.mm=!0,this.Tm.length>0?this.lm.HT().write(this.Tm):Promise.resolve()},t.prototype.Em=function(){if(this.mm)throw new f(c.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Fi=function(){function e(t,e,n){this.um=t,this.firestore=e,this.fm=n,this.JT=this.firestore.HT()}return e.cm=function(t,n,r){if(t.length%2!=0)throw new f(c.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.K()+" has "+t.length);return new e(new I(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.um.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Wi(this.um.path.L(),this.firestore,this.fm)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.um.path.K()},enumerable:!0,configurable:!0}),e.prototype.collection=function(t){if($e("DocumentReference.collection",arguments,1),nn("DocumentReference.collection","non-empty string",1,t),!t)throw new f(c.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=b.G(t);return new Wi(this.um.path.child(e),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw pn("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.um.isEqual(t.um)&&this.fm===t.fm},e.prototype.set=function(t,e){en("DocumentReference.set",arguments,1,2),e=Yi("DocumentReference.set",e);var n=Zi(this.fm,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.sm.pa(i,r,e.mergeFields):this.firestore.sm.Va(i,r);return this.JT.write(o.da(this.um,at.NONE))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Tn?(tn("DocumentReference.update",arguments,2),n=this.firestore.sm.Sa("DocumentReference.update",t,e,r)):($e("DocumentReference.update",arguments,1),n=this.firestore.sm.ya("DocumentReference.update",t)),this.JT.write(n.da(this.um,at.exists(!0)))},e.prototype.delete=function(){return $e("DocumentReference.delete",arguments,0),this.JT.write([new pt(this.um,at.NONE)])},e.prototype.onSnapshot=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];en("DocumentReference.onSnapshot",arguments,1,4);var r,i={includeMetadataChanges:!1},o=0;"object"!=t(e[o])||Li(e[o])||(ln("DocumentReference.onSnapshot",i=e[o],["includeMetadataChanges"]),sn("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++);var s={includeMetadataChanges:i.includeMetadataChanges};return Li(e[o])?r=e[o]:(nn("DocumentReference.onSnapshot","function",o,e[o]),rn("DocumentReference.onSnapshot","function",o+1,e[o+1]),rn("DocumentReference.onSnapshot","function",o+2,e[o+2]),r={next:e[o],error:e[o+1],complete:e[o+2]}),this.wm(s,r)},e.prototype.wm=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Vi({next:function(t){if(e.next){var r=t.docs.get(n.um);e.next(new Gi(n.firestore,n.um,r,t.fromCache,t.hasPendingWrites,n.fm))}},error:r}),o=this.JT.listen(Tt.ve(this.um.path),i,t);return function(){i.OT(),n.JT.fc(o)}},e.prototype.get=function(t){var e=this;return en("DocumentReference.get",arguments,0,1),Ji("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.HT().$T(e.um).then(function(t){n(new Gi(e.firestore,e.um,t,!0,t instanceof gt&&t.te,e.fm))},r):e.Im(n,r,t)})},e.prototype.Im=function(t,e,n){var r=this.wm({includeMetadataChanges:!0,Kl:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new f(c.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new f(c.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},e.prototype.withConverter=function(t){return new e(this.um,this.firestore,t)},e}(),ji=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Gi=function(){function t(t,e,n,r,i,o){this.lm=t,this.um=e,this.Rm=n,this.Am=r,this.Pm=i,this.fm=o}return t.prototype.data=function(t){if(en("DocumentSnapshot.data",arguments,0,1),t=Qi("DocumentSnapshot.data",t),this.Rm){if(this.fm){var e=new Bi(this.lm,this.um,this.Rm,this.Am,this.Pm);return this.fm.fromFirestore(e,t)}return new Ui(this.lm,this.lm._m(),t.serverTimestamps,void 0).BT(this.Rm.Ie())}},t.prototype.get=function(t,e){if(en("DocumentSnapshot.get",arguments,1,2),e=Qi("DocumentSnapshot.get",e),this.Rm){var n=this.Rm.data().field(jn("DocumentSnapshot.get",t));if(null!==n)return new Ui(this.lm,this.lm._m(),e.serverTimestamps,this.fm).BT(n)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.um.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Fi(this.um,this.lm,this.fm)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Rm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new ji(this.Pm,this.Am)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw pn("isEqual","DocumentSnapshot",1,e);return this.lm===e.lm&&this.Am===e.Am&&this.um.isEqual(e.um)&&(null===this.Rm?null===e.Rm:this.Rm.isEqual(e.Rm))&&this.fm===e.fm},t}(),Bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Gi),zi=function(){function e(t,e,n){this.Vm=t,this.firestore=e,this.fm=n}return e.prototype.where=function(t,n,r){var i;$e("Query.where",arguments,3),fn("Query.where",3,r),function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new f(c.INVALID_ARGUMENT,"Invalid value "+cn(r)+" provided to function Query.where() for its "+yn(2)+" argument. Acceptable values: "+e.join(", "))}(0,["<","<=","==",">=",">","array-contains","in","array-contains-any"],0,n);var o=jn("Query.where",t),s=It.G(n);if(o.Y()){if(s===It.ARRAY_CONTAINS||s===It.ARRAY_CONTAINS_ANY)throw new f(c.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+s.toString()+"' queries on FieldPath.documentId().");if(s===It.IN){this.gm(r,s);for(var u=[],a=0,h=r;a<h.length;a++){var l=h[a];u.push(this.pm(l))}i={arrayValue:{values:u}}}else i=this.pm(r)}else s!==It.IN&&s!==It.ARRAY_CONTAINS_ANY||this.gm(r,s),i=this.firestore.sm.Da("Query.where",r,s===It.IN);var p=Et.create(o,s,i);return this.ym(p),new e(this.Vm.Ce(p),this.firestore,this.fm)},e.prototype.orderBy=function(t,n){var r;if(en("Query.orderBy",arguments,1,2),rn("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=xt.ASCENDING;else{if("desc"!==n)throw new f(c.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=xt.DESCENDING}if(null!==this.Vm.startAt)throw new f(c.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Vm.endAt)throw new f(c.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=jn("Query.orderBy",t),o=new Ut(i,r);return this.bm(o),new e(this.Vm.ke(o),this.firestore,this.fm)},e.prototype.limit=function(t){return $e("Query.limit",arguments,1),nn("Query.limit","number",1,t),dn("Query.limit",1,t),new e(this.Vm.Ne(t),this.firestore,this.fm)},e.prototype.limitToLast=function(t){return $e("Query.limitToLast",arguments,1),nn("Query.limitToLast","number",1,t),dn("Query.limitToLast",1,t),new e(this.Vm.Fe(t),this.firestore,this.fm)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];tn("Query.startAt",arguments,1);var i=this.vm("Query.startAt",t,n,!0);return new e(this.Vm.$e(i),this.firestore,this.fm)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];tn("Query.startAfter",arguments,1);var i=this.vm("Query.startAfter",t,n,!1);return new e(this.Vm.$e(i),this.firestore,this.fm)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];tn("Query.endBefore",arguments,1);var i=this.vm("Query.endBefore",t,n,!0);return new e(this.Vm.Me(i),this.firestore,this.fm)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];tn("Query.endAt",arguments,1);var i=this.vm("Query.endAt",t,n,!1);return new e(this.Vm.Me(i),this.firestore,this.fm)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw pn("isEqual","Query",1,t);return this.firestore===t.firestore&&this.Vm.isEqual(t.Vm)},e.prototype.withConverter=function(t){return new e(this.Vm,this.firestore,t)},e.prototype.vm=function(t,e,n,r){if(fn(t,1,e),e instanceof Gi){if(n.length>0)throw new f(c.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new f(c.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Sm(i.Rm,r)}var o=[e].concat(n);return this.Dm(t,o,r)},e.prototype.Sm=function(t,e){for(var n=[],r=0,i=this.Vm.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(Q(this.firestore.KT,t.key));else{var s=t.field(o.field);if(P(s))throw new f(c.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.K();throw new f(c.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Lt(n,e)},e.prototype.Dm=function(e,n,r){var i=this.Vm.Ve;if(n.length>i.length)throw new f(c.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var o=[],s=0;s<n.length;s++){var u=n[s];if(i[s].field.Y()){if("string"!=typeof u)throw new f(c.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+t(u));if(!this.Vm.He()&&-1!==u.indexOf("/"))throw new f(c.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+e+"() must be a plain document ID, but '"+u+"' contains a slash.");var a=this.Vm.path.child(b.G(u));if(!I.st(a))throw new f(c.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+e+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var h=new I(a);o.push(Q(this.firestore.KT,h))}else{var l=this.firestore.sm.Da(e,u);o.push(l)}}return new Lt(o,r)},e.prototype.onSnapshot=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];en("Query.onSnapshot",arguments,1,4);var r,i={},o=0;return"object"!=t(e[o])||Li(e[o])||(ln("Query.onSnapshot",i=e[o],["includeMetadataChanges"]),sn("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Li(e[o])?r=e[o]:(nn("Query.onSnapshot","function",o,e[o]),rn("Query.onSnapshot","function",o+1,e[o+1]),rn("Query.onSnapshot","function",o+2,e[o+2]),r={next:e[o],error:e[o+1],complete:e[o+2]}),this.Cm(this.Vm),this.wm(i,r)},e.prototype.wm=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Vi({next:function(t){e.next&&e.next(new Ki(n.firestore,n.Vm,t,n.fm))},error:r}),o=this.firestore.HT(),s=o.listen(this.Vm,i,t);return function(){i.OT(),o.fc(s)}},e.prototype.Cm=function(t){if(t.Ke()&&0===t.Ve.length)throw new f(c.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},e.prototype.get=function(t){var e=this;return en("Query.get",arguments,0,1),Ji("Query.get",t),this.Cm(this.Vm),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.HT().MT(e.Vm).then(function(t){n(new Ki(e.firestore,e.Vm,t,e.fm))},r):e.Im(n,r,t)})},e.prototype.Im=function(t,e,n){var r=this.wm({includeMetadataChanges:!0,Kl:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new f(c.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},e.prototype.pm=function(t){if("string"==typeof t){if(""===t)throw new f(c.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Vm.He()&&-1!==t.indexOf("/"))throw new f(c.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Vm.path.child(b.G(t));if(!I.st(e))throw new f(c.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Q(this.firestore.KT,new I(e))}if(t instanceof Fi){var n=t;return Q(this.firestore.KT,n.um)}throw new f(c.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+cn(t)+".")},e.prototype.gm=function(t,e){if(!Array.isArray(t)||0===t.length)throw new f(c.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new f(c.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new f(c.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new f(c.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},e.prototype.ym=function(t){if(t instanceof Et){var e=[It.ARRAY_CONTAINS,It.ARRAY_CONTAINS_ANY],n=[It.IN,It.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.Ge()){var o=this.Vm.Se();if(null!==o&&!o.isEqual(t.field))throw new f(c.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Vm.De();null!==s&&this.km(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.Vm.ze(n)),null===u&&r&&(u=this.Vm.ze(e)),null!=u)throw u===t.op?new f(c.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new f(c.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},e.prototype.bm=function(t){if(null===this.Vm.De()){var e=this.Vm.Se();null!==e&&this.km(e,t.field)}},e.prototype.km=function(t,e){if(!e.isEqual(t))throw new f(c.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},e}(),Ki=function(){function t(t,e,n,r){this.lm=t,this.Nm=e,this.Fm=n,this.fm=r,this.$m=null,this.Mm=null,this.metadata=new ji(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Fm.docs.U()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Fm.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;en("QuerySnapshot.forEach",arguments,1,2),nn("QuerySnapshot.forEach","function",1,t),this.Fm.docs.forEach(function(r){t.call(e,n.Lm(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new zi(this.Nm,this.lm,this.fm)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(ln("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),sn("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Fm.ds)throw new f(c.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.$m&&this.Mm===e||(this.$m=function(t,e,n,r){if(n.cs.U()){var i=0;return n.docChanges.map(function(e){var o=new Bi(t,e.doc.key,e.doc,n.fromCache,n._s.has(e.doc.key),r);return e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.cs;return n.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var i=new Bi(t,e.doc.key,e.doc,n.fromCache,n._s.has(e.doc.key),r),s=-1,u=-1;return 0!==e.type&&(s=o.indexOf(e.doc.key),o=o.delete(e.doc.key)),1!==e.type&&(u=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:Xi(e.type),doc:i,oldIndex:s,newIndex:u}})}(this.lm,e,this.Fm,this.fm),this.Mm=e),this.$m},t.prototype.isEqual=function(e){if(!(e instanceof t))throw pn("isEqual","QuerySnapshot",1,e);return this.lm===e.lm&&this.Nm.isEqual(e.Nm)&&this.Fm.isEqual(e.Fm)&&this.fm===e.fm},t.prototype.Lm=function(t){return new Bi(this.lm,t.key,t,this.metadata.fromCache,this.Fm._s.has(t.key),this.fm)},t}(),Wi=function(t){function e(e,n,r){var i=this;if((i=t.call(this,Tt.ve(e),n,r)||this).Om=e,e.length%2!=1)throw new f(c.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.K()+" has "+e.length);return i}return n.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Vm.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Vm.path.L();return t.U()?null:new Fi(new I(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Vm.path.K()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(en("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ie.mi()),nn("CollectionReference.doc","non-empty string",1,t),""===t)throw new f(c.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=b.G(t);return Fi.cm(this.Vm.path.child(e),this.firestore,this.fm)},e.prototype.add=function(t){$e("CollectionReference.add",arguments,1),nn("CollectionReference.add","object",1,this.fm?this.fm.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},e.prototype.withConverter=function(t){return new e(this.Om,this.firestore,t)},e}(zi);function Yi(t,e){if(void 0===e)return{merge:!1};if(ln(t,e,["merge","mergeFields"]),sn(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new f(c.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+cn(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new f(c.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+cn(r[o]))}(t,"mergeFields",0,r,function(t){return"string"==typeof t||t instanceof Tn})}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new f(c.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Qi(t,e){return void 0===e?{}:(ln(t,e,["serverTimestamps"]),un(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ji(t,e){rn(t,"object",1,e),e&&(ln(t,e,["source"]),un(t,0,"source",e.source,["default","server","cache"]))}function Hi(t,e,n){if(e instanceof Fi){if(e.firestore!==n)throw new f(c.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw pn(t,"DocumentReference",1,e)}function Xi(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e("Unknown change type: "+t)}}function Zi(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var $i=vn(Ci,"Use firebase.firestore() instead."),to=vn(Mi,"Use firebase.firestore().runTransaction() instead."),eo=vn(qi,"Use firebase.firestore().batch() instead."),no=vn(Fi,"Use firebase.firestore().doc() instead."),ro=vn(Gi),io=vn(Bi),oo=vn(zi),so=vn(Ki),uo=vn(Wi,"Use firebase.firestore().collection() instead."),ao={Firestore:$i,GeoPoint:Rn,Timestamp:v,Blob:_n,Transaction:to,WriteBatch:eo,DocumentReference:no,DocumentSnapshot:ro,Query:oo,QueryDocumentSnapshot:io,QuerySnapshot:so,CollectionReference:uo,FieldPath:Tn,FieldValue:xn,setLogLevel:Ci.setLogLevel,CACHE_SIZE_UNLIMITED:Oi},ho=function(){function t(){}return t.prototype.Hu=function(t){},t.prototype.lc=function(){},t}(),co=function(){function t(){var t=this;this.xm=function(){return t.Bm()},this.Um=function(){return t.qm()},this.Qm=[],this.Wm()}return t.prototype.Hu=function(t){this.Qm.push(t)},t.prototype.lc=function(){window.removeEventListener("online",this.xm),window.removeEventListener("offline",this.Um)},t.prototype.Wm=function(){window.addEventListener("online",this.xm),window.addEventListener("offline",this.Um)},t.prototype.Bm=function(){ge("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Qm;t<e.length;t++)(0,e[t])(0)},t.prototype.qm=function(){ge("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Qm;t<e.length;t++)(0,e[t])(1)},t.Uc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),fo=function(){function t(t){this.jm=t.jm,this.Km=t.Km}return t.prototype._u=function(t){this.Gm=t},t.prototype.ou=function(t){this.zm=t},t.prototype.onMessage=function(t){this.Hm=t},t.prototype.close=function(){this.Km()},t.prototype.send=function(t){this.jm(t)},t.prototype.Jm=function(){this.Gm()},t.prototype.Ym=function(t){this.zm(t)},t.prototype.Xm=function(t){this.Hm(t)},t}(),lo={BatchGetDocuments:"batchGet",Commit:"commit"},po="gl-js/ fire/"+a,yo=function(){function t(t){this.cn=t.cn;var e=t.ssl?"https":"http";this.Zm=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.tE=function(t,e){if(e)for(var n in e.h)e.h.hasOwnProperty(n)&&(t[n]=e.h[n]);t["X-Goog-Api-Client"]=po},t.prototype.gu=function(t,e,n){var r=this,i=this.eE(t);return new Promise(function(o,s){var a=new u.XhrIo;a.listenOnce(u.EventType.COMPLETE,function(){try{switch(a.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var e=a.getResponseJson();ge("Connection","XHR received:",JSON.stringify(e)),o(e);break;case u.ErrorCode.TIMEOUT:ge("Connection",'RPC "'+t+'" timed out'),s(new f(c.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=a.getStatus();if(ge("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=r.status.toLowerCase().replace("_","-");return Object.values(c).indexOf(e)>=0?e:c.UNKNOWN}();s(new f(i,r.message))}else s(new f(c.UNKNOWN,"Server responded with status "+a.getStatus()))}else ge("Connection",'RPC "'+t+'" failed'),s(new f(c.UNAVAILABLE,"Connection failed."));break;default:_e('RPC "'+t+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{ge("Connection",'RPC "'+t+'" completed.')}});var h=Object.assign({},e);delete h.database;var l=JSON.stringify(h);ge("Connection","XHR sending: ",i+" "+l);var p={"Content-Type":"text/plain"};r.tE(p,n),a.send(i,"POST",l,p,15)})},t.prototype.yu=function(t,e,n){return this.gu(t,e,n)},t.prototype.lu=function(t,e){var n=[this.Zm,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=u.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.cn.projectId+"/databases/"+this.cn.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.tE(i.initMessageHeaders,e),o.isMobileCordova()||o.isReactNative()||o.isElectron()||o.isIE()||o.isUWP()||o.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");ge("Connection","Creating WebChannel: "+s+" "+i);var a=r.createWebChannel(s,i),h=!1,l=!1,p=new fo({jm:function(t){l?ge("Connection","Not sending because WebChannel is closed:",t):(h||(ge("Connection","Opening WebChannel transport."),a.open(),h=!0),ge("Connection","WebChannel sending:",t),a.send(t))},Km:function(){return a.close()}}),d=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return d(u.WebChannel.EventType.OPEN,function(){l||ge("Connection","WebChannel transport opened.")}),d(u.WebChannel.EventType.CLOSE,function(){l||(l=!0,ge("Connection","WebChannel transport closed"),p.Ym())}),d(u.WebChannel.EventType.ERROR,function(t){l||(l=!0,ge("Connection","WebChannel transport errored:",t),p.Ym(new f(c.UNAVAILABLE,"The operation could not be completed")))}),d(u.WebChannel.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];Te(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){ge("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Rt[o];if(void 0!==e)return Ft(e)}(),u=i.message;void 0===s&&(s=c.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),l=!0,p.Ym(new f(s,u)),a.close()}else ge("Connection","WebChannel received:",n),p.Xm(n)}}),setTimeout(function(){p.Jm()},0),p},t.prototype.eE=function(t){var e=lo[t];return this.Zm+"/v1/projects/"+this.cn.projectId+"/databases/"+this.cn.database+"/documents:"+e},t}();function mo(t){!function(t,e){t.INTERNAL.registerComponent(new s.Component("firestore",function(t){return function(t,e){return new Ci(t,e,new xi)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},ao)))}(t),t.registerVersion("@firebase/firestore","1.14.1")}de.fi(new(function(){function t(){this.dn=!0,this.ia="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.DT=function(t){return Promise.resolve(new yo(t))},t.prototype.gT=function(){return co.Uc()?new co:new ho},t.prototype.yT=function(t){return new le(t,{dn:!0})},t.prototype.Ti=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}())),mo(r),exports.__PRIVATE_registerFirestore=mo;
},{"tslib":"vCxL","@firebase/app":"dP58","@firebase/logger":"TUpU","@firebase/util":"xA6u","@firebase/component":"nzQs","@firebase/webchannel-wrapper":"ueHA"}],"vHL5":[function(require,module,exports) {
"use strict";require("@firebase/firestore");
},{"@firebase/firestore":"eA7g"}],"zwPb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiKey:"AIzaSyAjQFEdQmqFBFJsU4wq09CT2BkBOVmTa1o",authDomain:"t485-main.firebaseapp.com",databaseURL:"https://t485-main.firebaseio.com",projectId:"t485-main",storageBucket:"t485-main.appspot.com",messagingSenderId:"368513727602",appId:"1:368513727602:web:8660dddb3081f87e8b16eb",measurementId:"G-YEKMBRT69H"};
},{}],"AxDp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default='\n<html>\n<head>\n\t<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">\n</head>\n<body>\n<div class="container pt-5">\n\t\t<div class="col-lg-12">\n\t\t\t\t<h1>404 Error: File not found</h1>\n\t\t\t\t<p class="text-muted">T485 Link Shortener</p>\n\t\t\t\t<hr>\n\t\t\t\t<p>The link you have tried to access does not exist.</p>\n\t\t\t\t<p>You may be able to <a href="/">create this link</a>, although some links cannot be created even if they do not already exist.</p>\n\t\t\t\t<p className="mt-4 text-muted">If you believe this is an error, please contact the webmaster (<a href="mailto:webmaster@t485.org">webmaster@t485.org</a>).</p>\n\t\t</div>\n</div>\n</body>\n</html>\n';
},{}],"QsLA":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function l(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}c((r=r.apply(e,t||[])).next())})},t=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(l){i=[6,l],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=n(require("firebase/app"));require("firebase/firestore");var o=n(require("./firebaseConfig")),i=n(require("./templates/error404"));r.default.initializeApp(o.default),e(void 0,void 0,void 0,function(){var e,n,o;return t(this,function(t){switch(t.label){case 0:return e=window.location.pathname.substring(1).split("/"),n=encodeURIComponent(e[0]),[4,r.default.firestore().collection("linkshortener").doc(n).get()];case 1:return o=t.sent().data(),console.log(o),o&&o.to?"analytics"==e[1]?(window.location.replace("https://beta.t485.org/resources/linkshortener/analytics?id="+e[0]),[2]):"preview"==e[1]?o.disablePreview?(document.write('<p>Previews have been disabled for this link by its creator. To follow the link, <a href="/'+e[0]+'">click here</a>.'),document.close(),[2]):(document.write('\n\t\t<p>This link is sending you to <a href="'+o.to+'">'+o.to+"</a>. You will NOT be automatically redirected.</p>\n\t\t"),document.close(),[2]):o.clickAnalytics?[4,r.default.firestore().collection("linkshortener").doc(n).update({clicks:r.default.firestore.FieldValue.arrayUnion((new Date).getTime())})]:[3,3]:(document.write(i.default),document.close(),[2]);case 2:t.sent(),t.label=3;case 3:return window.location.replace(o.to),setTimeout(function(){document.write('\n\t\t<p>If you are not automatically redirected, please click on the following link: <a href="'+o.to+'">'+o.to+"</a>.</p>\n\t\t"),document.close()},1e3),[2]}})});
},{"firebase/app":"ZUoI","firebase/firestore":"vHL5","./firebaseConfig":"zwPb","./templates/error404":"AxDp"}]},{},["QsLA"], null)
//# sourceMappingURL=/redirect.addf1fab.js.map